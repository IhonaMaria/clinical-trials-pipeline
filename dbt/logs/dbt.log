[0m09:11:03.108441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fea15100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fe3f3fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fe3f0170>]}


============================== 09:11:03.118329 | dabdd6c0-7b2b-42d8-8e91-0b27129cee4d ==============================
[0m09:11:03.118329 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:11:03.120475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:11:03.191530 [info ] [MainThread]: dbt version: 1.9.0
[0m09:11:03.193137 [info ] [MainThread]: python version: 3.12.4
[0m09:11:03.194660 [info ] [MainThread]: python path: /usr/local/bin/python
[0m09:11:03.195811 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m09:11:03.197122 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m09:11:03.198244 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m09:11:03.200446 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m09:11:03.339139 [info ] [MainThread]: Configuration:
[0m09:11:03.340766 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m09:11:03.342577 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:11:03.344640 [info ] [MainThread]: Required dependencies:
[0m09:11:03.347001 [debug] [MainThread]: Executing "git --help"
[0m09:11:03.351090 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:11:03.352747 [debug] [MainThread]: STDERR: "b''"
[0m09:11:03.353981 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:11:03.355557 [info ] [MainThread]: Connection test skipped since no profile was found
[0m09:11:03.358065 [info ] [MainThread]: [31m1 check failed:[0m
[0m09:11:03.360154 [info ] [MainThread]: dbt looked for a profiles.yml file in /root/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m09:11:03.364287 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.3431103, "process_in_blocks": "0", "process_kernel_time": 0.375317, "process_mem_max_rss": "89260", "process_out_blocks": "1464", "process_user_time": 2.363483}
[0m09:11:03.366712 [debug] [MainThread]: Command `dbt debug` failed at 09:11:03.366462 after 0.35 seconds
[0m09:11:03.368283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fe431760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fe125070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fe127fb0>]}
[0m09:11:03.370106 [debug] [MainThread]: Flushing usage events
[0m09:11:03.889248 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:15:37.578151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57643c5820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5763e4f3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5765a38110>]}


============================== 09:15:37.587881 | ade45acd-fede-4776-b6bd-b0acdf34c41b ==============================
[0m09:15:37.587881 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:15:37.589785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:15:37.648124 [info ] [MainThread]: dbt version: 1.9.0
[0m09:15:37.649144 [info ] [MainThread]: python version: 3.12.4
[0m09:15:37.650536 [info ] [MainThread]: python path: /usr/local/bin/python
[0m09:15:37.652013 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m09:15:37.748028 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m09:15:37.749622 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m09:15:37.751371 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m09:15:37.753105 [info ] [MainThread]: adapter type: postgres
[0m09:15:37.754367 [info ] [MainThread]: adapter version: 1.9.0
[0m09:15:37.874333 [info ] [MainThread]: Configuration:
[0m09:15:37.876212 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:15:37.877858 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:15:37.879622 [info ] [MainThread]: Required dependencies:
[0m09:15:37.880953 [debug] [MainThread]: Executing "git --help"
[0m09:15:37.884353 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:15:37.885415 [debug] [MainThread]: STDERR: "b''"
[0m09:15:37.886747 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:15:37.888136 [info ] [MainThread]: Connection:
[0m09:15:37.889489 [info ] [MainThread]:   host: postgres
[0m09:15:37.890931 [info ] [MainThread]:   port: 5432
[0m09:15:37.892397 [info ] [MainThread]:   user: user
[0m09:15:37.893956 [info ] [MainThread]:   database: clinical_trials
[0m09:15:37.895840 [info ] [MainThread]:   schema: silver
[0m09:15:37.898106 [info ] [MainThread]:   connect_timeout: 10
[0m09:15:37.899649 [info ] [MainThread]:   role: None
[0m09:15:37.901156 [info ] [MainThread]:   search_path: None
[0m09:15:37.902760 [info ] [MainThread]:   keepalives_idle: 0
[0m09:15:37.903980 [info ] [MainThread]:   sslmode: None
[0m09:15:37.905254 [info ] [MainThread]:   sslcert: None
[0m09:15:37.906667 [info ] [MainThread]:   sslkey: None
[0m09:15:37.908166 [info ] [MainThread]:   sslrootcert: None
[0m09:15:37.910118 [info ] [MainThread]:   application_name: dbt
[0m09:15:37.911789 [info ] [MainThread]:   retries: 1
[0m09:15:37.913852 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:15:37.979550 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:15:38.025165 [debug] [MainThread]: Using postgres connection "debug"
[0m09:15:38.026743 [debug] [MainThread]: On debug: select 1 as id
[0m09:15:38.027939 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:15:38.078991 [debug] [MainThread]: SQL status: SELECT 1 in 0.051 seconds
[0m09:15:38.082327 [debug] [MainThread]: On debug: Close
[0m09:15:38.084040 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:15:38.085497 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:15:38.091253 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.5926748, "process_in_blocks": "0", "process_kernel_time": 0.434382, "process_mem_max_rss": "102188", "process_out_blocks": "1488", "process_user_time": 2.00018}
[0m09:15:38.092732 [debug] [MainThread]: Command `dbt debug` succeeded at 09:15:38.092572 after 0.59 seconds
[0m09:15:38.093872 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:15:38.095080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5764631790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5762205ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57621bd2e0>]}
[0m09:15:38.097110 [debug] [MainThread]: Flushing usage events
[0m09:15:38.628563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:16:17.034442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e6b7bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e5d2f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e67ca300>]}


============================== 09:16:17.045014 | b56314c5-a4f2-4b96-9972-340ba67780ac ==============================
[0m09:16:17.045014 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:16:17.047495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select silver.processed_trials', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:16:17.326243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b56314c5-a4f2-4b96-9972-340ba67780ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e6887aa0>]}
[0m09:16:17.397092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b56314c5-a4f2-4b96-9972-340ba67780ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e4a08c80>]}
[0m09:16:17.399103 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:16:17.484234 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:16:17.488353 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:16:17.489570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b56314c5-a4f2-4b96-9972-340ba67780ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e4922ba0>]}
[0m09:16:18.741511 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.clinical_trials.processed_trials' (models/silver/processed_trials.sql) depends on a source named 'sources.raw_trials' which was not found
[0m09:16:18.744913 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7995013, "process_in_blocks": "0", "process_kernel_time": 0.378957, "process_mem_max_rss": "100356", "process_out_blocks": "1488", "process_user_time": 3.181251}
[0m09:16:18.746815 [debug] [MainThread]: Command `dbt run` failed at 09:16:18.746445 after 1.80 seconds
[0m09:16:18.748135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e5318770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e5835010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e2cad820>]}
[0m09:16:18.749457 [debug] [MainThread]: Flushing usage events
[0m09:16:19.186513 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:19:25.119529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4194557fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4194800440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f419499b530>]}


============================== 09:19:25.130776 | 932f8dd1-538f-4bdf-95fc-f72770228d33 ==============================
[0m09:19:25.130776 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:19:25.132205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select silver.processed_trials', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:19:25.397585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '932f8dd1-538f-4bdf-95fc-f72770228d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41926e4680>]}
[0m09:19:25.474751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '932f8dd1-538f-4bdf-95fc-f72770228d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41942a95e0>]}
[0m09:19:25.477093 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:19:25.549399 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:19:25.552999 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:19:25.554062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '932f8dd1-538f-4bdf-95fc-f72770228d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4193f9deb0>]}
[0m09:19:27.029125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '932f8dd1-538f-4bdf-95fc-f72770228d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f419246acf0>]}
[0m09:19:27.170070 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:19:27.181391 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:19:27.241778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '932f8dd1-538f-4bdf-95fc-f72770228d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4192771f40>]}
[0m09:19:27.243673 [info ] [MainThread]: Found 2 models, 1 source, 429 macros
[0m09:19:27.245517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '932f8dd1-538f-4bdf-95fc-f72770228d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4192469af0>]}
[0m09:19:27.248839 [info ] [MainThread]: 
[0m09:19:27.250505 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:19:27.252820 [info ] [MainThread]: 
[0m09:19:27.255685 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:19:27.261701 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m09:19:27.332060 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m09:19:27.333536 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m09:19:27.334884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:27.363682 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.029 seconds
[0m09:19:27.367390 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m09:19:27.369553 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now create_clinical_trials_silver_silver)
[0m09:19:27.371056 [debug] [ThreadPool]: Creating schema "database: "clinical_trials"
schema: "silver_silver"
"
[0m09:19:27.378209 [debug] [ThreadPool]: Using postgres connection "create_clinical_trials_silver_silver"
[0m09:19:27.381111 [debug] [ThreadPool]: On create_clinical_trials_silver_silver: BEGIN
[0m09:19:27.382788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:19:27.396952 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m09:19:27.398643 [debug] [ThreadPool]: Using postgres connection "create_clinical_trials_silver_silver"
[0m09:19:27.401186 [debug] [ThreadPool]: On create_clinical_trials_silver_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "create_clinical_trials_silver_silver"} */
create schema if not exists "silver_silver"
[0m09:19:27.414852 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.011 seconds
[0m09:19:27.417602 [debug] [ThreadPool]: On create_clinical_trials_silver_silver: COMMIT
[0m09:19:27.419122 [debug] [ThreadPool]: Using postgres connection "create_clinical_trials_silver_silver"
[0m09:19:27.420420 [debug] [ThreadPool]: On create_clinical_trials_silver_silver: COMMIT
[0m09:19:27.424428 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m09:19:27.426336 [debug] [ThreadPool]: On create_clinical_trials_silver_silver: Close
[0m09:19:27.430444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_clinical_trials_silver_silver, now list_clinical_trials_silver_silver)
[0m09:19:27.431737 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_silver_gold'
[0m09:19:27.441455 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver_silver"
[0m09:19:27.444447 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver_gold"
[0m09:19:27.445873 [debug] [ThreadPool]: On list_clinical_trials_silver_silver: BEGIN
[0m09:19:27.447048 [debug] [ThreadPool]: On list_clinical_trials_silver_gold: BEGIN
[0m09:19:27.448172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:19:27.449415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:27.459489 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m09:19:27.460575 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m09:19:27.461966 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver_silver"
[0m09:19:27.463135 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver_gold"
[0m09:19:27.464331 [debug] [ThreadPool]: On list_clinical_trials_silver_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_silver'
  
[0m09:19:27.465456 [debug] [ThreadPool]: On list_clinical_trials_silver_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_gold'
  
[0m09:19:27.493808 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.027 seconds
[0m09:19:27.494503 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.027 seconds
[0m09:19:27.496734 [debug] [ThreadPool]: On list_clinical_trials_silver_silver: ROLLBACK
[0m09:19:27.499281 [debug] [ThreadPool]: On list_clinical_trials_silver_gold: ROLLBACK
[0m09:19:27.500556 [debug] [ThreadPool]: On list_clinical_trials_silver_silver: Close
[0m09:19:27.501909 [debug] [ThreadPool]: On list_clinical_trials_silver_gold: Close
[0m09:19:27.509751 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:27.511107 [debug] [MainThread]: On master: BEGIN
[0m09:19:27.512190 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:19:27.521472 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:19:27.522888 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:27.524121 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:19:27.539862 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m09:19:27.542697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '932f8dd1-538f-4bdf-95fc-f72770228d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41924b1be0>]}
[0m09:19:27.544063 [debug] [MainThread]: On master: ROLLBACK
[0m09:19:27.545361 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:27.546277 [debug] [MainThread]: On master: BEGIN
[0m09:19:27.547585 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:19:27.548648 [debug] [MainThread]: On master: COMMIT
[0m09:19:27.549617 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:27.550549 [debug] [MainThread]: On master: COMMIT
[0m09:19:27.551668 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:19:27.552857 [debug] [MainThread]: On master: Close
[0m09:19:27.558094 [debug] [Thread-1 (]: Began running node model.clinical_trials.processed_trials
[0m09:19:27.559937 [info ] [Thread-1 (]: 1 of 1 START sql table model silver_silver.processed_trials .................... [RUN]
[0m09:19:27.561614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver_gold, now model.clinical_trials.processed_trials)
[0m09:19:27.563013 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.processed_trials
[0m09:19:27.576291 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.processed_trials"
[0m09:19:27.602163 [debug] [Thread-1 (]: Began executing node model.clinical_trials.processed_trials
[0m09:19:27.660604 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.processed_trials"
[0m09:19:27.683765 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:19:27.685261 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: BEGIN
[0m09:19:27.687003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:19:27.696234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m09:19:27.698301 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:19:27.699595 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.processed_trials"} */

  
    

  create  table "clinical_trials"."silver_silver"."processed_trials__dbt_tmp"
  
  
    as
  
  (
    

with src as (
  select
    nct_id,
    brief_title,
    study_type,
    phase,
    overall_status,
    start_date      as start_date_raw,
    completion_date as completion_date_raw,
    conditions,
    interventions,
    countries
  from "clinical_trials"."bronze"."raw_trials"
),

clean as (
  select
    nct_id,
    nullif(nullif(nullif(brief_title,''),'NA'),'UNKNOWN')       as brief_title,
    nullif(nullif(nullif(study_type,''),'NA'),'UNKNOWN')        as study_type,
    nullif(nullif(nullif(phase,''),'NA'),'NULL')                as phase_raw,
    nullif(nullif(nullif(overall_status,''),'NA'),'UNKNOWN')    as status_raw,

    case
      when start_date_raw ~ '^\d{4}-\d{2}-\d{2}$' then to_date(start_date_raw,'YYYY-MM-DD')
      when start_date_raw ~ '^\d{4}-\d{2}$'       then to_date(start_date_raw||'-01','YYYY-MM-DD')
      when start_date_raw ~ '^\d{4}$'             then to_date(start_date_raw||'-01-01','YYYY-MM-DD')
      else null
    end as start_date,

    case
      when completion_date_raw ~ '^\d{4}-\d{2}-\d{2}$' then to_date(completion_date_raw,'YYYY-MM-DD')
      when completion_date_raw ~ '^\d{4}-\d{2}$'       then to_date(completion_date_raw||'-01','YYYY-MM-DD')
      when completion_date_raw ~ '^\d{4}$'             then to_date(completion_date_raw||'-01-01','YYYY-MM-DD')
      else null
    end as completion_date,

    conditions,
    interventions,
    countries
  from src
)

select * from clean;
  );
  
[0m09:19:27.703495 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 57: select * from clean;
                            ^

[0m09:19:27.705197 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: ROLLBACK
[0m09:19:27.706879 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: Close
[0m09:19:27.712469 [debug] [Thread-1 (]: Database Error in model processed_trials (models/silver/processed_trials.sql)
  syntax error at or near ";"
  LINE 57: select * from clean;
                              ^
  compiled code at target/run/clinical_trials/models/silver/processed_trials.sql
[0m09:19:27.715148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '932f8dd1-538f-4bdf-95fc-f72770228d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41922e0440>]}
[0m09:19:27.716696 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model silver_silver.processed_trials ........... [[31mERROR[0m in 0.15s]
[0m09:19:27.718535 [debug] [Thread-1 (]: Finished running node model.clinical_trials.processed_trials
[0m09:19:27.720698 [debug] [Thread-7 (]: Marking all children of 'model.clinical_trials.processed_trials' to be skipped because of status 'error'.  Reason: Database Error in model processed_trials (models/silver/processed_trials.sql)
  syntax error at or near ";"
  LINE 57: select * from clean;
                              ^
  compiled code at target/run/clinical_trials/models/silver/processed_trials.sql.
[0m09:19:27.724717 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:27.726222 [debug] [MainThread]: On master: BEGIN
[0m09:19:27.727510 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:19:27.734599 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:19:27.736307 [debug] [MainThread]: On master: COMMIT
[0m09:19:27.737713 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:27.738695 [debug] [MainThread]: On master: COMMIT
[0m09:19:27.740012 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:19:27.741168 [debug] [MainThread]: On master: Close
[0m09:19:27.743243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:19:27.745320 [debug] [MainThread]: Connection 'list_clinical_trials_silver_silver' was properly closed.
[0m09:19:27.747198 [debug] [MainThread]: Connection 'model.clinical_trials.processed_trials' was properly closed.
[0m09:19:27.748824 [info ] [MainThread]: 
[0m09:19:27.750353 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m09:19:27.753200 [debug] [MainThread]: Command end result
[0m09:19:27.881243 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:19:27.892272 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:19:27.905134 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:19:27.906802 [info ] [MainThread]: 
[0m09:19:27.908712 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:19:27.910815 [info ] [MainThread]: 
[0m09:19:27.912628 [error] [MainThread]:   Database Error in model processed_trials (models/silver/processed_trials.sql)
  syntax error at or near ";"
  LINE 57: select * from clean;
                              ^
  compiled code at target/run/clinical_trials/models/silver/processed_trials.sql
[0m09:19:27.914090 [info ] [MainThread]: 
[0m09:19:27.916235 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:19:27.918958 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.8724365, "process_in_blocks": "0", "process_kernel_time": 0.30836, "process_mem_max_rss": "112848", "process_out_blocks": "1600", "process_user_time": 4.008683}
[0m09:19:27.920628 [debug] [MainThread]: Command `dbt run` failed at 09:19:27.920458 after 2.87 seconds
[0m09:19:27.921933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4194c67320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41941ec560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f419064d820>]}
[0m09:19:27.923309 [debug] [MainThread]: Flushing usage events
[0m09:19:28.421764 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:19:38.948650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e67165c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e65ce33b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e654e3980>]}


============================== 09:19:38.958756 | a5ee9bb2-2530-4128-b7df-05d239dbcc6d ==============================
[0m09:19:38.958756 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:19:38.960504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select silver.processed_trials', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:19:39.275089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5ee9bb2-2530-4128-b7df-05d239dbcc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e639d43b0>]}
[0m09:19:39.378321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5ee9bb2-2530-4128-b7df-05d239dbcc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e65db0140>]}
[0m09:19:39.380768 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:19:39.515854 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:19:39.862388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:19:39.865249 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/silver/processed_trials.sql
[0m09:19:40.346888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5ee9bb2-2530-4128-b7df-05d239dbcc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e63777c50>]}
[0m09:19:40.489274 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:19:40.499712 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:19:40.553404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5ee9bb2-2530-4128-b7df-05d239dbcc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e65a93a40>]}
[0m09:19:40.555324 [info ] [MainThread]: Found 2 models, 1 source, 429 macros
[0m09:19:40.557316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5ee9bb2-2530-4128-b7df-05d239dbcc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e6374cdd0>]}
[0m09:19:40.560941 [info ] [MainThread]: 
[0m09:19:40.562789 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:19:40.565100 [info ] [MainThread]: 
[0m09:19:40.567265 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:19:40.570234 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m09:19:40.647240 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m09:19:40.649064 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m09:19:40.650399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:40.661218 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m09:19:40.664769 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m09:19:40.668137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_silver_gold)
[0m09:19:40.669512 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_silver_silver'
[0m09:19:40.680333 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver_gold"
[0m09:19:40.684568 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver_silver"
[0m09:19:40.686666 [debug] [ThreadPool]: On list_clinical_trials_silver_gold: BEGIN
[0m09:19:40.688166 [debug] [ThreadPool]: On list_clinical_trials_silver_silver: BEGIN
[0m09:19:40.689592 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:19:40.690863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:40.699263 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m09:19:40.700937 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver_gold"
[0m09:19:40.701633 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m09:19:40.702815 [debug] [ThreadPool]: On list_clinical_trials_silver_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_gold'
  
[0m09:19:40.703986 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver_silver"
[0m09:19:40.706018 [debug] [ThreadPool]: On list_clinical_trials_silver_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_silver'
  
[0m09:19:40.708016 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m09:19:40.710497 [debug] [ThreadPool]: On list_clinical_trials_silver_gold: ROLLBACK
[0m09:19:40.712044 [debug] [ThreadPool]: On list_clinical_trials_silver_gold: Close
[0m09:19:40.712669 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m09:19:40.715716 [debug] [ThreadPool]: On list_clinical_trials_silver_silver: ROLLBACK
[0m09:19:40.718969 [debug] [ThreadPool]: On list_clinical_trials_silver_silver: Close
[0m09:19:40.730506 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:40.732213 [debug] [MainThread]: On master: BEGIN
[0m09:19:40.733477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:19:40.742769 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:19:40.744308 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:40.745692 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:19:40.751045 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m09:19:40.754205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5ee9bb2-2530-4128-b7df-05d239dbcc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e636a1e80>]}
[0m09:19:40.755973 [debug] [MainThread]: On master: ROLLBACK
[0m09:19:40.757984 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:40.759290 [debug] [MainThread]: On master: BEGIN
[0m09:19:40.761088 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:19:40.762250 [debug] [MainThread]: On master: COMMIT
[0m09:19:40.763357 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:40.764287 [debug] [MainThread]: On master: COMMIT
[0m09:19:40.765386 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:19:40.766246 [debug] [MainThread]: On master: Close
[0m09:19:40.773536 [debug] [Thread-1 (]: Began running node model.clinical_trials.processed_trials
[0m09:19:40.775543 [info ] [Thread-1 (]: 1 of 1 START sql table model silver_silver.processed_trials .................... [RUN]
[0m09:19:40.777253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver_silver, now model.clinical_trials.processed_trials)
[0m09:19:40.778757 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.processed_trials
[0m09:19:40.789660 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.processed_trials"
[0m09:19:40.800163 [debug] [Thread-1 (]: Began executing node model.clinical_trials.processed_trials
[0m09:19:40.879704 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.processed_trials"
[0m09:19:40.892050 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:19:40.893978 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: BEGIN
[0m09:19:40.895570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:19:40.905025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m09:19:40.907124 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:19:40.908775 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.processed_trials"} */

  
    

  create  table "clinical_trials"."silver_silver"."processed_trials__dbt_tmp"
  
  
    as
  
  (
    

with src as (
  select
    nct_id,
    brief_title,
    study_type,
    phase,
    overall_status,
    start_date      as start_date_raw,
    completion_date as completion_date_raw,
    conditions,
    interventions,
    countries
  from "clinical_trials"."bronze"."raw_trials"
),

clean as (
  select
    nct_id,
    nullif(nullif(nullif(brief_title,''),'NA'),'UNKNOWN')       as brief_title,
    nullif(nullif(nullif(study_type,''),'NA'),'UNKNOWN')        as study_type,
    nullif(nullif(nullif(phase,''),'NA'),'NULL')                as phase_raw,
    nullif(nullif(nullif(overall_status,''),'NA'),'UNKNOWN')    as status_raw,

    case
      when start_date_raw ~ '^\d{4}-\d{2}-\d{2}$' then to_date(start_date_raw,'YYYY-MM-DD')
      when start_date_raw ~ '^\d{4}-\d{2}$'       then to_date(start_date_raw||'-01','YYYY-MM-DD')
      when start_date_raw ~ '^\d{4}$'             then to_date(start_date_raw||'-01-01','YYYY-MM-DD')
      else null
    end as start_date,

    case
      when completion_date_raw ~ '^\d{4}-\d{2}-\d{2}$' then to_date(completion_date_raw,'YYYY-MM-DD')
      when completion_date_raw ~ '^\d{4}-\d{2}$'       then to_date(completion_date_raw||'-01','YYYY-MM-DD')
      when completion_date_raw ~ '^\d{4}$'             then to_date(completion_date_raw||'-01-01','YYYY-MM-DD')
      else null
    end as completion_date,

    conditions,
    interventions,
    countries
  from src
)

select * from clean
  );
  
[0m09:19:40.972145 [debug] [Thread-1 (]: SQL status: SELECT 1100 in 0.062 seconds
[0m09:19:40.984152 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:19:40.986062 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.processed_trials"} */
alter table "clinical_trials"."silver_silver"."processed_trials__dbt_tmp" rename to "processed_trials"
[0m09:19:40.989359 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:19:41.021439 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: COMMIT
[0m09:19:41.023772 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:19:41.025511 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: COMMIT
[0m09:19:41.031756 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m09:19:41.040776 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver_silver"."processed_trials__dbt_backup"
[0m09:19:41.051345 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:19:41.053183 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.processed_trials"} */
drop table if exists "clinical_trials"."silver_silver"."processed_trials__dbt_backup" cascade
[0m09:19:41.056958 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m09:19:41.061914 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: Close
[0m09:19:41.064883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5ee9bb2-2530-4128-b7df-05d239dbcc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e6721a5a0>]}
[0m09:19:41.066298 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver_silver.processed_trials ............... [[32mSELECT 1100[0m in 0.29s]
[0m09:19:41.068419 [debug] [Thread-1 (]: Finished running node model.clinical_trials.processed_trials
[0m09:19:41.072170 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:41.073457 [debug] [MainThread]: On master: BEGIN
[0m09:19:41.074508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:19:41.083432 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:19:41.084698 [debug] [MainThread]: On master: COMMIT
[0m09:19:41.086040 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:41.087894 [debug] [MainThread]: On master: COMMIT
[0m09:19:41.090685 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:19:41.092413 [debug] [MainThread]: On master: Close
[0m09:19:41.094235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:19:41.095663 [debug] [MainThread]: Connection 'list_clinical_trials_silver_gold' was properly closed.
[0m09:19:41.096791 [debug] [MainThread]: Connection 'model.clinical_trials.processed_trials' was properly closed.
[0m09:19:41.097714 [info ] [MainThread]: 
[0m09:19:41.098816 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m09:19:41.100942 [debug] [MainThread]: Command end result
[0m09:19:41.141965 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:19:41.149076 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:19:41.161450 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:19:41.162496 [info ] [MainThread]: 
[0m09:19:41.163726 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:19:41.165324 [info ] [MainThread]: 
[0m09:19:41.166792 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:19:41.169759 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2966177, "process_in_blocks": "0", "process_kernel_time": 0.391651, "process_mem_max_rss": "113248", "process_out_blocks": "1600", "process_user_time": 3.414398}
[0m09:19:41.171454 [debug] [MainThread]: Command `dbt run` succeeded at 09:19:41.171247 after 2.30 seconds
[0m09:19:41.172580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e636bff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e65f2ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e65e0b1a0>]}
[0m09:19:41.173682 [debug] [MainThread]: Flushing usage events
[0m09:19:41.625257 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:28:02.848263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af3a0d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af3744b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af3a0c710>]}


============================== 09:28:02.859008 | 65a8b7c6-e923-4e00-bb86-235902100f8b ==============================
[0m09:28:02.859008 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:28:02.860683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select silver.processed_trials', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:28:03.083314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65a8b7c6-e923-4e00-bb86-235902100f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af2d4b920>]}
[0m09:28:03.144383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65a8b7c6-e923-4e00-bb86-235902100f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af14950d0>]}
[0m09:28:03.146040 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:28:03.216305 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:28:03.430048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:28:03.431415 [debug] [MainThread]: Partial parsing: added file: clinical_trials://macros/genrate_schema_name.sql
[0m09:28:03.434425 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m09:28:04.465593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65a8b7c6-e923-4e00-bb86-235902100f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af126bf50>]}
[0m09:28:04.548167 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:28:04.554956 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:28:04.593914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65a8b7c6-e923-4e00-bb86-235902100f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af11e3920>]}
[0m09:28:04.595610 [info ] [MainThread]: Found 2 models, 1 source, 430 macros
[0m09:28:04.596969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65a8b7c6-e923-4e00-bb86-235902100f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af1242090>]}
[0m09:28:04.599527 [info ] [MainThread]: 
[0m09:28:04.601111 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:28:04.602459 [info ] [MainThread]: 
[0m09:28:04.604552 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:28:04.607587 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m09:28:04.652201 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m09:28:04.653829 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m09:28:04.655144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:04.665362 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m09:28:04.667659 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m09:28:04.669972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_gold)
[0m09:28:04.670977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_silver'
[0m09:28:04.679356 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m09:28:04.739507 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m09:28:04.740424 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m09:28:04.741227 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m09:28:04.742498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:04.743754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:04.750827 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m09:28:04.751571 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m09:28:04.752496 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m09:28:04.753667 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m09:28:04.754705 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m09:28:04.755667 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m09:28:04.759307 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m09:28:04.760270 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m09:28:04.762242 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m09:28:04.764648 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m09:28:04.765734 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m09:28:04.766698 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m09:28:04.774890 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:04.776289 [debug] [MainThread]: On master: BEGIN
[0m09:28:04.777133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:28:04.784524 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:28:04.785868 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:04.786805 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:28:04.791362 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m09:28:04.793451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65a8b7c6-e923-4e00-bb86-235902100f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af11ac2c0>]}
[0m09:28:04.794529 [debug] [MainThread]: On master: ROLLBACK
[0m09:28:04.795568 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:04.796404 [debug] [MainThread]: On master: BEGIN
[0m09:28:04.797555 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:28:04.798436 [debug] [MainThread]: On master: COMMIT
[0m09:28:04.799263 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:04.800345 [debug] [MainThread]: On master: COMMIT
[0m09:28:04.801398 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:28:04.802118 [debug] [MainThread]: On master: Close
[0m09:28:04.807333 [debug] [Thread-1 (]: Began running node model.clinical_trials.processed_trials
[0m09:28:04.808642 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.processed_trials ........................... [RUN]
[0m09:28:04.809896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver, now model.clinical_trials.processed_trials)
[0m09:28:04.811129 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.processed_trials
[0m09:28:04.819676 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.processed_trials"
[0m09:28:04.827454 [debug] [Thread-1 (]: Began executing node model.clinical_trials.processed_trials
[0m09:28:04.872197 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.processed_trials"
[0m09:28:04.881393 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:28:04.882416 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: BEGIN
[0m09:28:04.883216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:04.890410 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:28:04.891936 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:28:04.892937 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.processed_trials"} */

  
    

  create  table "clinical_trials"."silver"."processed_trials__dbt_tmp"
  
  
    as
  
  (
    

with src as (
  select
    nct_id,
    brief_title,
    study_type,
    phase,
    overall_status,
    start_date      as start_date_raw,
    completion_date as completion_date_raw,
    conditions,
    interventions,
    countries
  from "clinical_trials"."bronze"."raw_trials"
),

clean as (
  select
    nct_id,
    nullif(nullif(nullif(brief_title,''),'NA'),'UNKNOWN')       as brief_title,
    nullif(nullif(nullif(study_type,''),'NA'),'UNKNOWN')        as study_type,
    nullif(nullif(nullif(phase,''),'NA'),'NULL')                as phase_raw,
    nullif(nullif(nullif(overall_status,''),'NA'),'UNKNOWN')    as status_raw,

    case
      when start_date_raw ~ '^\d{4}-\d{2}-\d{2}$' then to_date(start_date_raw,'YYYY-MM-DD')
      when start_date_raw ~ '^\d{4}-\d{2}$'       then to_date(start_date_raw||'-01','YYYY-MM-DD')
      when start_date_raw ~ '^\d{4}$'             then to_date(start_date_raw||'-01-01','YYYY-MM-DD')
      else null
    end as start_date,

    case
      when completion_date_raw ~ '^\d{4}-\d{2}-\d{2}$' then to_date(completion_date_raw,'YYYY-MM-DD')
      when completion_date_raw ~ '^\d{4}-\d{2}$'       then to_date(completion_date_raw||'-01','YYYY-MM-DD')
      when completion_date_raw ~ '^\d{4}$'             then to_date(completion_date_raw||'-01-01','YYYY-MM-DD')
      else null
    end as completion_date,

    conditions,
    interventions,
    countries
  from src
)

select * from clean
  );
  
[0m09:28:04.925005 [debug] [Thread-1 (]: SQL status: SELECT 1100 in 0.031 seconds
[0m09:28:04.932558 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:28:04.933898 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.processed_trials"} */
alter table "clinical_trials"."silver"."processed_trials__dbt_tmp" rename to "processed_trials"
[0m09:28:04.935476 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:28:04.953778 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: COMMIT
[0m09:28:04.954810 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:28:04.955617 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: COMMIT
[0m09:28:04.959532 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m09:28:04.966945 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."processed_trials__dbt_backup"
[0m09:28:04.972754 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:28:04.973661 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.processed_trials"} */
drop table if exists "clinical_trials"."silver"."processed_trials__dbt_backup" cascade
[0m09:28:04.975362 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m09:28:04.979682 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: Close
[0m09:28:04.982884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65a8b7c6-e923-4e00-bb86-235902100f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af4cce840>]}
[0m09:28:04.984949 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.processed_trials ...................... [[32mSELECT 1100[0m in 0.17s]
[0m09:28:04.987215 [debug] [Thread-1 (]: Finished running node model.clinical_trials.processed_trials
[0m09:28:04.990545 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:04.991647 [debug] [MainThread]: On master: BEGIN
[0m09:28:04.992497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:28:04.998294 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m09:28:04.999331 [debug] [MainThread]: On master: COMMIT
[0m09:28:05.000163 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:05.000908 [debug] [MainThread]: On master: COMMIT
[0m09:28:05.002051 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:28:05.003577 [debug] [MainThread]: On master: Close
[0m09:28:05.004972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:28:05.006367 [debug] [MainThread]: Connection 'list_clinical_trials_gold' was properly closed.
[0m09:28:05.007543 [debug] [MainThread]: Connection 'model.clinical_trials.processed_trials' was properly closed.
[0m09:28:05.008779 [info ] [MainThread]: 
[0m09:28:05.010493 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m09:28:05.012690 [debug] [MainThread]: Command end result
[0m09:28:05.052309 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:28:05.059188 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:28:05.069368 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:28:05.070745 [info ] [MainThread]: 
[0m09:28:05.072266 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:28:05.073582 [info ] [MainThread]: 
[0m09:28:05.075431 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:28:05.077818 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2964773, "process_in_blocks": "0", "process_kernel_time": 0.384844, "process_mem_max_rss": "116904", "process_out_blocks": "1600", "process_user_time": 3.423092}
[0m09:28:05.079860 [debug] [MainThread]: Command `dbt run` succeeded at 09:28:05.079533 after 2.30 seconds
[0m09:28:05.081564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af2fd86b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af120df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af4d4c560>]}
[0m09:28:05.082779 [debug] [MainThread]: Flushing usage events
[0m09:28:05.637923 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:19:24.562715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d969f6420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d96573080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d966d2900>]}


============================== 13:19:24.580976 | 1389a39b-10cf-41df-a094-c05bbea617f3 ==============================
[0m13:19:24.580976 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:19:24.583348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select silver.countries', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:19:24.950735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1389a39b-10cf-41df-a094-c05bbea617f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d962d3440>]}
[0m13:19:25.038199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1389a39b-10cf-41df-a094-c05bbea617f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d96a5f560>]}
[0m13:19:25.040627 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:19:25.136444 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:19:25.462624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m13:19:25.464083 [debug] [MainThread]: Partial parsing: added file: clinical_trials://models/silver/conditions.sql
[0m13:19:25.465148 [debug] [MainThread]: Partial parsing: added file: clinical_trials://models/silver/countries.sql
[0m13:19:25.466089 [debug] [MainThread]: Partial parsing: added file: clinical_trials://models/silver/interventions.sql
[0m13:19:25.467128 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/silver/processed_trials.sql
[0m13:19:25.817394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1389a39b-10cf-41df-a094-c05bbea617f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d94a851c0>]}
[0m13:19:25.922729 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:19:25.933638 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:19:25.989540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1389a39b-10cf-41df-a094-c05bbea617f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d946b5040>]}
[0m13:19:25.991707 [info ] [MainThread]: Found 5 models, 1 source, 430 macros
[0m13:19:25.994528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1389a39b-10cf-41df-a094-c05bbea617f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d946c0560>]}
[0m13:19:26.000091 [info ] [MainThread]: 
[0m13:19:26.003154 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:19:26.005542 [info ] [MainThread]: 
[0m13:19:26.010241 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:19:26.013591 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m13:19:26.101254 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m13:19:26.102725 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m13:19:26.103772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:26.152930 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.049 seconds
[0m13:19:26.156420 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m13:19:26.165960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_gold)
[0m13:19:26.167326 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_silver'
[0m13:19:26.176652 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:19:26.180218 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:19:26.181817 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m13:19:26.183803 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m13:19:26.185097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:26.186382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:26.196904 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m13:19:26.198671 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m13:19:26.200297 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:19:26.202015 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:19:26.203522 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m13:19:26.205088 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m13:19:26.219637 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m13:19:26.220269 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m13:19:26.223399 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m13:19:26.226509 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m13:19:26.229087 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m13:19:26.230894 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m13:19:26.245202 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:26.247524 [debug] [MainThread]: On master: BEGIN
[0m13:19:26.248850 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:19:26.258668 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:19:26.260953 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:26.262550 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:19:26.273713 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m13:19:26.276769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1389a39b-10cf-41df-a094-c05bbea617f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d968158e0>]}
[0m13:19:26.278851 [debug] [MainThread]: On master: ROLLBACK
[0m13:19:26.281168 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:26.282447 [debug] [MainThread]: On master: BEGIN
[0m13:19:26.284157 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:19:26.285321 [debug] [MainThread]: On master: COMMIT
[0m13:19:26.286220 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:26.287081 [debug] [MainThread]: On master: COMMIT
[0m13:19:26.288305 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:19:26.289206 [debug] [MainThread]: On master: Close
[0m13:19:26.297196 [debug] [Thread-1 (]: Began running node model.clinical_trials.countries
[0m13:19:26.298979 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.countries .................................. [RUN]
[0m13:19:26.300503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_gold, now model.clinical_trials.countries)
[0m13:19:26.301959 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.countries
[0m13:19:26.314747 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.countries"
[0m13:19:26.326715 [debug] [Thread-1 (]: Began executing node model.clinical_trials.countries
[0m13:19:26.382130 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.countries"
[0m13:19:26.394731 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:19:26.396482 [debug] [Thread-1 (]: On model.clinical_trials.countries: BEGIN
[0m13:19:26.397811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:26.409740 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m13:19:26.411838 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:19:26.413455 [debug] [Thread-1 (]: On model.clinical_trials.countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.countries"} */

  
    

  create  table "clinical_trials"."silver"."countries__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  p.nct_id,
  nullif(trim(x), '') as country
from "clinical_trials"."silver"."processed_trials" p,
lateral regexp_split_to_table(p.countries, '\s*;\s*') as x
where p.countries is not null and p.countries <> ''
  and nullif(trim(x), '') is not null
  );
  
[0m13:19:26.863737 [debug] [Thread-1 (]: SQL status: SELECT 1557 in 0.449 seconds
[0m13:19:26.872311 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:19:26.873448 [debug] [Thread-1 (]: On model.clinical_trials.countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.countries"} */
alter table "clinical_trials"."silver"."countries__dbt_tmp" rename to "countries"
[0m13:19:26.878896 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:19:26.901460 [debug] [Thread-1 (]: On model.clinical_trials.countries: COMMIT
[0m13:19:26.903191 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:19:26.904549 [debug] [Thread-1 (]: On model.clinical_trials.countries: COMMIT
[0m13:19:26.910691 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:19:26.919399 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."countries__dbt_backup"
[0m13:19:26.926721 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:19:26.928418 [debug] [Thread-1 (]: On model.clinical_trials.countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.countries"} */
drop table if exists "clinical_trials"."silver"."countries__dbt_backup" cascade
[0m13:19:26.930250 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:19:26.933808 [debug] [Thread-1 (]: On model.clinical_trials.countries: Close
[0m13:19:26.937899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1389a39b-10cf-41df-a094-c05bbea617f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d9821e570>]}
[0m13:19:26.939732 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.countries ............................. [[32mSELECT 1557[0m in 0.64s]
[0m13:19:26.942219 [debug] [Thread-1 (]: Finished running node model.clinical_trials.countries
[0m13:19:26.947245 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:26.948799 [debug] [MainThread]: On master: BEGIN
[0m13:19:26.949916 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:19:26.957896 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:19:26.959947 [debug] [MainThread]: On master: COMMIT
[0m13:19:26.961611 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:26.963082 [debug] [MainThread]: On master: COMMIT
[0m13:19:26.964634 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:19:26.965798 [debug] [MainThread]: On master: Close
[0m13:19:26.967108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:26.968221 [debug] [MainThread]: Connection 'model.clinical_trials.countries' was properly closed.
[0m13:19:26.969251 [debug] [MainThread]: Connection 'list_clinical_trials_silver' was properly closed.
[0m13:19:26.970410 [info ] [MainThread]: 
[0m13:19:26.971657 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m13:19:26.973862 [debug] [MainThread]: Command end result
[0m13:19:27.029460 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:19:27.037116 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:19:27.051242 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:19:27.053031 [info ] [MainThread]: 
[0m13:19:27.055084 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:19:27.056856 [info ] [MainThread]: 
[0m13:19:27.058756 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:19:27.062811 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6592526, "process_in_blocks": "0", "process_kernel_time": 0.964312, "process_mem_max_rss": "113060", "process_out_blocks": "1600", "process_user_time": 3.230942}
[0m13:19:27.065153 [debug] [MainThread]: Command `dbt run` succeeded at 13:19:27.064790 after 2.66 seconds
[0m13:19:27.066922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d96e07c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d998f38c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d968cfcb0>]}
[0m13:19:27.068335 [debug] [MainThread]: Flushing usage events
[0m13:19:27.644861 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:28:08.478629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44927393a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4491c81790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4491f774a0>]}


============================== 13:28:08.488003 | 4ccef057-e3ee-4f08-a05f-5832aa45de92 ==============================
[0m13:28:08.488003 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:28:08.489832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select silver.countries', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:28:08.751816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ccef057-e3ee-4f08-a05f-5832aa45de92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44919bcc20>]}
[0m13:28:08.825875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ccef057-e3ee-4f08-a05f-5832aa45de92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44933fb0e0>]}
[0m13:28:08.827858 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:28:08.899618 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:28:09.195585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:28:09.197350 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/silver/countries.sql
[0m13:28:09.499589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ccef057-e3ee-4f08-a05f-5832aa45de92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f448fdea510>]}
[0m13:28:09.588587 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:28:09.595096 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:28:09.633695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ccef057-e3ee-4f08-a05f-5832aa45de92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f448fde2db0>]}
[0m13:28:09.635435 [info ] [MainThread]: Found 5 models, 1 source, 430 macros
[0m13:28:09.637296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ccef057-e3ee-4f08-a05f-5832aa45de92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f448ffb7590>]}
[0m13:28:09.641132 [info ] [MainThread]: 
[0m13:28:09.643948 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:28:09.645948 [info ] [MainThread]: 
[0m13:28:09.648460 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:28:09.651023 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m13:28:09.722626 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m13:28:09.723818 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m13:28:09.725207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:09.737423 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.012 seconds
[0m13:28:09.740108 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m13:28:09.747037 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_silver)
[0m13:28:09.747976 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_gold'
[0m13:28:09.754791 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:28:09.757698 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:28:09.758830 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m13:28:09.759775 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m13:28:09.760635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:09.761416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:09.769895 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:28:09.771127 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:28:09.771781 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:28:09.772978 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:28:09.774407 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m13:28:09.775471 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m13:28:09.779355 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:28:09.779883 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m13:28:09.781763 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m13:28:09.783633 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m13:28:09.784844 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m13:28:09.785667 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m13:28:09.793342 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:09.794475 [debug] [MainThread]: On master: BEGIN
[0m13:28:09.795432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:28:09.803391 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:28:09.804506 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:09.805559 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:28:09.810429 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m13:28:09.812806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ccef057-e3ee-4f08-a05f-5832aa45de92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f448d3b34a0>]}
[0m13:28:09.813983 [debug] [MainThread]: On master: ROLLBACK
[0m13:28:09.815075 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:09.815971 [debug] [MainThread]: On master: BEGIN
[0m13:28:09.817255 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:28:09.818236 [debug] [MainThread]: On master: COMMIT
[0m13:28:09.819229 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:09.820103 [debug] [MainThread]: On master: COMMIT
[0m13:28:09.821123 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:28:09.821872 [debug] [MainThread]: On master: Close
[0m13:28:09.827338 [debug] [Thread-1 (]: Began running node model.clinical_trials.countries
[0m13:28:09.828801 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.countries .................................. [RUN]
[0m13:28:09.830217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver, now model.clinical_trials.countries)
[0m13:28:09.831311 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.countries
[0m13:28:09.839304 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.countries"
[0m13:28:09.847684 [debug] [Thread-1 (]: Began executing node model.clinical_trials.countries
[0m13:28:09.895849 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.countries"
[0m13:28:09.904448 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:28:09.905564 [debug] [Thread-1 (]: On model.clinical_trials.countries: BEGIN
[0m13:28:09.906716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:09.915819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m13:28:09.917219 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:28:09.918351 [debug] [Thread-1 (]: On model.clinical_trials.countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.countries"} */

  
    

  create  table "clinical_trials"."silver"."countries__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  p.nct_id,
  nullif(trim(x), '') as country
from "clinical_trials"."bronze"."raw_trials" p,
lateral regexp_split_to_table(p.countries, '\s*;\s*') as x
where p.countries is not null and p.countries <> ''
  and nullif(trim(x), '') is not null
  );
  
[0m13:28:09.995234 [debug] [Thread-1 (]: SQL status: SELECT 1557 in 0.076 seconds
[0m13:28:10.002773 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:28:10.003767 [debug] [Thread-1 (]: On model.clinical_trials.countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.countries"} */
alter table "clinical_trials"."silver"."countries" rename to "countries__dbt_backup"
[0m13:28:10.004975 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:28:10.008224 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:28:10.009405 [debug] [Thread-1 (]: On model.clinical_trials.countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.countries"} */
alter table "clinical_trials"."silver"."countries__dbt_tmp" rename to "countries"
[0m13:28:10.010985 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:28:10.035577 [debug] [Thread-1 (]: On model.clinical_trials.countries: COMMIT
[0m13:28:10.036836 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:28:10.037855 [debug] [Thread-1 (]: On model.clinical_trials.countries: COMMIT
[0m13:28:10.041627 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:28:10.049523 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."countries__dbt_backup"
[0m13:28:10.055524 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:28:10.056740 [debug] [Thread-1 (]: On model.clinical_trials.countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.countries"} */
drop table if exists "clinical_trials"."silver"."countries__dbt_backup" cascade
[0m13:28:10.063897 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m13:28:10.068024 [debug] [Thread-1 (]: On model.clinical_trials.countries: Close
[0m13:28:10.070519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ccef057-e3ee-4f08-a05f-5832aa45de92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4492516870>]}
[0m13:28:10.072148 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.countries ............................. [[32mSELECT 1557[0m in 0.24s]
[0m13:28:10.073720 [debug] [Thread-1 (]: Finished running node model.clinical_trials.countries
[0m13:28:10.077078 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:10.078245 [debug] [MainThread]: On master: BEGIN
[0m13:28:10.078986 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:28:10.087374 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:28:10.088915 [debug] [MainThread]: On master: COMMIT
[0m13:28:10.089902 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:10.090789 [debug] [MainThread]: On master: COMMIT
[0m13:28:10.092097 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:28:10.093037 [debug] [MainThread]: On master: Close
[0m13:28:10.094212 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:10.095379 [debug] [MainThread]: Connection 'model.clinical_trials.countries' was properly closed.
[0m13:28:10.096347 [debug] [MainThread]: Connection 'list_clinical_trials_gold' was properly closed.
[0m13:28:10.097324 [info ] [MainThread]: 
[0m13:28:10.098523 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m13:28:10.100608 [debug] [MainThread]: Command end result
[0m13:28:10.138712 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:28:10.145790 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:28:10.157430 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:28:10.159061 [info ] [MainThread]: 
[0m13:28:10.161023 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:28:10.163233 [info ] [MainThread]: 
[0m13:28:10.164717 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:28:10.167077 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7998347, "process_in_blocks": "0", "process_kernel_time": 0.518089, "process_mem_max_rss": "112900", "process_out_blocks": "1600", "process_user_time": 2.819601}
[0m13:28:10.168771 [debug] [MainThread]: Command `dbt run` succeeded at 13:28:10.168603 after 1.80 seconds
[0m13:28:10.169827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4492332780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f449326c530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f448fd17230>]}
[0m13:28:10.170771 [debug] [MainThread]: Flushing usage events
[0m13:28:10.670930 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:32:16.970439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d26d2870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d1d3b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d26d24e0>]}


============================== 13:32:16.987355 | 3cbf0f94-dae0-4f94-8ebd-659eb9274e75 ==============================
[0m13:32:16.987355 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:32:16.990379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select silver.conditions', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:32:17.369786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cbf0f94-dae0-4f94-8ebd-659eb9274e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d01f1940>]}
[0m13:32:17.475735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3cbf0f94-dae0-4f94-8ebd-659eb9274e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d1f22600>]}
[0m13:32:17.478233 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:32:17.574692 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:32:17.914355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:32:17.916101 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/silver/interventions.sql
[0m13:32:17.918102 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/silver/conditions.sql
[0m13:32:18.341322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cbf0f94-dae0-4f94-8ebd-659eb9274e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07cfdae000>]}
[0m13:32:18.440587 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:32:18.448914 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:32:18.493201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cbf0f94-dae0-4f94-8ebd-659eb9274e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ce0bce00>]}
[0m13:32:18.495406 [info ] [MainThread]: Found 5 models, 1 source, 430 macros
[0m13:32:18.498160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cbf0f94-dae0-4f94-8ebd-659eb9274e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07cfe9a510>]}
[0m13:32:18.501852 [info ] [MainThread]: 
[0m13:32:18.503264 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:32:18.504783 [info ] [MainThread]: 
[0m13:32:18.506556 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:32:18.509279 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m13:32:18.569454 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m13:32:18.570882 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m13:32:18.571789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:18.582726 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m13:32:18.585625 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m13:32:18.591637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_gold)
[0m13:32:18.592527 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_silver'
[0m13:32:18.599633 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:32:18.602184 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:32:18.603271 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m13:32:18.604060 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m13:32:18.604902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:18.605594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:18.612610 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:32:18.614083 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:32:18.615109 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:32:18.615619 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m13:32:18.616553 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:32:18.618037 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m13:32:18.620359 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:32:18.622530 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m13:32:18.623642 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m13:32:18.624314 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m13:32:18.627532 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m13:32:18.628625 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m13:32:18.636558 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:18.637846 [debug] [MainThread]: On master: BEGIN
[0m13:32:18.638792 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:32:18.646054 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:32:18.647204 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:18.648387 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:32:18.653442 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m13:32:18.656321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cbf0f94-dae0-4f94-8ebd-659eb9274e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07cff6b110>]}
[0m13:32:18.657574 [debug] [MainThread]: On master: ROLLBACK
[0m13:32:18.658932 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:18.659888 [debug] [MainThread]: On master: BEGIN
[0m13:32:18.661076 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:32:18.662057 [debug] [MainThread]: On master: COMMIT
[0m13:32:18.662941 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:18.663988 [debug] [MainThread]: On master: COMMIT
[0m13:32:18.665129 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:32:18.666012 [debug] [MainThread]: On master: Close
[0m13:32:18.671914 [debug] [Thread-1 (]: Began running node model.clinical_trials.conditions
[0m13:32:18.673322 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.conditions ................................. [RUN]
[0m13:32:18.675661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver, now model.clinical_trials.conditions)
[0m13:32:18.676690 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.conditions
[0m13:32:18.686975 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.conditions"
[0m13:32:18.699272 [debug] [Thread-1 (]: Began executing node model.clinical_trials.conditions
[0m13:32:18.742966 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.conditions"
[0m13:32:18.755053 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.conditions"
[0m13:32:18.756145 [debug] [Thread-1 (]: On model.clinical_trials.conditions: BEGIN
[0m13:32:18.757108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:18.768402 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m13:32:18.770046 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.conditions"
[0m13:32:18.771117 [debug] [Thread-1 (]: On model.clinical_trials.conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.conditions"} */

  
    

  create  table "clinical_trials"."silver"."conditions__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  p.nct_id,
  nullif(trim(x), '') as condition
from "clinical_trials"."bronze"."raw_trials" p,
lateral regexp_split_to_table(p.conditions, '\s*;\s*') as x
where p.conditions is not null and p.conditions <> ''
  and nullif(trim(x), '') is not null
  );
  
[0m13:32:18.828020 [debug] [Thread-1 (]: SQL status: SELECT 2037 in 0.056 seconds
[0m13:32:18.838229 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.conditions"
[0m13:32:18.839452 [debug] [Thread-1 (]: On model.clinical_trials.conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.conditions"} */
alter table "clinical_trials"."silver"."conditions__dbt_tmp" rename to "conditions"
[0m13:32:18.841196 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:32:18.866500 [debug] [Thread-1 (]: On model.clinical_trials.conditions: COMMIT
[0m13:32:18.868046 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.conditions"
[0m13:32:18.869322 [debug] [Thread-1 (]: On model.clinical_trials.conditions: COMMIT
[0m13:32:18.873096 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:32:18.880861 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."conditions__dbt_backup"
[0m13:32:18.887843 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.conditions"
[0m13:32:18.889489 [debug] [Thread-1 (]: On model.clinical_trials.conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.conditions"} */
drop table if exists "clinical_trials"."silver"."conditions__dbt_backup" cascade
[0m13:32:18.891294 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:32:18.894792 [debug] [Thread-1 (]: On model.clinical_trials.conditions: Close
[0m13:32:18.898774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cbf0f94-dae0-4f94-8ebd-659eb9274e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d38a81a0>]}
[0m13:32:18.901155 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.conditions ............................ [[32mSELECT 2037[0m in 0.22s]
[0m13:32:18.902846 [debug] [Thread-1 (]: Finished running node model.clinical_trials.conditions
[0m13:32:18.906229 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:18.907294 [debug] [MainThread]: On master: BEGIN
[0m13:32:18.908260 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:32:18.916682 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:32:18.918338 [debug] [MainThread]: On master: COMMIT
[0m13:32:18.919892 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:18.921271 [debug] [MainThread]: On master: COMMIT
[0m13:32:18.922880 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:32:18.924030 [debug] [MainThread]: On master: Close
[0m13:32:18.925259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:18.926181 [debug] [MainThread]: Connection 'list_clinical_trials_gold' was properly closed.
[0m13:32:18.927116 [debug] [MainThread]: Connection 'model.clinical_trials.conditions' was properly closed.
[0m13:32:18.928126 [info ] [MainThread]: 
[0m13:32:18.929206 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m13:32:18.931031 [debug] [MainThread]: Command end result
[0m13:32:18.976583 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:32:18.982741 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:32:18.994751 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:32:18.996350 [info ] [MainThread]: 
[0m13:32:18.997718 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:32:18.999122 [info ] [MainThread]: 
[0m13:32:19.001039 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:32:19.003520 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1566768, "process_in_blocks": "0", "process_kernel_time": 0.494453, "process_mem_max_rss": "113064", "process_out_blocks": "1600", "process_user_time": 3.693264}
[0m13:32:19.005051 [debug] [MainThread]: Command `dbt run` succeeded at 13:32:19.004885 after 2.16 seconds
[0m13:32:19.006121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d1d3b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d1a99ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07cff8e4b0>]}
[0m13:32:19.007366 [debug] [MainThread]: Flushing usage events
[0m13:32:19.460803 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:32:31.763515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc472f560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc4407b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc472d9a0>]}


============================== 13:32:31.772670 | 5f1fa970-2c75-4024-8ae9-2bab80d221b8 ==============================
[0m13:32:31.772670 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:32:31.774070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select silver.interventions', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:32:32.008212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f1fa970-2c75-4024-8ae9-2bab80d221b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc2512f30>]}
[0m13:32:32.073164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f1fa970-2c75-4024-8ae9-2bab80d221b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc4b10b00>]}
[0m13:32:32.075006 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:32:32.142346 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:32:32.389989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:32:32.391504 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:32:32.434362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f1fa970-2c75-4024-8ae9-2bab80d221b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc2594050>]}
[0m13:32:32.525786 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:32:32.532936 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:32:32.572490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f1fa970-2c75-4024-8ae9-2bab80d221b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc2288860>]}
[0m13:32:32.574338 [info ] [MainThread]: Found 5 models, 1 source, 430 macros
[0m13:32:32.575895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f1fa970-2c75-4024-8ae9-2bab80d221b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc2260830>]}
[0m13:32:32.579505 [info ] [MainThread]: 
[0m13:32:32.581177 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:32:32.582772 [info ] [MainThread]: 
[0m13:32:32.584740 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:32:32.587244 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m13:32:32.638344 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m13:32:32.639676 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m13:32:32.640749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:32.650546 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m13:32:32.653763 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m13:32:32.661349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_gold)
[0m13:32:32.662170 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_silver'
[0m13:32:32.671184 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:32:32.675390 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:32:32.676633 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m13:32:32.677572 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m13:32:32.678339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:32.679110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:32.687103 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:32:32.687696 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:32:32.688620 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:32:32.689630 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:32:32.690621 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m13:32:32.691580 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m13:32:32.694848 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m13:32:32.695336 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:32:32.697670 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m13:32:32.699322 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m13:32:32.700538 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m13:32:32.701387 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m13:32:32.710347 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:32.711565 [debug] [MainThread]: On master: BEGIN
[0m13:32:32.712468 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:32:32.719820 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:32:32.721175 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:32.722539 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:32:32.727646 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m13:32:32.729914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f1fa970-2c75-4024-8ae9-2bab80d221b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc3d6b770>]}
[0m13:32:32.730947 [debug] [MainThread]: On master: ROLLBACK
[0m13:32:32.731897 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:32.732740 [debug] [MainThread]: On master: BEGIN
[0m13:32:32.734205 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:32:32.735400 [debug] [MainThread]: On master: COMMIT
[0m13:32:32.736391 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:32.737293 [debug] [MainThread]: On master: COMMIT
[0m13:32:32.738444 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:32:32.739226 [debug] [MainThread]: On master: Close
[0m13:32:32.744339 [debug] [Thread-1 (]: Began running node model.clinical_trials.interventions
[0m13:32:32.745551 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.interventions .............................. [RUN]
[0m13:32:32.746687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_gold, now model.clinical_trials.interventions)
[0m13:32:32.747829 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.interventions
[0m13:32:32.759171 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.interventions"
[0m13:32:32.768026 [debug] [Thread-1 (]: Began executing node model.clinical_trials.interventions
[0m13:32:32.809096 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.interventions"
[0m13:32:32.818128 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.interventions"
[0m13:32:32.819311 [debug] [Thread-1 (]: On model.clinical_trials.interventions: BEGIN
[0m13:32:32.820309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:32.827587 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m13:32:32.829388 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.interventions"
[0m13:32:32.830574 [debug] [Thread-1 (]: On model.clinical_trials.interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.interventions"} */

  
    

  create  table "clinical_trials"."silver"."interventions__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  p.nct_id,
  nullif(trim(x), '') as intervention
from "clinical_trials"."bronze"."raw_trials" p,
lateral regexp_split_to_table(p.interventions, '\s*;\s*') as x
where p.interventions is not null and p.interventions <> ''
  and nullif(trim(x), '') is not null
  );
  
[0m13:32:32.875546 [debug] [Thread-1 (]: SQL status: SELECT 1890 in 0.044 seconds
[0m13:32:32.885452 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.interventions"
[0m13:32:32.886684 [debug] [Thread-1 (]: On model.clinical_trials.interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.interventions"} */
alter table "clinical_trials"."silver"."interventions__dbt_tmp" rename to "interventions"
[0m13:32:32.888057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:32:32.912513 [debug] [Thread-1 (]: On model.clinical_trials.interventions: COMMIT
[0m13:32:32.913762 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.interventions"
[0m13:32:32.914668 [debug] [Thread-1 (]: On model.clinical_trials.interventions: COMMIT
[0m13:32:32.918146 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:32:32.924787 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."interventions__dbt_backup"
[0m13:32:32.932930 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.interventions"
[0m13:32:32.933967 [debug] [Thread-1 (]: On model.clinical_trials.interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.interventions"} */
drop table if exists "clinical_trials"."silver"."interventions__dbt_backup" cascade
[0m13:32:32.935358 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:32:32.938715 [debug] [Thread-1 (]: On model.clinical_trials.interventions: Close
[0m13:32:32.940969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f1fa970-2c75-4024-8ae9-2bab80d221b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc5d1a8a0>]}
[0m13:32:32.942396 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.interventions ......................... [[32mSELECT 1890[0m in 0.19s]
[0m13:32:32.944129 [debug] [Thread-1 (]: Finished running node model.clinical_trials.interventions
[0m13:32:32.946889 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:32.947801 [debug] [MainThread]: On master: BEGIN
[0m13:32:32.948700 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:32:32.955411 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:32:32.956704 [debug] [MainThread]: On master: COMMIT
[0m13:32:32.957617 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:32.958499 [debug] [MainThread]: On master: COMMIT
[0m13:32:32.959644 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:32:32.960643 [debug] [MainThread]: On master: Close
[0m13:32:32.962031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:32.963637 [debug] [MainThread]: Connection 'model.clinical_trials.interventions' was properly closed.
[0m13:32:32.965136 [debug] [MainThread]: Connection 'list_clinical_trials_silver' was properly closed.
[0m13:32:32.966608 [info ] [MainThread]: 
[0m13:32:32.968084 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m13:32:32.970598 [debug] [MainThread]: Command end result
[0m13:32:33.009781 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:32:33.016173 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:32:33.028076 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:32:33.029290 [info ] [MainThread]: 
[0m13:32:33.030466 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:32:33.032796 [info ] [MainThread]: 
[0m13:32:33.034990 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:32:33.037122 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3402829, "process_in_blocks": "0", "process_kernel_time": 0.359235, "process_mem_max_rss": "109728", "process_out_blocks": "1600", "process_user_time": 2.444793}
[0m13:32:33.038630 [debug] [MainThread]: Command `dbt run` succeeded at 13:32:33.038469 after 1.34 seconds
[0m13:32:33.039668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc3e29700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc3fc52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc3fc6e40>]}
[0m13:32:33.040597 [debug] [MainThread]: Flushing usage events
[0m13:32:33.467064 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:49.216879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a324c2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a30c1a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a30c191f0>]}


============================== 13:44:49.233886 | d92dee30-4d79-4866-8e63-e20ca2876fd1 ==============================
[0m13:44:49.233886 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:44:49.235960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select silver.conditions', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:44:49.483781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd92dee30-4d79-4866-8e63-e20ca2876fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3257f890>]}
[0m13:44:49.548694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd92dee30-4d79-4866-8e63-e20ca2876fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a306f8f50>]}
[0m13:44:49.550624 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:44:49.631659 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:44:49.890571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:44:49.891840 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/silver/conditions.sql
[0m13:44:49.892846 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/silver/processed_trials.sql
[0m13:44:50.194361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd92dee30-4d79-4866-8e63-e20ca2876fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2ea3d3d0>]}
[0m13:44:50.301444 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:44:50.316289 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:44:50.388653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd92dee30-4d79-4866-8e63-e20ca2876fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2ce3cef0>]}
[0m13:44:50.390015 [info ] [MainThread]: Found 5 models, 1 source, 430 macros
[0m13:44:50.391276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd92dee30-4d79-4866-8e63-e20ca2876fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2eaef1d0>]}
[0m13:44:50.395041 [info ] [MainThread]: 
[0m13:44:50.397184 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:44:50.398917 [info ] [MainThread]: 
[0m13:44:50.400956 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:44:50.403580 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m13:44:50.478905 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m13:44:50.480706 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m13:44:50.481773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:50.503624 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.022 seconds
[0m13:44:50.506596 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m13:44:50.513293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_gold)
[0m13:44:50.516365 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_silver'
[0m13:44:50.522994 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:44:50.526023 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:44:50.527327 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m13:44:50.528550 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m13:44:50.529709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:50.530753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:50.540402 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:44:50.541969 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:44:50.543218 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m13:44:50.543881 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m13:44:50.545652 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:44:50.546813 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m13:44:50.550351 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m13:44:50.552667 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m13:44:50.553357 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m13:44:50.554169 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m13:44:50.556819 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m13:44:50.559454 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m13:44:50.567710 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:50.569111 [debug] [MainThread]: On master: BEGIN
[0m13:44:50.570128 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:50.578046 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:44:50.579857 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:50.581003 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:44:50.588020 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m13:44:50.590853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd92dee30-4d79-4866-8e63-e20ca2876fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2eaef1a0>]}
[0m13:44:50.592118 [debug] [MainThread]: On master: ROLLBACK
[0m13:44:50.593463 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:50.594863 [debug] [MainThread]: On master: BEGIN
[0m13:44:50.596298 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:44:50.597424 [debug] [MainThread]: On master: COMMIT
[0m13:44:50.598687 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:50.599674 [debug] [MainThread]: On master: COMMIT
[0m13:44:50.600861 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:44:50.601761 [debug] [MainThread]: On master: Close
[0m13:44:50.605878 [debug] [Thread-1 (]: Began running node model.clinical_trials.conditions
[0m13:44:50.607138 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.conditions ................................. [RUN]
[0m13:44:50.608572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver, now model.clinical_trials.conditions)
[0m13:44:50.610117 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.conditions
[0m13:44:50.621531 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.conditions"
[0m13:44:50.631989 [debug] [Thread-1 (]: Began executing node model.clinical_trials.conditions
[0m13:44:50.676378 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.conditions"
[0m13:44:50.687656 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.conditions"
[0m13:44:50.689173 [debug] [Thread-1 (]: On model.clinical_trials.conditions: BEGIN
[0m13:44:50.690488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:50.701179 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m13:44:50.703027 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.conditions"
[0m13:44:50.704211 [debug] [Thread-1 (]: On model.clinical_trials.conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.conditions"} */

  
    

  create  table "clinical_trials"."silver"."conditions__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  p.nct_id,
  nullif(trim(x), '') as condition
from "clinical_trials"."bronze"."raw_trials" p,
lateral regexp_split_to_table(p.conditions, '\s*[;,]\s*') as x
where p.conditions is not null and p.conditions <> ''
  and nullif(trim(x), '') is not null
  );
  
[0m13:44:50.896549 [debug] [Thread-1 (]: SQL status: SELECT 2168 in 0.191 seconds
[0m13:44:50.907500 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.conditions"
[0m13:44:50.909041 [debug] [Thread-1 (]: On model.clinical_trials.conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.conditions"} */
alter table "clinical_trials"."silver"."conditions" rename to "conditions__dbt_backup"
[0m13:44:50.911265 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:44:50.915325 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.conditions"
[0m13:44:50.916399 [debug] [Thread-1 (]: On model.clinical_trials.conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.conditions"} */
alter table "clinical_trials"."silver"."conditions__dbt_tmp" rename to "conditions"
[0m13:44:50.917945 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:44:50.940734 [debug] [Thread-1 (]: On model.clinical_trials.conditions: COMMIT
[0m13:44:50.942245 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.conditions"
[0m13:44:50.943455 [debug] [Thread-1 (]: On model.clinical_trials.conditions: COMMIT
[0m13:44:50.950228 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:44:50.957750 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."conditions__dbt_backup"
[0m13:44:50.966608 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.conditions"
[0m13:44:50.968006 [debug] [Thread-1 (]: On model.clinical_trials.conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.conditions"} */
drop table if exists "clinical_trials"."silver"."conditions__dbt_backup" cascade
[0m13:44:50.973258 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m13:44:50.976496 [debug] [Thread-1 (]: On model.clinical_trials.conditions: Close
[0m13:44:50.980341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd92dee30-4d79-4866-8e63-e20ca2876fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2c09fc20>]}
[0m13:44:50.982409 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.conditions ............................ [[32mSELECT 2168[0m in 0.37s]
[0m13:44:50.984713 [debug] [Thread-1 (]: Finished running node model.clinical_trials.conditions
[0m13:44:50.988092 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:50.989347 [debug] [MainThread]: On master: BEGIN
[0m13:44:50.990432 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:44:50.999951 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:44:51.001875 [debug] [MainThread]: On master: COMMIT
[0m13:44:51.003110 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:51.004279 [debug] [MainThread]: On master: COMMIT
[0m13:44:51.005823 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:44:51.007306 [debug] [MainThread]: On master: Close
[0m13:44:51.008772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:51.010501 [debug] [MainThread]: Connection 'list_clinical_trials_gold' was properly closed.
[0m13:44:51.012475 [debug] [MainThread]: Connection 'model.clinical_trials.conditions' was properly closed.
[0m13:44:51.014706 [info ] [MainThread]: 
[0m13:44:51.016429 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m13:44:51.018844 [debug] [MainThread]: Command end result
[0m13:44:51.070258 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:44:51.077717 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:44:51.094645 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:44:51.096304 [info ] [MainThread]: 
[0m13:44:51.098148 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:44:51.099851 [info ] [MainThread]: 
[0m13:44:51.101389 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:44:51.104753 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9550927, "process_in_blocks": "0", "process_kernel_time": 0.818072, "process_mem_max_rss": "112032", "process_out_blocks": "1600", "process_user_time": 2.716807}
[0m13:44:51.106399 [debug] [MainThread]: Command `dbt run` succeeded at 13:44:51.106198 after 1.96 seconds
[0m13:44:51.107819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3090b9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a31152f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3257e960>]}
[0m13:44:51.109198 [debug] [MainThread]: Flushing usage events
[0m13:44:51.666328 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:34.697945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbb0545d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbafbff800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbaec22540>]}


============================== 13:47:34.707135 | a7f78a47-ed71-4364-818e-66eef2df4161 ==============================
[0m13:47:34.707135 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:47:34.709423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select silver.countries', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:47:34.947764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7f78a47-ed71-4364-818e-66eef2df4161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbae625af0>]}
[0m13:47:35.015161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7f78a47-ed71-4364-818e-66eef2df4161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbae763ef0>]}
[0m13:47:35.018198 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:47:35.090447 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:47:35.384089 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:47:35.386151 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/silver/interventions.sql
[0m13:47:35.387813 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/silver/countries.sql
[0m13:47:35.389781 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/silver/processed_trials.sql
[0m13:47:35.828493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7f78a47-ed71-4364-818e-66eef2df4161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbac9dd850>]}
[0m13:47:35.966028 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:47:35.980239 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:47:36.058368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7f78a47-ed71-4364-818e-66eef2df4161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbaca78e60>]}
[0m13:47:36.060692 [info ] [MainThread]: Found 5 models, 1 source, 430 macros
[0m13:47:36.062616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7f78a47-ed71-4364-818e-66eef2df4161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbaca9e5d0>]}
[0m13:47:36.066177 [info ] [MainThread]: 
[0m13:47:36.067704 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:47:36.069563 [info ] [MainThread]: 
[0m13:47:36.073973 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:47:36.077795 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m13:47:36.159104 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m13:47:36.160626 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m13:47:36.162445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:36.180748 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.018 seconds
[0m13:47:36.183708 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m13:47:36.191774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_gold)
[0m13:47:36.192862 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_silver'
[0m13:47:36.200503 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:47:36.204077 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:47:36.205826 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m13:47:36.206982 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m13:47:36.208275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:36.209257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:36.218444 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:47:36.219515 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:47:36.220359 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:47:36.221614 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:47:36.222955 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m13:47:36.224079 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m13:47:36.228973 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m13:47:36.229464 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m13:47:36.233250 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m13:47:36.236116 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m13:47:36.237624 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m13:47:36.238547 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m13:47:36.248767 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:36.250229 [debug] [MainThread]: On master: BEGIN
[0m13:47:36.251503 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:47:36.261942 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:47:36.263590 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:36.265080 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:47:36.272852 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m13:47:36.275409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7f78a47-ed71-4364-818e-66eef2df4161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbaca78a40>]}
[0m13:47:36.276695 [debug] [MainThread]: On master: ROLLBACK
[0m13:47:36.277946 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:36.279048 [debug] [MainThread]: On master: BEGIN
[0m13:47:36.280407 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:47:36.281871 [debug] [MainThread]: On master: COMMIT
[0m13:47:36.282899 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:36.283918 [debug] [MainThread]: On master: COMMIT
[0m13:47:36.285118 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:47:36.286120 [debug] [MainThread]: On master: Close
[0m13:47:36.293282 [debug] [Thread-1 (]: Began running node model.clinical_trials.countries
[0m13:47:36.294880 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.countries .................................. [RUN]
[0m13:47:36.296577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_gold, now model.clinical_trials.countries)
[0m13:47:36.298141 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.countries
[0m13:47:36.310404 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.countries"
[0m13:47:36.321954 [debug] [Thread-1 (]: Began executing node model.clinical_trials.countries
[0m13:47:36.371397 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.countries"
[0m13:47:36.383728 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:47:36.385069 [debug] [Thread-1 (]: On model.clinical_trials.countries: BEGIN
[0m13:47:36.386205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:36.395280 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m13:47:36.396970 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:47:36.398462 [debug] [Thread-1 (]: On model.clinical_trials.countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.countries"} */

  
    

  create  table "clinical_trials"."silver"."countries__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  p.nct_id,
  nullif(trim(x), '') as country
from "clinical_trials"."bronze"."raw_trials" p,
lateral regexp_split_to_table(p.countries, '\s*[;,]\s*') as x
where p.countries is not null and p.countries <> ''
  and nullif(trim(x), '') is not null
  );
  
[0m13:47:36.516019 [debug] [Thread-1 (]: SQL status: SELECT 1557 in 0.116 seconds
[0m13:47:36.524787 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:47:36.525975 [debug] [Thread-1 (]: On model.clinical_trials.countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.countries"} */
alter table "clinical_trials"."silver"."countries" rename to "countries__dbt_backup"
[0m13:47:36.527609 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:47:36.531379 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:47:36.533076 [debug] [Thread-1 (]: On model.clinical_trials.countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.countries"} */
alter table "clinical_trials"."silver"."countries__dbt_tmp" rename to "countries"
[0m13:47:36.534814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:47:36.558048 [debug] [Thread-1 (]: On model.clinical_trials.countries: COMMIT
[0m13:47:36.559128 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:47:36.560212 [debug] [Thread-1 (]: On model.clinical_trials.countries: COMMIT
[0m13:47:36.564550 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:47:36.572212 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."countries__dbt_backup"
[0m13:47:36.579009 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:47:36.580657 [debug] [Thread-1 (]: On model.clinical_trials.countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.countries"} */
drop table if exists "clinical_trials"."silver"."countries__dbt_backup" cascade
[0m13:47:36.585246 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m13:47:36.589203 [debug] [Thread-1 (]: On model.clinical_trials.countries: Close
[0m13:47:36.592179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7f78a47-ed71-4364-818e-66eef2df4161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbb06024b0>]}
[0m13:47:36.593781 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.countries ............................. [[32mSELECT 1557[0m in 0.29s]
[0m13:47:36.595230 [debug] [Thread-1 (]: Finished running node model.clinical_trials.countries
[0m13:47:36.598484 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:36.599672 [debug] [MainThread]: On master: BEGIN
[0m13:47:36.600750 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:47:36.611329 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:47:36.612813 [debug] [MainThread]: On master: COMMIT
[0m13:47:36.614066 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:36.615271 [debug] [MainThread]: On master: COMMIT
[0m13:47:36.616843 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:47:36.617968 [debug] [MainThread]: On master: Close
[0m13:47:36.619293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:36.620361 [debug] [MainThread]: Connection 'model.clinical_trials.countries' was properly closed.
[0m13:47:36.621322 [debug] [MainThread]: Connection 'list_clinical_trials_silver' was properly closed.
[0m13:47:36.622515 [info ] [MainThread]: 
[0m13:47:36.624158 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m13:47:36.627150 [debug] [MainThread]: Command end result
[0m13:47:36.673933 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:47:36.681450 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:47:36.696079 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:47:36.697225 [info ] [MainThread]: 
[0m13:47:36.698659 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:47:36.700523 [info ] [MainThread]: 
[0m13:47:36.702329 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:47:36.705161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0756648, "process_in_blocks": "0", "process_kernel_time": 0.400554, "process_mem_max_rss": "115156", "process_out_blocks": "1600", "process_user_time": 2.944078}
[0m13:47:36.706880 [debug] [MainThread]: Command `dbt run` succeeded at 13:47:36.706705 after 2.08 seconds
[0m13:47:36.708068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbae8e8da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbaca58590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbae78c2c0>]}
[0m13:47:36.709225 [debug] [MainThread]: Flushing usage events
[0m13:47:37.220763 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:46.546428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1703920560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17054d8140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1703c4a3f0>]}


============================== 13:47:46.565572 | d2fc3f2d-07e8-4bb9-99b6-7c9426b8392f ==============================
[0m13:47:46.565572 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:47:46.567656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select silver.interventions', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:47:46.871405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2fc3f2d-07e8-4bb9-99b6-7c9426b8392f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17036f6270>]}
[0m13:47:46.950541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2fc3f2d-07e8-4bb9-99b6-7c9426b8392f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17034b76e0>]}
[0m13:47:46.952576 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:47:47.037969 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:47:47.339602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:47:47.341030 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:47:47.386891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2fc3f2d-07e8-4bb9-99b6-7c9426b8392f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1703b23bc0>]}
[0m13:47:47.490042 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:47:47.497745 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:47:47.541909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2fc3f2d-07e8-4bb9-99b6-7c9426b8392f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1701a27ec0>]}
[0m13:47:47.544409 [info ] [MainThread]: Found 5 models, 1 source, 430 macros
[0m13:47:47.546839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2fc3f2d-07e8-4bb9-99b6-7c9426b8392f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1701b150d0>]}
[0m13:47:47.552015 [info ] [MainThread]: 
[0m13:47:47.553740 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:47:47.555180 [info ] [MainThread]: 
[0m13:47:47.557622 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:47:47.560177 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m13:47:47.629036 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m13:47:47.630729 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m13:47:47.631827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:47.645689 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.014 seconds
[0m13:47:47.648361 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m13:47:47.656466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_silver)
[0m13:47:47.657506 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_gold'
[0m13:47:47.666878 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:47:47.669266 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:47:47.670337 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m13:47:47.671502 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m13:47:47.672328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:47.673346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:47.681378 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:47:47.681942 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:47:47.682903 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:47:47.683823 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:47:47.684616 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m13:47:47.685571 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m13:47:47.689400 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:47:47.689969 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m13:47:47.691840 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m13:47:47.694120 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m13:47:47.695412 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m13:47:47.696237 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m13:47:47.705053 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:47.706429 [debug] [MainThread]: On master: BEGIN
[0m13:47:47.707493 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:47:47.716432 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:47:47.717613 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:47.718802 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:47:47.724992 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m13:47:47.727715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2fc3f2d-07e8-4bb9-99b6-7c9426b8392f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1701cbeab0>]}
[0m13:47:47.728973 [debug] [MainThread]: On master: ROLLBACK
[0m13:47:47.730274 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:47.731598 [debug] [MainThread]: On master: BEGIN
[0m13:47:47.733084 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:47:47.734249 [debug] [MainThread]: On master: COMMIT
[0m13:47:47.735308 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:47.736331 [debug] [MainThread]: On master: COMMIT
[0m13:47:47.737395 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:47:47.738266 [debug] [MainThread]: On master: Close
[0m13:47:47.744727 [debug] [Thread-1 (]: Began running node model.clinical_trials.interventions
[0m13:47:47.746243 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.interventions .............................. [RUN]
[0m13:47:47.748527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver, now model.clinical_trials.interventions)
[0m13:47:47.750404 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.interventions
[0m13:47:47.761263 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.interventions"
[0m13:47:47.772876 [debug] [Thread-1 (]: Began executing node model.clinical_trials.interventions
[0m13:47:47.824902 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.interventions"
[0m13:47:47.835727 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.interventions"
[0m13:47:47.837808 [debug] [Thread-1 (]: On model.clinical_trials.interventions: BEGIN
[0m13:47:47.839429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:47.849416 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m13:47:47.851054 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.interventions"
[0m13:47:47.852239 [debug] [Thread-1 (]: On model.clinical_trials.interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.interventions"} */

  
    

  create  table "clinical_trials"."silver"."interventions__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  p.nct_id,
  nullif(trim(x), '') as intervention
from "clinical_trials"."bronze"."raw_trials" p,
lateral regexp_split_to_table(p.interventions, '\s*[;,]\s*') as x
where p.interventions is not null and p.interventions <> ''
  and nullif(trim(x), '') is not null
  );
  
[0m13:47:47.911428 [debug] [Thread-1 (]: SQL status: SELECT 1928 in 0.058 seconds
[0m13:47:47.921899 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.interventions"
[0m13:47:47.923781 [debug] [Thread-1 (]: On model.clinical_trials.interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.interventions"} */
alter table "clinical_trials"."silver"."interventions" rename to "interventions__dbt_backup"
[0m13:47:47.925641 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:47:47.930342 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.interventions"
[0m13:47:47.931785 [debug] [Thread-1 (]: On model.clinical_trials.interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.interventions"} */
alter table "clinical_trials"."silver"."interventions__dbt_tmp" rename to "interventions"
[0m13:47:47.933682 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:47:47.971507 [debug] [Thread-1 (]: On model.clinical_trials.interventions: COMMIT
[0m13:47:47.973800 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.interventions"
[0m13:47:47.975057 [debug] [Thread-1 (]: On model.clinical_trials.interventions: COMMIT
[0m13:47:47.979196 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:47:47.991608 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."interventions__dbt_backup"
[0m13:47:48.003173 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.interventions"
[0m13:47:48.004685 [debug] [Thread-1 (]: On model.clinical_trials.interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.interventions"} */
drop table if exists "clinical_trials"."silver"."interventions__dbt_backup" cascade
[0m13:47:48.011001 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m13:47:48.017229 [debug] [Thread-1 (]: On model.clinical_trials.interventions: Close
[0m13:47:48.021405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2fc3f2d-07e8-4bb9-99b6-7c9426b8392f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1705452420>]}
[0m13:47:48.023152 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.interventions ......................... [[32mSELECT 1928[0m in 0.27s]
[0m13:47:48.025312 [debug] [Thread-1 (]: Finished running node model.clinical_trials.interventions
[0m13:47:48.029706 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:48.030766 [debug] [MainThread]: On master: BEGIN
[0m13:47:48.031742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:47:48.042352 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m13:47:48.043884 [debug] [MainThread]: On master: COMMIT
[0m13:47:48.045072 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:48.045928 [debug] [MainThread]: On master: COMMIT
[0m13:47:48.046894 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:47:48.048109 [debug] [MainThread]: On master: Close
[0m13:47:48.049438 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:48.050524 [debug] [MainThread]: Connection 'model.clinical_trials.interventions' was properly closed.
[0m13:47:48.051441 [debug] [MainThread]: Connection 'list_clinical_trials_gold' was properly closed.
[0m13:47:48.052392 [info ] [MainThread]: 
[0m13:47:48.053580 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m13:47:48.056241 [debug] [MainThread]: Command end result
[0m13:47:48.115705 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:47:48.123791 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:47:48.143443 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:47:48.144922 [info ] [MainThread]: 
[0m13:47:48.146525 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:47:48.148192 [info ] [MainThread]: 
[0m13:47:48.150099 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:47:48.154228 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7063769, "process_in_blocks": "0", "process_kernel_time": 0.587753, "process_mem_max_rss": "109748", "process_out_blocks": "1600", "process_user_time": 3.009701}
[0m13:47:48.156750 [debug] [MainThread]: Command `dbt run` succeeded at 13:47:48.156377 after 1.71 seconds
[0m13:47:48.158234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1703472480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17041679b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f170027aab0>]}
[0m13:47:48.159660 [debug] [MainThread]: Flushing usage events
[0m13:47:48.642936 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:58.886699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae5031df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae654c890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae47b4bf0>]}


============================== 13:47:58.895821 | 0bdc752d-e4f5-41ab-bf6e-078b64af6980 ==============================
[0m13:47:58.895821 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:47:58.897212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select silver.processed_trials', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:47:59.141402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bdc752d-e4f5-41ab-bf6e-078b64af6980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae4587440>]}
[0m13:47:59.207157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bdc752d-e4f5-41ab-bf6e-078b64af6980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae6381520>]}
[0m13:47:59.208990 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:47:59.280827 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:47:59.506435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:47:59.507671 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:47:59.551873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bdc752d-e4f5-41ab-bf6e-078b64af6980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae2d1ad50>]}
[0m13:47:59.644284 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:47:59.651112 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:47:59.694140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bdc752d-e4f5-41ab-bf6e-078b64af6980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae2a3c6b0>]}
[0m13:47:59.695613 [info ] [MainThread]: Found 5 models, 1 source, 430 macros
[0m13:47:59.697341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bdc752d-e4f5-41ab-bf6e-078b64af6980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae45673e0>]}
[0m13:47:59.701847 [info ] [MainThread]: 
[0m13:47:59.704367 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:47:59.706737 [info ] [MainThread]: 
[0m13:47:59.708747 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:47:59.710960 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m13:47:59.776940 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m13:47:59.778385 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m13:47:59.779713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:59.791440 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.012 seconds
[0m13:47:59.794118 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m13:47:59.801214 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_silver)
[0m13:47:59.801937 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_gold'
[0m13:47:59.810635 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:47:59.813000 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:47:59.813835 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m13:47:59.814665 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m13:47:59.815473 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:59.816591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:59.824092 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:47:59.825325 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:47:59.825734 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:47:59.826584 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m13:47:59.827620 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:47:59.829045 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m13:47:59.833882 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m13:47:59.834963 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m13:47:59.838167 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m13:47:59.840810 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m13:47:59.842865 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m13:47:59.843909 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m13:47:59.854032 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:59.855594 [debug] [MainThread]: On master: BEGIN
[0m13:47:59.857099 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:47:59.863786 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:47:59.864991 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:59.866047 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:47:59.871180 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m13:47:59.873287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bdc752d-e4f5-41ab-bf6e-078b64af6980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae1be1790>]}
[0m13:47:59.874444 [debug] [MainThread]: On master: ROLLBACK
[0m13:47:59.875526 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:59.876314 [debug] [MainThread]: On master: BEGIN
[0m13:47:59.877577 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:47:59.878454 [debug] [MainThread]: On master: COMMIT
[0m13:47:59.879284 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:59.880081 [debug] [MainThread]: On master: COMMIT
[0m13:47:59.881040 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:47:59.881977 [debug] [MainThread]: On master: Close
[0m13:47:59.886577 [debug] [Thread-1 (]: Began running node model.clinical_trials.processed_trials
[0m13:47:59.888100 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.processed_trials ........................... [RUN]
[0m13:47:59.889532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_gold, now model.clinical_trials.processed_trials)
[0m13:47:59.890789 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.processed_trials
[0m13:47:59.900878 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.processed_trials"
[0m13:47:59.910170 [debug] [Thread-1 (]: Began executing node model.clinical_trials.processed_trials
[0m13:47:59.955754 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.processed_trials"
[0m13:47:59.964807 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m13:47:59.965927 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: BEGIN
[0m13:47:59.966825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:59.975020 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:47:59.976324 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m13:47:59.977554 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.processed_trials"} */

  
    

  create  table "clinical_trials"."silver"."processed_trials__dbt_tmp"
  
  
    as
  
  (
    

with src as (
  select
    nct_id,
    brief_title,
    study_type,
    case
      when coalesce(upper(study_type), '') = 'OBSERVATIONAL' then 'NOT APPLICABLE'
      when phase is null then null
      else upper(phase)
    end as phase,
    overall_status,
    start_date      as start_date_raw,
    completion_date as completion_date_raw
  from "clinical_trials"."bronze"."raw_trials"
),

-- 1) Homogenize placeholders -> NULL
nulls as (
  select
    nct_id,
    nullif(trim(brief_title),      '')              as brief_title,
    nullif(trim(study_type),       '')              as study_type,
    nullif(trim(phase),            '')              as phase,
    nullif(trim(overall_status),   '')              as status,
    nullif(trim(start_date_raw),       '')          as start_date_raw,
    nullif(trim(completion_date_raw),  '')          as completion_date_raw
  from src
),

-- Treat common placeholders (‘NA’, ‘N/A’, ‘UNKNOWN’, ‘NULL’ the *string*) as NULL
placeholders as (
  select
    nct_id,
    case when upper(brief_title)    in ('NA','N/A','UNKNOWN','NULL') then null else brief_title end    as brief_title,
    case when upper(study_type)     in ('NA','N/A','UNKNOWN','NULL') then null else study_type  end    as study_type,
    case when upper(phase)       in ('NA','N/A','UNKNOWN','NULL') then null else phase    end    as phase,
    case when upper(status)      in ('NA','N/A','UNKNOWN','NULL') then null else status   end    as status,
    case when upper(start_date_raw)     in ('NA','N/A','UNKNOWN','NULL') then null else start_date_raw  end    as start_date_raw,
    case when upper(completion_date_raw)in ('NA','N/A','UNKNOWN','NULL') then null else completion_date_raw end as completion_date_raw
  from nulls
),

-- 2) Parse partial dates (YYYY, YYYY-MM, YYYY-MM-DD) -> DATE
dates as (
  select
    nct_id,
    brief_title,
    study_type,
    status,
    phase,

    case
      when start_date_raw ~ '^\d{4}-\d{2}-\d{2}$' then to_date(start_date_raw,'YYYY-MM-DD')
      when start_date_raw ~ '^\d{4}-\d{2}$'       then to_date(start_date_raw||'-01','YYYY-MM-DD')
      when start_date_raw ~ '^\d{4}$'             then to_date(start_date_raw||'-01-01','YYYY-MM-DD')
      else null
    end as start_date,

    case
      when completion_date_raw ~ '^\d{4}-\d{2}-\d{2}$' then to_date(completion_date_raw,'YYYY-MM-DD')
      when completion_date_raw ~ '^\d{4}-\d{2}$'       then to_date(completion_date_raw||'-01','YYYY-MM-DD')
      when completion_date_raw ~ '^\d{4}$'             then to_date(completion_date_raw||'-01-01','YYYY-MM-DD')
      else null
    end as completion_date
  from placeholders
)

select 
    nct_id,
    brief_title,
    study_type,
    status,
    phase,
    start_date,
    completion_date
from dates
  );
  
[0m13:48:00.020484 [debug] [Thread-1 (]: SQL status: SELECT 1100 in 0.042 seconds
[0m13:48:00.031536 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m13:48:00.033595 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.processed_trials"} */
alter table "clinical_trials"."silver"."processed_trials" rename to "processed_trials__dbt_backup"
[0m13:48:00.035874 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:48:00.040015 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m13:48:00.041333 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.processed_trials"} */
alter table "clinical_trials"."silver"."processed_trials__dbt_tmp" rename to "processed_trials"
[0m13:48:00.042757 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:48:00.063932 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: COMMIT
[0m13:48:00.065537 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m13:48:00.066647 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: COMMIT
[0m13:48:00.069922 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:48:00.079139 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."processed_trials__dbt_backup"
[0m13:48:00.085250 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m13:48:00.086695 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.processed_trials"} */
drop table if exists "clinical_trials"."silver"."processed_trials__dbt_backup" cascade
[0m13:48:00.093731 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m13:48:00.097669 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: Close
[0m13:48:00.100893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bdc752d-e4f5-41ab-bf6e-078b64af6980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae64ce930>]}
[0m13:48:00.102500 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.processed_trials ...................... [[32mSELECT 1100[0m in 0.21s]
[0m13:48:00.104454 [debug] [Thread-1 (]: Finished running node model.clinical_trials.processed_trials
[0m13:48:00.108759 [debug] [MainThread]: Using postgres connection "master"
[0m13:48:00.110273 [debug] [MainThread]: On master: BEGIN
[0m13:48:00.111557 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:48:00.120000 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:48:00.121691 [debug] [MainThread]: On master: COMMIT
[0m13:48:00.123124 [debug] [MainThread]: Using postgres connection "master"
[0m13:48:00.124516 [debug] [MainThread]: On master: COMMIT
[0m13:48:00.125770 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:48:00.126725 [debug] [MainThread]: On master: Close
[0m13:48:00.128184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:48:00.129283 [debug] [MainThread]: Connection 'list_clinical_trials_silver' was properly closed.
[0m13:48:00.130172 [debug] [MainThread]: Connection 'model.clinical_trials.processed_trials' was properly closed.
[0m13:48:00.131178 [info ] [MainThread]: 
[0m13:48:00.132129 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m13:48:00.134389 [debug] [MainThread]: Command end result
[0m13:48:00.177670 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:48:00.185004 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:48:00.200134 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:48:00.201737 [info ] [MainThread]: 
[0m13:48:00.203583 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:48:00.205022 [info ] [MainThread]: 
[0m13:48:00.206569 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:48:00.208815 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3933983, "process_in_blocks": "0", "process_kernel_time": 0.32992, "process_mem_max_rss": "109964", "process_out_blocks": "1600", "process_user_time": 2.519394}
[0m13:48:00.210112 [debug] [MainThread]: Command `dbt run` succeeded at 13:48:00.209951 after 1.39 seconds
[0m13:48:00.211144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae48ea4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae2acd040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae2acdc70>]}
[0m13:48:00.212169 [debug] [MainThread]: Flushing usage events
[0m13:48:00.652053 [debug] [MainThread]: An error was encountered while trying to flush usage events
