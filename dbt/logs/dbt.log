[0m09:11:03.108441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fea15100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fe3f3fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fe3f0170>]}


============================== 09:11:03.118329 | dabdd6c0-7b2b-42d8-8e91-0b27129cee4d ==============================
[0m09:11:03.118329 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:11:03.120475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:11:03.191530 [info ] [MainThread]: dbt version: 1.9.0
[0m09:11:03.193137 [info ] [MainThread]: python version: 3.12.4
[0m09:11:03.194660 [info ] [MainThread]: python path: /usr/local/bin/python
[0m09:11:03.195811 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m09:11:03.197122 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m09:11:03.198244 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m09:11:03.200446 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m09:11:03.339139 [info ] [MainThread]: Configuration:
[0m09:11:03.340766 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m09:11:03.342577 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:11:03.344640 [info ] [MainThread]: Required dependencies:
[0m09:11:03.347001 [debug] [MainThread]: Executing "git --help"
[0m09:11:03.351090 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:11:03.352747 [debug] [MainThread]: STDERR: "b''"
[0m09:11:03.353981 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:11:03.355557 [info ] [MainThread]: Connection test skipped since no profile was found
[0m09:11:03.358065 [info ] [MainThread]: [31m1 check failed:[0m
[0m09:11:03.360154 [info ] [MainThread]: dbt looked for a profiles.yml file in /root/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m09:11:03.364287 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.3431103, "process_in_blocks": "0", "process_kernel_time": 0.375317, "process_mem_max_rss": "89260", "process_out_blocks": "1464", "process_user_time": 2.363483}
[0m09:11:03.366712 [debug] [MainThread]: Command `dbt debug` failed at 09:11:03.366462 after 0.35 seconds
[0m09:11:03.368283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fe431760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fe125070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fe127fb0>]}
[0m09:11:03.370106 [debug] [MainThread]: Flushing usage events
[0m09:11:03.889248 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:15:37.578151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57643c5820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5763e4f3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5765a38110>]}


============================== 09:15:37.587881 | ade45acd-fede-4776-b6bd-b0acdf34c41b ==============================
[0m09:15:37.587881 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:15:37.589785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:15:37.648124 [info ] [MainThread]: dbt version: 1.9.0
[0m09:15:37.649144 [info ] [MainThread]: python version: 3.12.4
[0m09:15:37.650536 [info ] [MainThread]: python path: /usr/local/bin/python
[0m09:15:37.652013 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m09:15:37.748028 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m09:15:37.749622 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m09:15:37.751371 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m09:15:37.753105 [info ] [MainThread]: adapter type: postgres
[0m09:15:37.754367 [info ] [MainThread]: adapter version: 1.9.0
[0m09:15:37.874333 [info ] [MainThread]: Configuration:
[0m09:15:37.876212 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:15:37.877858 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:15:37.879622 [info ] [MainThread]: Required dependencies:
[0m09:15:37.880953 [debug] [MainThread]: Executing "git --help"
[0m09:15:37.884353 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:15:37.885415 [debug] [MainThread]: STDERR: "b''"
[0m09:15:37.886747 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:15:37.888136 [info ] [MainThread]: Connection:
[0m09:15:37.889489 [info ] [MainThread]:   host: postgres
[0m09:15:37.890931 [info ] [MainThread]:   port: 5432
[0m09:15:37.892397 [info ] [MainThread]:   user: user
[0m09:15:37.893956 [info ] [MainThread]:   database: clinical_trials
[0m09:15:37.895840 [info ] [MainThread]:   schema: silver
[0m09:15:37.898106 [info ] [MainThread]:   connect_timeout: 10
[0m09:15:37.899649 [info ] [MainThread]:   role: None
[0m09:15:37.901156 [info ] [MainThread]:   search_path: None
[0m09:15:37.902760 [info ] [MainThread]:   keepalives_idle: 0
[0m09:15:37.903980 [info ] [MainThread]:   sslmode: None
[0m09:15:37.905254 [info ] [MainThread]:   sslcert: None
[0m09:15:37.906667 [info ] [MainThread]:   sslkey: None
[0m09:15:37.908166 [info ] [MainThread]:   sslrootcert: None
[0m09:15:37.910118 [info ] [MainThread]:   application_name: dbt
[0m09:15:37.911789 [info ] [MainThread]:   retries: 1
[0m09:15:37.913852 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:15:37.979550 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:15:38.025165 [debug] [MainThread]: Using postgres connection "debug"
[0m09:15:38.026743 [debug] [MainThread]: On debug: select 1 as id
[0m09:15:38.027939 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:15:38.078991 [debug] [MainThread]: SQL status: SELECT 1 in 0.051 seconds
[0m09:15:38.082327 [debug] [MainThread]: On debug: Close
[0m09:15:38.084040 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:15:38.085497 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:15:38.091253 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.5926748, "process_in_blocks": "0", "process_kernel_time": 0.434382, "process_mem_max_rss": "102188", "process_out_blocks": "1488", "process_user_time": 2.00018}
[0m09:15:38.092732 [debug] [MainThread]: Command `dbt debug` succeeded at 09:15:38.092572 after 0.59 seconds
[0m09:15:38.093872 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:15:38.095080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5764631790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5762205ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57621bd2e0>]}
[0m09:15:38.097110 [debug] [MainThread]: Flushing usage events
[0m09:15:38.628563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:16:17.034442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e6b7bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e5d2f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e67ca300>]}


============================== 09:16:17.045014 | b56314c5-a4f2-4b96-9972-340ba67780ac ==============================
[0m09:16:17.045014 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:16:17.047495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select silver.processed_trials', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:16:17.326243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b56314c5-a4f2-4b96-9972-340ba67780ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e6887aa0>]}
[0m09:16:17.397092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b56314c5-a4f2-4b96-9972-340ba67780ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e4a08c80>]}
[0m09:16:17.399103 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:16:17.484234 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:16:17.488353 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:16:17.489570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b56314c5-a4f2-4b96-9972-340ba67780ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e4922ba0>]}
[0m09:16:18.741511 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.clinical_trials.processed_trials' (models/silver/processed_trials.sql) depends on a source named 'sources.raw_trials' which was not found
[0m09:16:18.744913 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7995013, "process_in_blocks": "0", "process_kernel_time": 0.378957, "process_mem_max_rss": "100356", "process_out_blocks": "1488", "process_user_time": 3.181251}
[0m09:16:18.746815 [debug] [MainThread]: Command `dbt run` failed at 09:16:18.746445 after 1.80 seconds
[0m09:16:18.748135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e5318770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e5835010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88e2cad820>]}
[0m09:16:18.749457 [debug] [MainThread]: Flushing usage events
[0m09:16:19.186513 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:19:25.119529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4194557fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4194800440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f419499b530>]}


============================== 09:19:25.130776 | 932f8dd1-538f-4bdf-95fc-f72770228d33 ==============================
[0m09:19:25.130776 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:19:25.132205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select silver.processed_trials', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:19:25.397585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '932f8dd1-538f-4bdf-95fc-f72770228d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41926e4680>]}
[0m09:19:25.474751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '932f8dd1-538f-4bdf-95fc-f72770228d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41942a95e0>]}
[0m09:19:25.477093 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:19:25.549399 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:19:25.552999 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:19:25.554062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '932f8dd1-538f-4bdf-95fc-f72770228d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4193f9deb0>]}
[0m09:19:27.029125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '932f8dd1-538f-4bdf-95fc-f72770228d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f419246acf0>]}
[0m09:19:27.170070 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:19:27.181391 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:19:27.241778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '932f8dd1-538f-4bdf-95fc-f72770228d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4192771f40>]}
[0m09:19:27.243673 [info ] [MainThread]: Found 2 models, 1 source, 429 macros
[0m09:19:27.245517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '932f8dd1-538f-4bdf-95fc-f72770228d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4192469af0>]}
[0m09:19:27.248839 [info ] [MainThread]: 
[0m09:19:27.250505 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:19:27.252820 [info ] [MainThread]: 
[0m09:19:27.255685 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:19:27.261701 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m09:19:27.332060 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m09:19:27.333536 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m09:19:27.334884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:27.363682 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.029 seconds
[0m09:19:27.367390 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m09:19:27.369553 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now create_clinical_trials_silver_silver)
[0m09:19:27.371056 [debug] [ThreadPool]: Creating schema "database: "clinical_trials"
schema: "silver_silver"
"
[0m09:19:27.378209 [debug] [ThreadPool]: Using postgres connection "create_clinical_trials_silver_silver"
[0m09:19:27.381111 [debug] [ThreadPool]: On create_clinical_trials_silver_silver: BEGIN
[0m09:19:27.382788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:19:27.396952 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m09:19:27.398643 [debug] [ThreadPool]: Using postgres connection "create_clinical_trials_silver_silver"
[0m09:19:27.401186 [debug] [ThreadPool]: On create_clinical_trials_silver_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "create_clinical_trials_silver_silver"} */
create schema if not exists "silver_silver"
[0m09:19:27.414852 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.011 seconds
[0m09:19:27.417602 [debug] [ThreadPool]: On create_clinical_trials_silver_silver: COMMIT
[0m09:19:27.419122 [debug] [ThreadPool]: Using postgres connection "create_clinical_trials_silver_silver"
[0m09:19:27.420420 [debug] [ThreadPool]: On create_clinical_trials_silver_silver: COMMIT
[0m09:19:27.424428 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m09:19:27.426336 [debug] [ThreadPool]: On create_clinical_trials_silver_silver: Close
[0m09:19:27.430444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_clinical_trials_silver_silver, now list_clinical_trials_silver_silver)
[0m09:19:27.431737 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_silver_gold'
[0m09:19:27.441455 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver_silver"
[0m09:19:27.444447 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver_gold"
[0m09:19:27.445873 [debug] [ThreadPool]: On list_clinical_trials_silver_silver: BEGIN
[0m09:19:27.447048 [debug] [ThreadPool]: On list_clinical_trials_silver_gold: BEGIN
[0m09:19:27.448172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:19:27.449415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:27.459489 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m09:19:27.460575 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m09:19:27.461966 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver_silver"
[0m09:19:27.463135 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver_gold"
[0m09:19:27.464331 [debug] [ThreadPool]: On list_clinical_trials_silver_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_silver'
  
[0m09:19:27.465456 [debug] [ThreadPool]: On list_clinical_trials_silver_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_gold'
  
[0m09:19:27.493808 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.027 seconds
[0m09:19:27.494503 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.027 seconds
[0m09:19:27.496734 [debug] [ThreadPool]: On list_clinical_trials_silver_silver: ROLLBACK
[0m09:19:27.499281 [debug] [ThreadPool]: On list_clinical_trials_silver_gold: ROLLBACK
[0m09:19:27.500556 [debug] [ThreadPool]: On list_clinical_trials_silver_silver: Close
[0m09:19:27.501909 [debug] [ThreadPool]: On list_clinical_trials_silver_gold: Close
[0m09:19:27.509751 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:27.511107 [debug] [MainThread]: On master: BEGIN
[0m09:19:27.512190 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:19:27.521472 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:19:27.522888 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:27.524121 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:19:27.539862 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m09:19:27.542697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '932f8dd1-538f-4bdf-95fc-f72770228d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41924b1be0>]}
[0m09:19:27.544063 [debug] [MainThread]: On master: ROLLBACK
[0m09:19:27.545361 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:27.546277 [debug] [MainThread]: On master: BEGIN
[0m09:19:27.547585 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:19:27.548648 [debug] [MainThread]: On master: COMMIT
[0m09:19:27.549617 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:27.550549 [debug] [MainThread]: On master: COMMIT
[0m09:19:27.551668 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:19:27.552857 [debug] [MainThread]: On master: Close
[0m09:19:27.558094 [debug] [Thread-1 (]: Began running node model.clinical_trials.processed_trials
[0m09:19:27.559937 [info ] [Thread-1 (]: 1 of 1 START sql table model silver_silver.processed_trials .................... [RUN]
[0m09:19:27.561614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver_gold, now model.clinical_trials.processed_trials)
[0m09:19:27.563013 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.processed_trials
[0m09:19:27.576291 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.processed_trials"
[0m09:19:27.602163 [debug] [Thread-1 (]: Began executing node model.clinical_trials.processed_trials
[0m09:19:27.660604 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.processed_trials"
[0m09:19:27.683765 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:19:27.685261 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: BEGIN
[0m09:19:27.687003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:19:27.696234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m09:19:27.698301 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:19:27.699595 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.processed_trials"} */

  
    

  create  table "clinical_trials"."silver_silver"."processed_trials__dbt_tmp"
  
  
    as
  
  (
    

with src as (
  select
    nct_id,
    brief_title,
    study_type,
    phase,
    overall_status,
    start_date      as start_date_raw,
    completion_date as completion_date_raw,
    conditions,
    interventions,
    countries
  from "clinical_trials"."bronze"."raw_trials"
),

clean as (
  select
    nct_id,
    nullif(nullif(nullif(brief_title,''),'NA'),'UNKNOWN')       as brief_title,
    nullif(nullif(nullif(study_type,''),'NA'),'UNKNOWN')        as study_type,
    nullif(nullif(nullif(phase,''),'NA'),'NULL')                as phase_raw,
    nullif(nullif(nullif(overall_status,''),'NA'),'UNKNOWN')    as status_raw,

    case
      when start_date_raw ~ '^\d{4}-\d{2}-\d{2}$' then to_date(start_date_raw,'YYYY-MM-DD')
      when start_date_raw ~ '^\d{4}-\d{2}$'       then to_date(start_date_raw||'-01','YYYY-MM-DD')
      when start_date_raw ~ '^\d{4}$'             then to_date(start_date_raw||'-01-01','YYYY-MM-DD')
      else null
    end as start_date,

    case
      when completion_date_raw ~ '^\d{4}-\d{2}-\d{2}$' then to_date(completion_date_raw,'YYYY-MM-DD')
      when completion_date_raw ~ '^\d{4}-\d{2}$'       then to_date(completion_date_raw||'-01','YYYY-MM-DD')
      when completion_date_raw ~ '^\d{4}$'             then to_date(completion_date_raw||'-01-01','YYYY-MM-DD')
      else null
    end as completion_date,

    conditions,
    interventions,
    countries
  from src
)

select * from clean;
  );
  
[0m09:19:27.703495 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 57: select * from clean;
                            ^

[0m09:19:27.705197 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: ROLLBACK
[0m09:19:27.706879 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: Close
[0m09:19:27.712469 [debug] [Thread-1 (]: Database Error in model processed_trials (models/silver/processed_trials.sql)
  syntax error at or near ";"
  LINE 57: select * from clean;
                              ^
  compiled code at target/run/clinical_trials/models/silver/processed_trials.sql
[0m09:19:27.715148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '932f8dd1-538f-4bdf-95fc-f72770228d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41922e0440>]}
[0m09:19:27.716696 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model silver_silver.processed_trials ........... [[31mERROR[0m in 0.15s]
[0m09:19:27.718535 [debug] [Thread-1 (]: Finished running node model.clinical_trials.processed_trials
[0m09:19:27.720698 [debug] [Thread-7 (]: Marking all children of 'model.clinical_trials.processed_trials' to be skipped because of status 'error'.  Reason: Database Error in model processed_trials (models/silver/processed_trials.sql)
  syntax error at or near ";"
  LINE 57: select * from clean;
                              ^
  compiled code at target/run/clinical_trials/models/silver/processed_trials.sql.
[0m09:19:27.724717 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:27.726222 [debug] [MainThread]: On master: BEGIN
[0m09:19:27.727510 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:19:27.734599 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:19:27.736307 [debug] [MainThread]: On master: COMMIT
[0m09:19:27.737713 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:27.738695 [debug] [MainThread]: On master: COMMIT
[0m09:19:27.740012 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:19:27.741168 [debug] [MainThread]: On master: Close
[0m09:19:27.743243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:19:27.745320 [debug] [MainThread]: Connection 'list_clinical_trials_silver_silver' was properly closed.
[0m09:19:27.747198 [debug] [MainThread]: Connection 'model.clinical_trials.processed_trials' was properly closed.
[0m09:19:27.748824 [info ] [MainThread]: 
[0m09:19:27.750353 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m09:19:27.753200 [debug] [MainThread]: Command end result
[0m09:19:27.881243 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:19:27.892272 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:19:27.905134 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:19:27.906802 [info ] [MainThread]: 
[0m09:19:27.908712 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:19:27.910815 [info ] [MainThread]: 
[0m09:19:27.912628 [error] [MainThread]:   Database Error in model processed_trials (models/silver/processed_trials.sql)
  syntax error at or near ";"
  LINE 57: select * from clean;
                              ^
  compiled code at target/run/clinical_trials/models/silver/processed_trials.sql
[0m09:19:27.914090 [info ] [MainThread]: 
[0m09:19:27.916235 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:19:27.918958 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.8724365, "process_in_blocks": "0", "process_kernel_time": 0.30836, "process_mem_max_rss": "112848", "process_out_blocks": "1600", "process_user_time": 4.008683}
[0m09:19:27.920628 [debug] [MainThread]: Command `dbt run` failed at 09:19:27.920458 after 2.87 seconds
[0m09:19:27.921933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4194c67320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41941ec560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f419064d820>]}
[0m09:19:27.923309 [debug] [MainThread]: Flushing usage events
[0m09:19:28.421764 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:19:38.948650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e67165c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e65ce33b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e654e3980>]}


============================== 09:19:38.958756 | a5ee9bb2-2530-4128-b7df-05d239dbcc6d ==============================
[0m09:19:38.958756 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:19:38.960504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select silver.processed_trials', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:19:39.275089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5ee9bb2-2530-4128-b7df-05d239dbcc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e639d43b0>]}
[0m09:19:39.378321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5ee9bb2-2530-4128-b7df-05d239dbcc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e65db0140>]}
[0m09:19:39.380768 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:19:39.515854 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:19:39.862388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:19:39.865249 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/silver/processed_trials.sql
[0m09:19:40.346888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5ee9bb2-2530-4128-b7df-05d239dbcc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e63777c50>]}
[0m09:19:40.489274 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:19:40.499712 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:19:40.553404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5ee9bb2-2530-4128-b7df-05d239dbcc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e65a93a40>]}
[0m09:19:40.555324 [info ] [MainThread]: Found 2 models, 1 source, 429 macros
[0m09:19:40.557316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5ee9bb2-2530-4128-b7df-05d239dbcc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e6374cdd0>]}
[0m09:19:40.560941 [info ] [MainThread]: 
[0m09:19:40.562789 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:19:40.565100 [info ] [MainThread]: 
[0m09:19:40.567265 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:19:40.570234 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m09:19:40.647240 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m09:19:40.649064 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m09:19:40.650399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:40.661218 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m09:19:40.664769 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m09:19:40.668137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_silver_gold)
[0m09:19:40.669512 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_silver_silver'
[0m09:19:40.680333 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver_gold"
[0m09:19:40.684568 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver_silver"
[0m09:19:40.686666 [debug] [ThreadPool]: On list_clinical_trials_silver_gold: BEGIN
[0m09:19:40.688166 [debug] [ThreadPool]: On list_clinical_trials_silver_silver: BEGIN
[0m09:19:40.689592 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:19:40.690863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:40.699263 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m09:19:40.700937 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver_gold"
[0m09:19:40.701633 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m09:19:40.702815 [debug] [ThreadPool]: On list_clinical_trials_silver_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_gold'
  
[0m09:19:40.703986 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver_silver"
[0m09:19:40.706018 [debug] [ThreadPool]: On list_clinical_trials_silver_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_silver'
  
[0m09:19:40.708016 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m09:19:40.710497 [debug] [ThreadPool]: On list_clinical_trials_silver_gold: ROLLBACK
[0m09:19:40.712044 [debug] [ThreadPool]: On list_clinical_trials_silver_gold: Close
[0m09:19:40.712669 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m09:19:40.715716 [debug] [ThreadPool]: On list_clinical_trials_silver_silver: ROLLBACK
[0m09:19:40.718969 [debug] [ThreadPool]: On list_clinical_trials_silver_silver: Close
[0m09:19:40.730506 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:40.732213 [debug] [MainThread]: On master: BEGIN
[0m09:19:40.733477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:19:40.742769 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:19:40.744308 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:40.745692 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:19:40.751045 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m09:19:40.754205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5ee9bb2-2530-4128-b7df-05d239dbcc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e636a1e80>]}
[0m09:19:40.755973 [debug] [MainThread]: On master: ROLLBACK
[0m09:19:40.757984 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:40.759290 [debug] [MainThread]: On master: BEGIN
[0m09:19:40.761088 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:19:40.762250 [debug] [MainThread]: On master: COMMIT
[0m09:19:40.763357 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:40.764287 [debug] [MainThread]: On master: COMMIT
[0m09:19:40.765386 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:19:40.766246 [debug] [MainThread]: On master: Close
[0m09:19:40.773536 [debug] [Thread-1 (]: Began running node model.clinical_trials.processed_trials
[0m09:19:40.775543 [info ] [Thread-1 (]: 1 of 1 START sql table model silver_silver.processed_trials .................... [RUN]
[0m09:19:40.777253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver_silver, now model.clinical_trials.processed_trials)
[0m09:19:40.778757 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.processed_trials
[0m09:19:40.789660 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.processed_trials"
[0m09:19:40.800163 [debug] [Thread-1 (]: Began executing node model.clinical_trials.processed_trials
[0m09:19:40.879704 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.processed_trials"
[0m09:19:40.892050 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:19:40.893978 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: BEGIN
[0m09:19:40.895570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:19:40.905025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m09:19:40.907124 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:19:40.908775 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.processed_trials"} */

  
    

  create  table "clinical_trials"."silver_silver"."processed_trials__dbt_tmp"
  
  
    as
  
  (
    

with src as (
  select
    nct_id,
    brief_title,
    study_type,
    phase,
    overall_status,
    start_date      as start_date_raw,
    completion_date as completion_date_raw,
    conditions,
    interventions,
    countries
  from "clinical_trials"."bronze"."raw_trials"
),

clean as (
  select
    nct_id,
    nullif(nullif(nullif(brief_title,''),'NA'),'UNKNOWN')       as brief_title,
    nullif(nullif(nullif(study_type,''),'NA'),'UNKNOWN')        as study_type,
    nullif(nullif(nullif(phase,''),'NA'),'NULL')                as phase_raw,
    nullif(nullif(nullif(overall_status,''),'NA'),'UNKNOWN')    as status_raw,

    case
      when start_date_raw ~ '^\d{4}-\d{2}-\d{2}$' then to_date(start_date_raw,'YYYY-MM-DD')
      when start_date_raw ~ '^\d{4}-\d{2}$'       then to_date(start_date_raw||'-01','YYYY-MM-DD')
      when start_date_raw ~ '^\d{4}$'             then to_date(start_date_raw||'-01-01','YYYY-MM-DD')
      else null
    end as start_date,

    case
      when completion_date_raw ~ '^\d{4}-\d{2}-\d{2}$' then to_date(completion_date_raw,'YYYY-MM-DD')
      when completion_date_raw ~ '^\d{4}-\d{2}$'       then to_date(completion_date_raw||'-01','YYYY-MM-DD')
      when completion_date_raw ~ '^\d{4}$'             then to_date(completion_date_raw||'-01-01','YYYY-MM-DD')
      else null
    end as completion_date,

    conditions,
    interventions,
    countries
  from src
)

select * from clean
  );
  
[0m09:19:40.972145 [debug] [Thread-1 (]: SQL status: SELECT 1100 in 0.062 seconds
[0m09:19:40.984152 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:19:40.986062 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.processed_trials"} */
alter table "clinical_trials"."silver_silver"."processed_trials__dbt_tmp" rename to "processed_trials"
[0m09:19:40.989359 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:19:41.021439 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: COMMIT
[0m09:19:41.023772 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:19:41.025511 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: COMMIT
[0m09:19:41.031756 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m09:19:41.040776 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver_silver"."processed_trials__dbt_backup"
[0m09:19:41.051345 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:19:41.053183 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.processed_trials"} */
drop table if exists "clinical_trials"."silver_silver"."processed_trials__dbt_backup" cascade
[0m09:19:41.056958 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m09:19:41.061914 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: Close
[0m09:19:41.064883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5ee9bb2-2530-4128-b7df-05d239dbcc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e6721a5a0>]}
[0m09:19:41.066298 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver_silver.processed_trials ............... [[32mSELECT 1100[0m in 0.29s]
[0m09:19:41.068419 [debug] [Thread-1 (]: Finished running node model.clinical_trials.processed_trials
[0m09:19:41.072170 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:41.073457 [debug] [MainThread]: On master: BEGIN
[0m09:19:41.074508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:19:41.083432 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:19:41.084698 [debug] [MainThread]: On master: COMMIT
[0m09:19:41.086040 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:41.087894 [debug] [MainThread]: On master: COMMIT
[0m09:19:41.090685 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:19:41.092413 [debug] [MainThread]: On master: Close
[0m09:19:41.094235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:19:41.095663 [debug] [MainThread]: Connection 'list_clinical_trials_silver_gold' was properly closed.
[0m09:19:41.096791 [debug] [MainThread]: Connection 'model.clinical_trials.processed_trials' was properly closed.
[0m09:19:41.097714 [info ] [MainThread]: 
[0m09:19:41.098816 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m09:19:41.100942 [debug] [MainThread]: Command end result
[0m09:19:41.141965 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:19:41.149076 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:19:41.161450 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:19:41.162496 [info ] [MainThread]: 
[0m09:19:41.163726 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:19:41.165324 [info ] [MainThread]: 
[0m09:19:41.166792 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:19:41.169759 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2966177, "process_in_blocks": "0", "process_kernel_time": 0.391651, "process_mem_max_rss": "113248", "process_out_blocks": "1600", "process_user_time": 3.414398}
[0m09:19:41.171454 [debug] [MainThread]: Command `dbt run` succeeded at 09:19:41.171247 after 2.30 seconds
[0m09:19:41.172580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e636bff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e65f2ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e65e0b1a0>]}
[0m09:19:41.173682 [debug] [MainThread]: Flushing usage events
[0m09:19:41.625257 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:28:02.848263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af3a0d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af3744b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af3a0c710>]}


============================== 09:28:02.859008 | 65a8b7c6-e923-4e00-bb86-235902100f8b ==============================
[0m09:28:02.859008 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:28:02.860683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select silver.processed_trials', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:28:03.083314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65a8b7c6-e923-4e00-bb86-235902100f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af2d4b920>]}
[0m09:28:03.144383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65a8b7c6-e923-4e00-bb86-235902100f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af14950d0>]}
[0m09:28:03.146040 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:28:03.216305 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:28:03.430048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:28:03.431415 [debug] [MainThread]: Partial parsing: added file: clinical_trials://macros/genrate_schema_name.sql
[0m09:28:03.434425 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m09:28:04.465593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65a8b7c6-e923-4e00-bb86-235902100f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af126bf50>]}
[0m09:28:04.548167 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:28:04.554956 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:28:04.593914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65a8b7c6-e923-4e00-bb86-235902100f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af11e3920>]}
[0m09:28:04.595610 [info ] [MainThread]: Found 2 models, 1 source, 430 macros
[0m09:28:04.596969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65a8b7c6-e923-4e00-bb86-235902100f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af1242090>]}
[0m09:28:04.599527 [info ] [MainThread]: 
[0m09:28:04.601111 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:28:04.602459 [info ] [MainThread]: 
[0m09:28:04.604552 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:28:04.607587 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m09:28:04.652201 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m09:28:04.653829 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m09:28:04.655144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:04.665362 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m09:28:04.667659 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m09:28:04.669972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_gold)
[0m09:28:04.670977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_silver'
[0m09:28:04.679356 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m09:28:04.739507 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m09:28:04.740424 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m09:28:04.741227 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m09:28:04.742498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:04.743754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:04.750827 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m09:28:04.751571 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m09:28:04.752496 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m09:28:04.753667 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m09:28:04.754705 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m09:28:04.755667 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m09:28:04.759307 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m09:28:04.760270 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m09:28:04.762242 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m09:28:04.764648 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m09:28:04.765734 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m09:28:04.766698 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m09:28:04.774890 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:04.776289 [debug] [MainThread]: On master: BEGIN
[0m09:28:04.777133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:28:04.784524 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:28:04.785868 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:04.786805 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:28:04.791362 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m09:28:04.793451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65a8b7c6-e923-4e00-bb86-235902100f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af11ac2c0>]}
[0m09:28:04.794529 [debug] [MainThread]: On master: ROLLBACK
[0m09:28:04.795568 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:04.796404 [debug] [MainThread]: On master: BEGIN
[0m09:28:04.797555 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:28:04.798436 [debug] [MainThread]: On master: COMMIT
[0m09:28:04.799263 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:04.800345 [debug] [MainThread]: On master: COMMIT
[0m09:28:04.801398 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:28:04.802118 [debug] [MainThread]: On master: Close
[0m09:28:04.807333 [debug] [Thread-1 (]: Began running node model.clinical_trials.processed_trials
[0m09:28:04.808642 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.processed_trials ........................... [RUN]
[0m09:28:04.809896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver, now model.clinical_trials.processed_trials)
[0m09:28:04.811129 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.processed_trials
[0m09:28:04.819676 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.processed_trials"
[0m09:28:04.827454 [debug] [Thread-1 (]: Began executing node model.clinical_trials.processed_trials
[0m09:28:04.872197 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.processed_trials"
[0m09:28:04.881393 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:28:04.882416 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: BEGIN
[0m09:28:04.883216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:04.890410 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:28:04.891936 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:28:04.892937 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.processed_trials"} */

  
    

  create  table "clinical_trials"."silver"."processed_trials__dbt_tmp"
  
  
    as
  
  (
    

with src as (
  select
    nct_id,
    brief_title,
    study_type,
    phase,
    overall_status,
    start_date      as start_date_raw,
    completion_date as completion_date_raw,
    conditions,
    interventions,
    countries
  from "clinical_trials"."bronze"."raw_trials"
),

clean as (
  select
    nct_id,
    nullif(nullif(nullif(brief_title,''),'NA'),'UNKNOWN')       as brief_title,
    nullif(nullif(nullif(study_type,''),'NA'),'UNKNOWN')        as study_type,
    nullif(nullif(nullif(phase,''),'NA'),'NULL')                as phase_raw,
    nullif(nullif(nullif(overall_status,''),'NA'),'UNKNOWN')    as status_raw,

    case
      when start_date_raw ~ '^\d{4}-\d{2}-\d{2}$' then to_date(start_date_raw,'YYYY-MM-DD')
      when start_date_raw ~ '^\d{4}-\d{2}$'       then to_date(start_date_raw||'-01','YYYY-MM-DD')
      when start_date_raw ~ '^\d{4}$'             then to_date(start_date_raw||'-01-01','YYYY-MM-DD')
      else null
    end as start_date,

    case
      when completion_date_raw ~ '^\d{4}-\d{2}-\d{2}$' then to_date(completion_date_raw,'YYYY-MM-DD')
      when completion_date_raw ~ '^\d{4}-\d{2}$'       then to_date(completion_date_raw||'-01','YYYY-MM-DD')
      when completion_date_raw ~ '^\d{4}$'             then to_date(completion_date_raw||'-01-01','YYYY-MM-DD')
      else null
    end as completion_date,

    conditions,
    interventions,
    countries
  from src
)

select * from clean
  );
  
[0m09:28:04.925005 [debug] [Thread-1 (]: SQL status: SELECT 1100 in 0.031 seconds
[0m09:28:04.932558 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:28:04.933898 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.processed_trials"} */
alter table "clinical_trials"."silver"."processed_trials__dbt_tmp" rename to "processed_trials"
[0m09:28:04.935476 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:28:04.953778 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: COMMIT
[0m09:28:04.954810 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:28:04.955617 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: COMMIT
[0m09:28:04.959532 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m09:28:04.966945 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."processed_trials__dbt_backup"
[0m09:28:04.972754 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m09:28:04.973661 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.processed_trials"} */
drop table if exists "clinical_trials"."silver"."processed_trials__dbt_backup" cascade
[0m09:28:04.975362 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m09:28:04.979682 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: Close
[0m09:28:04.982884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65a8b7c6-e923-4e00-bb86-235902100f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af4cce840>]}
[0m09:28:04.984949 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.processed_trials ...................... [[32mSELECT 1100[0m in 0.17s]
[0m09:28:04.987215 [debug] [Thread-1 (]: Finished running node model.clinical_trials.processed_trials
[0m09:28:04.990545 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:04.991647 [debug] [MainThread]: On master: BEGIN
[0m09:28:04.992497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:28:04.998294 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m09:28:04.999331 [debug] [MainThread]: On master: COMMIT
[0m09:28:05.000163 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:05.000908 [debug] [MainThread]: On master: COMMIT
[0m09:28:05.002051 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:28:05.003577 [debug] [MainThread]: On master: Close
[0m09:28:05.004972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:28:05.006367 [debug] [MainThread]: Connection 'list_clinical_trials_gold' was properly closed.
[0m09:28:05.007543 [debug] [MainThread]: Connection 'model.clinical_trials.processed_trials' was properly closed.
[0m09:28:05.008779 [info ] [MainThread]: 
[0m09:28:05.010493 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m09:28:05.012690 [debug] [MainThread]: Command end result
[0m09:28:05.052309 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:28:05.059188 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:28:05.069368 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:28:05.070745 [info ] [MainThread]: 
[0m09:28:05.072266 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:28:05.073582 [info ] [MainThread]: 
[0m09:28:05.075431 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:28:05.077818 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2964773, "process_in_blocks": "0", "process_kernel_time": 0.384844, "process_mem_max_rss": "116904", "process_out_blocks": "1600", "process_user_time": 3.423092}
[0m09:28:05.079860 [debug] [MainThread]: Command `dbt run` succeeded at 09:28:05.079533 after 2.30 seconds
[0m09:28:05.081564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af2fd86b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af120df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af4d4c560>]}
[0m09:28:05.082779 [debug] [MainThread]: Flushing usage events
[0m09:28:05.637923 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:19:24.562715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d969f6420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d96573080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d966d2900>]}


============================== 13:19:24.580976 | 1389a39b-10cf-41df-a094-c05bbea617f3 ==============================
[0m13:19:24.580976 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:19:24.583348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select silver.countries', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:19:24.950735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1389a39b-10cf-41df-a094-c05bbea617f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d962d3440>]}
[0m13:19:25.038199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1389a39b-10cf-41df-a094-c05bbea617f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d96a5f560>]}
[0m13:19:25.040627 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:19:25.136444 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:19:25.462624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m13:19:25.464083 [debug] [MainThread]: Partial parsing: added file: clinical_trials://models/silver/conditions.sql
[0m13:19:25.465148 [debug] [MainThread]: Partial parsing: added file: clinical_trials://models/silver/countries.sql
[0m13:19:25.466089 [debug] [MainThread]: Partial parsing: added file: clinical_trials://models/silver/interventions.sql
[0m13:19:25.467128 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/silver/processed_trials.sql
[0m13:19:25.817394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1389a39b-10cf-41df-a094-c05bbea617f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d94a851c0>]}
[0m13:19:25.922729 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:19:25.933638 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:19:25.989540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1389a39b-10cf-41df-a094-c05bbea617f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d946b5040>]}
[0m13:19:25.991707 [info ] [MainThread]: Found 5 models, 1 source, 430 macros
[0m13:19:25.994528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1389a39b-10cf-41df-a094-c05bbea617f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d946c0560>]}
[0m13:19:26.000091 [info ] [MainThread]: 
[0m13:19:26.003154 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:19:26.005542 [info ] [MainThread]: 
[0m13:19:26.010241 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:19:26.013591 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m13:19:26.101254 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m13:19:26.102725 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m13:19:26.103772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:26.152930 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.049 seconds
[0m13:19:26.156420 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m13:19:26.165960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_gold)
[0m13:19:26.167326 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_silver'
[0m13:19:26.176652 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:19:26.180218 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:19:26.181817 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m13:19:26.183803 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m13:19:26.185097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:26.186382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:26.196904 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m13:19:26.198671 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m13:19:26.200297 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:19:26.202015 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:19:26.203522 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m13:19:26.205088 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m13:19:26.219637 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m13:19:26.220269 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m13:19:26.223399 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m13:19:26.226509 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m13:19:26.229087 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m13:19:26.230894 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m13:19:26.245202 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:26.247524 [debug] [MainThread]: On master: BEGIN
[0m13:19:26.248850 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:19:26.258668 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:19:26.260953 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:26.262550 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:19:26.273713 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m13:19:26.276769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1389a39b-10cf-41df-a094-c05bbea617f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d968158e0>]}
[0m13:19:26.278851 [debug] [MainThread]: On master: ROLLBACK
[0m13:19:26.281168 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:26.282447 [debug] [MainThread]: On master: BEGIN
[0m13:19:26.284157 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:19:26.285321 [debug] [MainThread]: On master: COMMIT
[0m13:19:26.286220 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:26.287081 [debug] [MainThread]: On master: COMMIT
[0m13:19:26.288305 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:19:26.289206 [debug] [MainThread]: On master: Close
[0m13:19:26.297196 [debug] [Thread-1 (]: Began running node model.clinical_trials.countries
[0m13:19:26.298979 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.countries .................................. [RUN]
[0m13:19:26.300503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_gold, now model.clinical_trials.countries)
[0m13:19:26.301959 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.countries
[0m13:19:26.314747 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.countries"
[0m13:19:26.326715 [debug] [Thread-1 (]: Began executing node model.clinical_trials.countries
[0m13:19:26.382130 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.countries"
[0m13:19:26.394731 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:19:26.396482 [debug] [Thread-1 (]: On model.clinical_trials.countries: BEGIN
[0m13:19:26.397811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:26.409740 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m13:19:26.411838 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:19:26.413455 [debug] [Thread-1 (]: On model.clinical_trials.countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.countries"} */

  
    

  create  table "clinical_trials"."silver"."countries__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  p.nct_id,
  nullif(trim(x), '') as country
from "clinical_trials"."silver"."processed_trials" p,
lateral regexp_split_to_table(p.countries, '\s*;\s*') as x
where p.countries is not null and p.countries <> ''
  and nullif(trim(x), '') is not null
  );
  
[0m13:19:26.863737 [debug] [Thread-1 (]: SQL status: SELECT 1557 in 0.449 seconds
[0m13:19:26.872311 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:19:26.873448 [debug] [Thread-1 (]: On model.clinical_trials.countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.countries"} */
alter table "clinical_trials"."silver"."countries__dbt_tmp" rename to "countries"
[0m13:19:26.878896 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:19:26.901460 [debug] [Thread-1 (]: On model.clinical_trials.countries: COMMIT
[0m13:19:26.903191 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:19:26.904549 [debug] [Thread-1 (]: On model.clinical_trials.countries: COMMIT
[0m13:19:26.910691 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:19:26.919399 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."countries__dbt_backup"
[0m13:19:26.926721 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:19:26.928418 [debug] [Thread-1 (]: On model.clinical_trials.countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.countries"} */
drop table if exists "clinical_trials"."silver"."countries__dbt_backup" cascade
[0m13:19:26.930250 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:19:26.933808 [debug] [Thread-1 (]: On model.clinical_trials.countries: Close
[0m13:19:26.937899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1389a39b-10cf-41df-a094-c05bbea617f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d9821e570>]}
[0m13:19:26.939732 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.countries ............................. [[32mSELECT 1557[0m in 0.64s]
[0m13:19:26.942219 [debug] [Thread-1 (]: Finished running node model.clinical_trials.countries
[0m13:19:26.947245 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:26.948799 [debug] [MainThread]: On master: BEGIN
[0m13:19:26.949916 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:19:26.957896 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:19:26.959947 [debug] [MainThread]: On master: COMMIT
[0m13:19:26.961611 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:26.963082 [debug] [MainThread]: On master: COMMIT
[0m13:19:26.964634 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:19:26.965798 [debug] [MainThread]: On master: Close
[0m13:19:26.967108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:26.968221 [debug] [MainThread]: Connection 'model.clinical_trials.countries' was properly closed.
[0m13:19:26.969251 [debug] [MainThread]: Connection 'list_clinical_trials_silver' was properly closed.
[0m13:19:26.970410 [info ] [MainThread]: 
[0m13:19:26.971657 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m13:19:26.973862 [debug] [MainThread]: Command end result
[0m13:19:27.029460 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:19:27.037116 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:19:27.051242 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:19:27.053031 [info ] [MainThread]: 
[0m13:19:27.055084 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:19:27.056856 [info ] [MainThread]: 
[0m13:19:27.058756 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:19:27.062811 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6592526, "process_in_blocks": "0", "process_kernel_time": 0.964312, "process_mem_max_rss": "113060", "process_out_blocks": "1600", "process_user_time": 3.230942}
[0m13:19:27.065153 [debug] [MainThread]: Command `dbt run` succeeded at 13:19:27.064790 after 2.66 seconds
[0m13:19:27.066922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d96e07c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d998f38c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d968cfcb0>]}
[0m13:19:27.068335 [debug] [MainThread]: Flushing usage events
[0m13:19:27.644861 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:28:08.478629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44927393a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4491c81790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4491f774a0>]}


============================== 13:28:08.488003 | 4ccef057-e3ee-4f08-a05f-5832aa45de92 ==============================
[0m13:28:08.488003 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:28:08.489832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select silver.countries', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:28:08.751816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ccef057-e3ee-4f08-a05f-5832aa45de92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44919bcc20>]}
[0m13:28:08.825875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ccef057-e3ee-4f08-a05f-5832aa45de92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44933fb0e0>]}
[0m13:28:08.827858 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:28:08.899618 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:28:09.195585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:28:09.197350 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/silver/countries.sql
[0m13:28:09.499589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ccef057-e3ee-4f08-a05f-5832aa45de92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f448fdea510>]}
[0m13:28:09.588587 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:28:09.595096 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:28:09.633695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ccef057-e3ee-4f08-a05f-5832aa45de92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f448fde2db0>]}
[0m13:28:09.635435 [info ] [MainThread]: Found 5 models, 1 source, 430 macros
[0m13:28:09.637296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ccef057-e3ee-4f08-a05f-5832aa45de92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f448ffb7590>]}
[0m13:28:09.641132 [info ] [MainThread]: 
[0m13:28:09.643948 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:28:09.645948 [info ] [MainThread]: 
[0m13:28:09.648460 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:28:09.651023 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m13:28:09.722626 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m13:28:09.723818 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m13:28:09.725207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:09.737423 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.012 seconds
[0m13:28:09.740108 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m13:28:09.747037 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_silver)
[0m13:28:09.747976 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_gold'
[0m13:28:09.754791 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:28:09.757698 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:28:09.758830 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m13:28:09.759775 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m13:28:09.760635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:09.761416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:09.769895 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:28:09.771127 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:28:09.771781 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:28:09.772978 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:28:09.774407 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m13:28:09.775471 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m13:28:09.779355 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:28:09.779883 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m13:28:09.781763 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m13:28:09.783633 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m13:28:09.784844 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m13:28:09.785667 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m13:28:09.793342 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:09.794475 [debug] [MainThread]: On master: BEGIN
[0m13:28:09.795432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:28:09.803391 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:28:09.804506 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:09.805559 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:28:09.810429 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m13:28:09.812806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ccef057-e3ee-4f08-a05f-5832aa45de92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f448d3b34a0>]}
[0m13:28:09.813983 [debug] [MainThread]: On master: ROLLBACK
[0m13:28:09.815075 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:09.815971 [debug] [MainThread]: On master: BEGIN
[0m13:28:09.817255 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:28:09.818236 [debug] [MainThread]: On master: COMMIT
[0m13:28:09.819229 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:09.820103 [debug] [MainThread]: On master: COMMIT
[0m13:28:09.821123 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:28:09.821872 [debug] [MainThread]: On master: Close
[0m13:28:09.827338 [debug] [Thread-1 (]: Began running node model.clinical_trials.countries
[0m13:28:09.828801 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.countries .................................. [RUN]
[0m13:28:09.830217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver, now model.clinical_trials.countries)
[0m13:28:09.831311 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.countries
[0m13:28:09.839304 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.countries"
[0m13:28:09.847684 [debug] [Thread-1 (]: Began executing node model.clinical_trials.countries
[0m13:28:09.895849 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.countries"
[0m13:28:09.904448 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:28:09.905564 [debug] [Thread-1 (]: On model.clinical_trials.countries: BEGIN
[0m13:28:09.906716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:09.915819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m13:28:09.917219 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:28:09.918351 [debug] [Thread-1 (]: On model.clinical_trials.countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.countries"} */

  
    

  create  table "clinical_trials"."silver"."countries__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  p.nct_id,
  nullif(trim(x), '') as country
from "clinical_trials"."bronze"."raw_trials" p,
lateral regexp_split_to_table(p.countries, '\s*;\s*') as x
where p.countries is not null and p.countries <> ''
  and nullif(trim(x), '') is not null
  );
  
[0m13:28:09.995234 [debug] [Thread-1 (]: SQL status: SELECT 1557 in 0.076 seconds
[0m13:28:10.002773 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:28:10.003767 [debug] [Thread-1 (]: On model.clinical_trials.countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.countries"} */
alter table "clinical_trials"."silver"."countries" rename to "countries__dbt_backup"
[0m13:28:10.004975 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:28:10.008224 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:28:10.009405 [debug] [Thread-1 (]: On model.clinical_trials.countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.countries"} */
alter table "clinical_trials"."silver"."countries__dbt_tmp" rename to "countries"
[0m13:28:10.010985 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:28:10.035577 [debug] [Thread-1 (]: On model.clinical_trials.countries: COMMIT
[0m13:28:10.036836 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:28:10.037855 [debug] [Thread-1 (]: On model.clinical_trials.countries: COMMIT
[0m13:28:10.041627 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:28:10.049523 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."countries__dbt_backup"
[0m13:28:10.055524 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:28:10.056740 [debug] [Thread-1 (]: On model.clinical_trials.countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.countries"} */
drop table if exists "clinical_trials"."silver"."countries__dbt_backup" cascade
[0m13:28:10.063897 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m13:28:10.068024 [debug] [Thread-1 (]: On model.clinical_trials.countries: Close
[0m13:28:10.070519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ccef057-e3ee-4f08-a05f-5832aa45de92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4492516870>]}
[0m13:28:10.072148 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.countries ............................. [[32mSELECT 1557[0m in 0.24s]
[0m13:28:10.073720 [debug] [Thread-1 (]: Finished running node model.clinical_trials.countries
[0m13:28:10.077078 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:10.078245 [debug] [MainThread]: On master: BEGIN
[0m13:28:10.078986 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:28:10.087374 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:28:10.088915 [debug] [MainThread]: On master: COMMIT
[0m13:28:10.089902 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:10.090789 [debug] [MainThread]: On master: COMMIT
[0m13:28:10.092097 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:28:10.093037 [debug] [MainThread]: On master: Close
[0m13:28:10.094212 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:10.095379 [debug] [MainThread]: Connection 'model.clinical_trials.countries' was properly closed.
[0m13:28:10.096347 [debug] [MainThread]: Connection 'list_clinical_trials_gold' was properly closed.
[0m13:28:10.097324 [info ] [MainThread]: 
[0m13:28:10.098523 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m13:28:10.100608 [debug] [MainThread]: Command end result
[0m13:28:10.138712 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:28:10.145790 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:28:10.157430 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:28:10.159061 [info ] [MainThread]: 
[0m13:28:10.161023 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:28:10.163233 [info ] [MainThread]: 
[0m13:28:10.164717 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:28:10.167077 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7998347, "process_in_blocks": "0", "process_kernel_time": 0.518089, "process_mem_max_rss": "112900", "process_out_blocks": "1600", "process_user_time": 2.819601}
[0m13:28:10.168771 [debug] [MainThread]: Command `dbt run` succeeded at 13:28:10.168603 after 1.80 seconds
[0m13:28:10.169827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4492332780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f449326c530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f448fd17230>]}
[0m13:28:10.170771 [debug] [MainThread]: Flushing usage events
[0m13:28:10.670930 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:32:16.970439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d26d2870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d1d3b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d26d24e0>]}


============================== 13:32:16.987355 | 3cbf0f94-dae0-4f94-8ebd-659eb9274e75 ==============================
[0m13:32:16.987355 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:32:16.990379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select silver.conditions', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:32:17.369786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cbf0f94-dae0-4f94-8ebd-659eb9274e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d01f1940>]}
[0m13:32:17.475735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3cbf0f94-dae0-4f94-8ebd-659eb9274e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d1f22600>]}
[0m13:32:17.478233 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:32:17.574692 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:32:17.914355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:32:17.916101 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/silver/interventions.sql
[0m13:32:17.918102 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/silver/conditions.sql
[0m13:32:18.341322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cbf0f94-dae0-4f94-8ebd-659eb9274e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07cfdae000>]}
[0m13:32:18.440587 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:32:18.448914 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:32:18.493201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cbf0f94-dae0-4f94-8ebd-659eb9274e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ce0bce00>]}
[0m13:32:18.495406 [info ] [MainThread]: Found 5 models, 1 source, 430 macros
[0m13:32:18.498160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cbf0f94-dae0-4f94-8ebd-659eb9274e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07cfe9a510>]}
[0m13:32:18.501852 [info ] [MainThread]: 
[0m13:32:18.503264 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:32:18.504783 [info ] [MainThread]: 
[0m13:32:18.506556 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:32:18.509279 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m13:32:18.569454 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m13:32:18.570882 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m13:32:18.571789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:18.582726 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m13:32:18.585625 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m13:32:18.591637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_gold)
[0m13:32:18.592527 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_silver'
[0m13:32:18.599633 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:32:18.602184 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:32:18.603271 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m13:32:18.604060 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m13:32:18.604902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:18.605594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:18.612610 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:32:18.614083 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:32:18.615109 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:32:18.615619 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m13:32:18.616553 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:32:18.618037 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m13:32:18.620359 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:32:18.622530 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m13:32:18.623642 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m13:32:18.624314 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m13:32:18.627532 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m13:32:18.628625 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m13:32:18.636558 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:18.637846 [debug] [MainThread]: On master: BEGIN
[0m13:32:18.638792 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:32:18.646054 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:32:18.647204 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:18.648387 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:32:18.653442 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m13:32:18.656321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cbf0f94-dae0-4f94-8ebd-659eb9274e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07cff6b110>]}
[0m13:32:18.657574 [debug] [MainThread]: On master: ROLLBACK
[0m13:32:18.658932 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:18.659888 [debug] [MainThread]: On master: BEGIN
[0m13:32:18.661076 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:32:18.662057 [debug] [MainThread]: On master: COMMIT
[0m13:32:18.662941 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:18.663988 [debug] [MainThread]: On master: COMMIT
[0m13:32:18.665129 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:32:18.666012 [debug] [MainThread]: On master: Close
[0m13:32:18.671914 [debug] [Thread-1 (]: Began running node model.clinical_trials.conditions
[0m13:32:18.673322 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.conditions ................................. [RUN]
[0m13:32:18.675661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver, now model.clinical_trials.conditions)
[0m13:32:18.676690 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.conditions
[0m13:32:18.686975 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.conditions"
[0m13:32:18.699272 [debug] [Thread-1 (]: Began executing node model.clinical_trials.conditions
[0m13:32:18.742966 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.conditions"
[0m13:32:18.755053 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.conditions"
[0m13:32:18.756145 [debug] [Thread-1 (]: On model.clinical_trials.conditions: BEGIN
[0m13:32:18.757108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:18.768402 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m13:32:18.770046 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.conditions"
[0m13:32:18.771117 [debug] [Thread-1 (]: On model.clinical_trials.conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.conditions"} */

  
    

  create  table "clinical_trials"."silver"."conditions__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  p.nct_id,
  nullif(trim(x), '') as condition
from "clinical_trials"."bronze"."raw_trials" p,
lateral regexp_split_to_table(p.conditions, '\s*;\s*') as x
where p.conditions is not null and p.conditions <> ''
  and nullif(trim(x), '') is not null
  );
  
[0m13:32:18.828020 [debug] [Thread-1 (]: SQL status: SELECT 2037 in 0.056 seconds
[0m13:32:18.838229 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.conditions"
[0m13:32:18.839452 [debug] [Thread-1 (]: On model.clinical_trials.conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.conditions"} */
alter table "clinical_trials"."silver"."conditions__dbt_tmp" rename to "conditions"
[0m13:32:18.841196 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:32:18.866500 [debug] [Thread-1 (]: On model.clinical_trials.conditions: COMMIT
[0m13:32:18.868046 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.conditions"
[0m13:32:18.869322 [debug] [Thread-1 (]: On model.clinical_trials.conditions: COMMIT
[0m13:32:18.873096 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:32:18.880861 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."conditions__dbt_backup"
[0m13:32:18.887843 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.conditions"
[0m13:32:18.889489 [debug] [Thread-1 (]: On model.clinical_trials.conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.conditions"} */
drop table if exists "clinical_trials"."silver"."conditions__dbt_backup" cascade
[0m13:32:18.891294 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:32:18.894792 [debug] [Thread-1 (]: On model.clinical_trials.conditions: Close
[0m13:32:18.898774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cbf0f94-dae0-4f94-8ebd-659eb9274e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d38a81a0>]}
[0m13:32:18.901155 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.conditions ............................ [[32mSELECT 2037[0m in 0.22s]
[0m13:32:18.902846 [debug] [Thread-1 (]: Finished running node model.clinical_trials.conditions
[0m13:32:18.906229 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:18.907294 [debug] [MainThread]: On master: BEGIN
[0m13:32:18.908260 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:32:18.916682 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:32:18.918338 [debug] [MainThread]: On master: COMMIT
[0m13:32:18.919892 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:18.921271 [debug] [MainThread]: On master: COMMIT
[0m13:32:18.922880 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:32:18.924030 [debug] [MainThread]: On master: Close
[0m13:32:18.925259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:18.926181 [debug] [MainThread]: Connection 'list_clinical_trials_gold' was properly closed.
[0m13:32:18.927116 [debug] [MainThread]: Connection 'model.clinical_trials.conditions' was properly closed.
[0m13:32:18.928126 [info ] [MainThread]: 
[0m13:32:18.929206 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m13:32:18.931031 [debug] [MainThread]: Command end result
[0m13:32:18.976583 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:32:18.982741 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:32:18.994751 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:32:18.996350 [info ] [MainThread]: 
[0m13:32:18.997718 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:32:18.999122 [info ] [MainThread]: 
[0m13:32:19.001039 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:32:19.003520 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1566768, "process_in_blocks": "0", "process_kernel_time": 0.494453, "process_mem_max_rss": "113064", "process_out_blocks": "1600", "process_user_time": 3.693264}
[0m13:32:19.005051 [debug] [MainThread]: Command `dbt run` succeeded at 13:32:19.004885 after 2.16 seconds
[0m13:32:19.006121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d1d3b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d1a99ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07cff8e4b0>]}
[0m13:32:19.007366 [debug] [MainThread]: Flushing usage events
[0m13:32:19.460803 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:32:31.763515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc472f560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc4407b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc472d9a0>]}


============================== 13:32:31.772670 | 5f1fa970-2c75-4024-8ae9-2bab80d221b8 ==============================
[0m13:32:31.772670 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:32:31.774070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select silver.interventions', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:32:32.008212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f1fa970-2c75-4024-8ae9-2bab80d221b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc2512f30>]}
[0m13:32:32.073164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f1fa970-2c75-4024-8ae9-2bab80d221b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc4b10b00>]}
[0m13:32:32.075006 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:32:32.142346 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:32:32.389989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:32:32.391504 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:32:32.434362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f1fa970-2c75-4024-8ae9-2bab80d221b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc2594050>]}
[0m13:32:32.525786 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:32:32.532936 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:32:32.572490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f1fa970-2c75-4024-8ae9-2bab80d221b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc2288860>]}
[0m13:32:32.574338 [info ] [MainThread]: Found 5 models, 1 source, 430 macros
[0m13:32:32.575895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f1fa970-2c75-4024-8ae9-2bab80d221b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc2260830>]}
[0m13:32:32.579505 [info ] [MainThread]: 
[0m13:32:32.581177 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:32:32.582772 [info ] [MainThread]: 
[0m13:32:32.584740 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:32:32.587244 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m13:32:32.638344 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m13:32:32.639676 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m13:32:32.640749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:32.650546 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m13:32:32.653763 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m13:32:32.661349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_gold)
[0m13:32:32.662170 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_silver'
[0m13:32:32.671184 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:32:32.675390 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:32:32.676633 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m13:32:32.677572 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m13:32:32.678339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:32.679110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:32.687103 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:32:32.687696 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:32:32.688620 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:32:32.689630 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:32:32.690621 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m13:32:32.691580 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m13:32:32.694848 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m13:32:32.695336 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:32:32.697670 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m13:32:32.699322 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m13:32:32.700538 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m13:32:32.701387 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m13:32:32.710347 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:32.711565 [debug] [MainThread]: On master: BEGIN
[0m13:32:32.712468 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:32:32.719820 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:32:32.721175 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:32.722539 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:32:32.727646 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m13:32:32.729914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f1fa970-2c75-4024-8ae9-2bab80d221b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc3d6b770>]}
[0m13:32:32.730947 [debug] [MainThread]: On master: ROLLBACK
[0m13:32:32.731897 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:32.732740 [debug] [MainThread]: On master: BEGIN
[0m13:32:32.734205 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:32:32.735400 [debug] [MainThread]: On master: COMMIT
[0m13:32:32.736391 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:32.737293 [debug] [MainThread]: On master: COMMIT
[0m13:32:32.738444 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:32:32.739226 [debug] [MainThread]: On master: Close
[0m13:32:32.744339 [debug] [Thread-1 (]: Began running node model.clinical_trials.interventions
[0m13:32:32.745551 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.interventions .............................. [RUN]
[0m13:32:32.746687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_gold, now model.clinical_trials.interventions)
[0m13:32:32.747829 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.interventions
[0m13:32:32.759171 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.interventions"
[0m13:32:32.768026 [debug] [Thread-1 (]: Began executing node model.clinical_trials.interventions
[0m13:32:32.809096 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.interventions"
[0m13:32:32.818128 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.interventions"
[0m13:32:32.819311 [debug] [Thread-1 (]: On model.clinical_trials.interventions: BEGIN
[0m13:32:32.820309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:32.827587 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m13:32:32.829388 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.interventions"
[0m13:32:32.830574 [debug] [Thread-1 (]: On model.clinical_trials.interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.interventions"} */

  
    

  create  table "clinical_trials"."silver"."interventions__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  p.nct_id,
  nullif(trim(x), '') as intervention
from "clinical_trials"."bronze"."raw_trials" p,
lateral regexp_split_to_table(p.interventions, '\s*;\s*') as x
where p.interventions is not null and p.interventions <> ''
  and nullif(trim(x), '') is not null
  );
  
[0m13:32:32.875546 [debug] [Thread-1 (]: SQL status: SELECT 1890 in 0.044 seconds
[0m13:32:32.885452 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.interventions"
[0m13:32:32.886684 [debug] [Thread-1 (]: On model.clinical_trials.interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.interventions"} */
alter table "clinical_trials"."silver"."interventions__dbt_tmp" rename to "interventions"
[0m13:32:32.888057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:32:32.912513 [debug] [Thread-1 (]: On model.clinical_trials.interventions: COMMIT
[0m13:32:32.913762 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.interventions"
[0m13:32:32.914668 [debug] [Thread-1 (]: On model.clinical_trials.interventions: COMMIT
[0m13:32:32.918146 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:32:32.924787 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."interventions__dbt_backup"
[0m13:32:32.932930 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.interventions"
[0m13:32:32.933967 [debug] [Thread-1 (]: On model.clinical_trials.interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.interventions"} */
drop table if exists "clinical_trials"."silver"."interventions__dbt_backup" cascade
[0m13:32:32.935358 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:32:32.938715 [debug] [Thread-1 (]: On model.clinical_trials.interventions: Close
[0m13:32:32.940969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f1fa970-2c75-4024-8ae9-2bab80d221b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc5d1a8a0>]}
[0m13:32:32.942396 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.interventions ......................... [[32mSELECT 1890[0m in 0.19s]
[0m13:32:32.944129 [debug] [Thread-1 (]: Finished running node model.clinical_trials.interventions
[0m13:32:32.946889 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:32.947801 [debug] [MainThread]: On master: BEGIN
[0m13:32:32.948700 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:32:32.955411 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:32:32.956704 [debug] [MainThread]: On master: COMMIT
[0m13:32:32.957617 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:32.958499 [debug] [MainThread]: On master: COMMIT
[0m13:32:32.959644 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:32:32.960643 [debug] [MainThread]: On master: Close
[0m13:32:32.962031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:32.963637 [debug] [MainThread]: Connection 'model.clinical_trials.interventions' was properly closed.
[0m13:32:32.965136 [debug] [MainThread]: Connection 'list_clinical_trials_silver' was properly closed.
[0m13:32:32.966608 [info ] [MainThread]: 
[0m13:32:32.968084 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m13:32:32.970598 [debug] [MainThread]: Command end result
[0m13:32:33.009781 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:32:33.016173 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:32:33.028076 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:32:33.029290 [info ] [MainThread]: 
[0m13:32:33.030466 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:32:33.032796 [info ] [MainThread]: 
[0m13:32:33.034990 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:32:33.037122 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3402829, "process_in_blocks": "0", "process_kernel_time": 0.359235, "process_mem_max_rss": "109728", "process_out_blocks": "1600", "process_user_time": 2.444793}
[0m13:32:33.038630 [debug] [MainThread]: Command `dbt run` succeeded at 13:32:33.038469 after 1.34 seconds
[0m13:32:33.039668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc3e29700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc3fc52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc3fc6e40>]}
[0m13:32:33.040597 [debug] [MainThread]: Flushing usage events
[0m13:32:33.467064 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:49.216879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a324c2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a30c1a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a30c191f0>]}


============================== 13:44:49.233886 | d92dee30-4d79-4866-8e63-e20ca2876fd1 ==============================
[0m13:44:49.233886 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:44:49.235960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select silver.conditions', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:44:49.483781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd92dee30-4d79-4866-8e63-e20ca2876fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3257f890>]}
[0m13:44:49.548694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd92dee30-4d79-4866-8e63-e20ca2876fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a306f8f50>]}
[0m13:44:49.550624 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:44:49.631659 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:44:49.890571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:44:49.891840 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/silver/conditions.sql
[0m13:44:49.892846 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/silver/processed_trials.sql
[0m13:44:50.194361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd92dee30-4d79-4866-8e63-e20ca2876fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2ea3d3d0>]}
[0m13:44:50.301444 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:44:50.316289 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:44:50.388653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd92dee30-4d79-4866-8e63-e20ca2876fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2ce3cef0>]}
[0m13:44:50.390015 [info ] [MainThread]: Found 5 models, 1 source, 430 macros
[0m13:44:50.391276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd92dee30-4d79-4866-8e63-e20ca2876fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2eaef1d0>]}
[0m13:44:50.395041 [info ] [MainThread]: 
[0m13:44:50.397184 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:44:50.398917 [info ] [MainThread]: 
[0m13:44:50.400956 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:44:50.403580 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m13:44:50.478905 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m13:44:50.480706 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m13:44:50.481773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:50.503624 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.022 seconds
[0m13:44:50.506596 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m13:44:50.513293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_gold)
[0m13:44:50.516365 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_silver'
[0m13:44:50.522994 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:44:50.526023 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:44:50.527327 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m13:44:50.528550 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m13:44:50.529709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:50.530753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:50.540402 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:44:50.541969 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:44:50.543218 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m13:44:50.543881 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m13:44:50.545652 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:44:50.546813 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m13:44:50.550351 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m13:44:50.552667 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m13:44:50.553357 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m13:44:50.554169 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m13:44:50.556819 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m13:44:50.559454 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m13:44:50.567710 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:50.569111 [debug] [MainThread]: On master: BEGIN
[0m13:44:50.570128 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:50.578046 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:44:50.579857 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:50.581003 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:44:50.588020 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m13:44:50.590853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd92dee30-4d79-4866-8e63-e20ca2876fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2eaef1a0>]}
[0m13:44:50.592118 [debug] [MainThread]: On master: ROLLBACK
[0m13:44:50.593463 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:50.594863 [debug] [MainThread]: On master: BEGIN
[0m13:44:50.596298 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:44:50.597424 [debug] [MainThread]: On master: COMMIT
[0m13:44:50.598687 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:50.599674 [debug] [MainThread]: On master: COMMIT
[0m13:44:50.600861 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:44:50.601761 [debug] [MainThread]: On master: Close
[0m13:44:50.605878 [debug] [Thread-1 (]: Began running node model.clinical_trials.conditions
[0m13:44:50.607138 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.conditions ................................. [RUN]
[0m13:44:50.608572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver, now model.clinical_trials.conditions)
[0m13:44:50.610117 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.conditions
[0m13:44:50.621531 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.conditions"
[0m13:44:50.631989 [debug] [Thread-1 (]: Began executing node model.clinical_trials.conditions
[0m13:44:50.676378 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.conditions"
[0m13:44:50.687656 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.conditions"
[0m13:44:50.689173 [debug] [Thread-1 (]: On model.clinical_trials.conditions: BEGIN
[0m13:44:50.690488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:50.701179 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m13:44:50.703027 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.conditions"
[0m13:44:50.704211 [debug] [Thread-1 (]: On model.clinical_trials.conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.conditions"} */

  
    

  create  table "clinical_trials"."silver"."conditions__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  p.nct_id,
  nullif(trim(x), '') as condition
from "clinical_trials"."bronze"."raw_trials" p,
lateral regexp_split_to_table(p.conditions, '\s*[;,]\s*') as x
where p.conditions is not null and p.conditions <> ''
  and nullif(trim(x), '') is not null
  );
  
[0m13:44:50.896549 [debug] [Thread-1 (]: SQL status: SELECT 2168 in 0.191 seconds
[0m13:44:50.907500 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.conditions"
[0m13:44:50.909041 [debug] [Thread-1 (]: On model.clinical_trials.conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.conditions"} */
alter table "clinical_trials"."silver"."conditions" rename to "conditions__dbt_backup"
[0m13:44:50.911265 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:44:50.915325 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.conditions"
[0m13:44:50.916399 [debug] [Thread-1 (]: On model.clinical_trials.conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.conditions"} */
alter table "clinical_trials"."silver"."conditions__dbt_tmp" rename to "conditions"
[0m13:44:50.917945 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:44:50.940734 [debug] [Thread-1 (]: On model.clinical_trials.conditions: COMMIT
[0m13:44:50.942245 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.conditions"
[0m13:44:50.943455 [debug] [Thread-1 (]: On model.clinical_trials.conditions: COMMIT
[0m13:44:50.950228 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:44:50.957750 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."conditions__dbt_backup"
[0m13:44:50.966608 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.conditions"
[0m13:44:50.968006 [debug] [Thread-1 (]: On model.clinical_trials.conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.conditions"} */
drop table if exists "clinical_trials"."silver"."conditions__dbt_backup" cascade
[0m13:44:50.973258 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m13:44:50.976496 [debug] [Thread-1 (]: On model.clinical_trials.conditions: Close
[0m13:44:50.980341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd92dee30-4d79-4866-8e63-e20ca2876fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2c09fc20>]}
[0m13:44:50.982409 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.conditions ............................ [[32mSELECT 2168[0m in 0.37s]
[0m13:44:50.984713 [debug] [Thread-1 (]: Finished running node model.clinical_trials.conditions
[0m13:44:50.988092 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:50.989347 [debug] [MainThread]: On master: BEGIN
[0m13:44:50.990432 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:44:50.999951 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:44:51.001875 [debug] [MainThread]: On master: COMMIT
[0m13:44:51.003110 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:51.004279 [debug] [MainThread]: On master: COMMIT
[0m13:44:51.005823 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:44:51.007306 [debug] [MainThread]: On master: Close
[0m13:44:51.008772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:51.010501 [debug] [MainThread]: Connection 'list_clinical_trials_gold' was properly closed.
[0m13:44:51.012475 [debug] [MainThread]: Connection 'model.clinical_trials.conditions' was properly closed.
[0m13:44:51.014706 [info ] [MainThread]: 
[0m13:44:51.016429 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m13:44:51.018844 [debug] [MainThread]: Command end result
[0m13:44:51.070258 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:44:51.077717 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:44:51.094645 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:44:51.096304 [info ] [MainThread]: 
[0m13:44:51.098148 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:44:51.099851 [info ] [MainThread]: 
[0m13:44:51.101389 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:44:51.104753 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9550927, "process_in_blocks": "0", "process_kernel_time": 0.818072, "process_mem_max_rss": "112032", "process_out_blocks": "1600", "process_user_time": 2.716807}
[0m13:44:51.106399 [debug] [MainThread]: Command `dbt run` succeeded at 13:44:51.106198 after 1.96 seconds
[0m13:44:51.107819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3090b9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a31152f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3257e960>]}
[0m13:44:51.109198 [debug] [MainThread]: Flushing usage events
[0m13:44:51.666328 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:34.697945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbb0545d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbafbff800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbaec22540>]}


============================== 13:47:34.707135 | a7f78a47-ed71-4364-818e-66eef2df4161 ==============================
[0m13:47:34.707135 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:47:34.709423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select silver.countries', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:47:34.947764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7f78a47-ed71-4364-818e-66eef2df4161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbae625af0>]}
[0m13:47:35.015161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7f78a47-ed71-4364-818e-66eef2df4161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbae763ef0>]}
[0m13:47:35.018198 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:47:35.090447 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:47:35.384089 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:47:35.386151 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/silver/interventions.sql
[0m13:47:35.387813 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/silver/countries.sql
[0m13:47:35.389781 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/silver/processed_trials.sql
[0m13:47:35.828493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7f78a47-ed71-4364-818e-66eef2df4161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbac9dd850>]}
[0m13:47:35.966028 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:47:35.980239 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:47:36.058368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7f78a47-ed71-4364-818e-66eef2df4161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbaca78e60>]}
[0m13:47:36.060692 [info ] [MainThread]: Found 5 models, 1 source, 430 macros
[0m13:47:36.062616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7f78a47-ed71-4364-818e-66eef2df4161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbaca9e5d0>]}
[0m13:47:36.066177 [info ] [MainThread]: 
[0m13:47:36.067704 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:47:36.069563 [info ] [MainThread]: 
[0m13:47:36.073973 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:47:36.077795 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m13:47:36.159104 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m13:47:36.160626 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m13:47:36.162445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:36.180748 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.018 seconds
[0m13:47:36.183708 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m13:47:36.191774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_gold)
[0m13:47:36.192862 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_silver'
[0m13:47:36.200503 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:47:36.204077 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:47:36.205826 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m13:47:36.206982 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m13:47:36.208275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:36.209257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:36.218444 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:47:36.219515 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:47:36.220359 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:47:36.221614 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:47:36.222955 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m13:47:36.224079 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m13:47:36.228973 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m13:47:36.229464 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m13:47:36.233250 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m13:47:36.236116 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m13:47:36.237624 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m13:47:36.238547 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m13:47:36.248767 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:36.250229 [debug] [MainThread]: On master: BEGIN
[0m13:47:36.251503 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:47:36.261942 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:47:36.263590 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:36.265080 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:47:36.272852 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m13:47:36.275409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7f78a47-ed71-4364-818e-66eef2df4161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbaca78a40>]}
[0m13:47:36.276695 [debug] [MainThread]: On master: ROLLBACK
[0m13:47:36.277946 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:36.279048 [debug] [MainThread]: On master: BEGIN
[0m13:47:36.280407 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:47:36.281871 [debug] [MainThread]: On master: COMMIT
[0m13:47:36.282899 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:36.283918 [debug] [MainThread]: On master: COMMIT
[0m13:47:36.285118 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:47:36.286120 [debug] [MainThread]: On master: Close
[0m13:47:36.293282 [debug] [Thread-1 (]: Began running node model.clinical_trials.countries
[0m13:47:36.294880 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.countries .................................. [RUN]
[0m13:47:36.296577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_gold, now model.clinical_trials.countries)
[0m13:47:36.298141 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.countries
[0m13:47:36.310404 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.countries"
[0m13:47:36.321954 [debug] [Thread-1 (]: Began executing node model.clinical_trials.countries
[0m13:47:36.371397 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.countries"
[0m13:47:36.383728 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:47:36.385069 [debug] [Thread-1 (]: On model.clinical_trials.countries: BEGIN
[0m13:47:36.386205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:36.395280 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m13:47:36.396970 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:47:36.398462 [debug] [Thread-1 (]: On model.clinical_trials.countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.countries"} */

  
    

  create  table "clinical_trials"."silver"."countries__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  p.nct_id,
  nullif(trim(x), '') as country
from "clinical_trials"."bronze"."raw_trials" p,
lateral regexp_split_to_table(p.countries, '\s*[;,]\s*') as x
where p.countries is not null and p.countries <> ''
  and nullif(trim(x), '') is not null
  );
  
[0m13:47:36.516019 [debug] [Thread-1 (]: SQL status: SELECT 1557 in 0.116 seconds
[0m13:47:36.524787 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:47:36.525975 [debug] [Thread-1 (]: On model.clinical_trials.countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.countries"} */
alter table "clinical_trials"."silver"."countries" rename to "countries__dbt_backup"
[0m13:47:36.527609 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:47:36.531379 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:47:36.533076 [debug] [Thread-1 (]: On model.clinical_trials.countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.countries"} */
alter table "clinical_trials"."silver"."countries__dbt_tmp" rename to "countries"
[0m13:47:36.534814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:47:36.558048 [debug] [Thread-1 (]: On model.clinical_trials.countries: COMMIT
[0m13:47:36.559128 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:47:36.560212 [debug] [Thread-1 (]: On model.clinical_trials.countries: COMMIT
[0m13:47:36.564550 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:47:36.572212 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."countries__dbt_backup"
[0m13:47:36.579009 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.countries"
[0m13:47:36.580657 [debug] [Thread-1 (]: On model.clinical_trials.countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.countries"} */
drop table if exists "clinical_trials"."silver"."countries__dbt_backup" cascade
[0m13:47:36.585246 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m13:47:36.589203 [debug] [Thread-1 (]: On model.clinical_trials.countries: Close
[0m13:47:36.592179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7f78a47-ed71-4364-818e-66eef2df4161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbb06024b0>]}
[0m13:47:36.593781 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.countries ............................. [[32mSELECT 1557[0m in 0.29s]
[0m13:47:36.595230 [debug] [Thread-1 (]: Finished running node model.clinical_trials.countries
[0m13:47:36.598484 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:36.599672 [debug] [MainThread]: On master: BEGIN
[0m13:47:36.600750 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:47:36.611329 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:47:36.612813 [debug] [MainThread]: On master: COMMIT
[0m13:47:36.614066 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:36.615271 [debug] [MainThread]: On master: COMMIT
[0m13:47:36.616843 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:47:36.617968 [debug] [MainThread]: On master: Close
[0m13:47:36.619293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:36.620361 [debug] [MainThread]: Connection 'model.clinical_trials.countries' was properly closed.
[0m13:47:36.621322 [debug] [MainThread]: Connection 'list_clinical_trials_silver' was properly closed.
[0m13:47:36.622515 [info ] [MainThread]: 
[0m13:47:36.624158 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m13:47:36.627150 [debug] [MainThread]: Command end result
[0m13:47:36.673933 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:47:36.681450 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:47:36.696079 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:47:36.697225 [info ] [MainThread]: 
[0m13:47:36.698659 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:47:36.700523 [info ] [MainThread]: 
[0m13:47:36.702329 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:47:36.705161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0756648, "process_in_blocks": "0", "process_kernel_time": 0.400554, "process_mem_max_rss": "115156", "process_out_blocks": "1600", "process_user_time": 2.944078}
[0m13:47:36.706880 [debug] [MainThread]: Command `dbt run` succeeded at 13:47:36.706705 after 2.08 seconds
[0m13:47:36.708068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbae8e8da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbaca58590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbae78c2c0>]}
[0m13:47:36.709225 [debug] [MainThread]: Flushing usage events
[0m13:47:37.220763 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:46.546428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1703920560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17054d8140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1703c4a3f0>]}


============================== 13:47:46.565572 | d2fc3f2d-07e8-4bb9-99b6-7c9426b8392f ==============================
[0m13:47:46.565572 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:47:46.567656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select silver.interventions', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:47:46.871405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2fc3f2d-07e8-4bb9-99b6-7c9426b8392f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17036f6270>]}
[0m13:47:46.950541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2fc3f2d-07e8-4bb9-99b6-7c9426b8392f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17034b76e0>]}
[0m13:47:46.952576 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:47:47.037969 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:47:47.339602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:47:47.341030 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:47:47.386891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2fc3f2d-07e8-4bb9-99b6-7c9426b8392f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1703b23bc0>]}
[0m13:47:47.490042 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:47:47.497745 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:47:47.541909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2fc3f2d-07e8-4bb9-99b6-7c9426b8392f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1701a27ec0>]}
[0m13:47:47.544409 [info ] [MainThread]: Found 5 models, 1 source, 430 macros
[0m13:47:47.546839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2fc3f2d-07e8-4bb9-99b6-7c9426b8392f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1701b150d0>]}
[0m13:47:47.552015 [info ] [MainThread]: 
[0m13:47:47.553740 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:47:47.555180 [info ] [MainThread]: 
[0m13:47:47.557622 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:47:47.560177 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m13:47:47.629036 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m13:47:47.630729 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m13:47:47.631827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:47.645689 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.014 seconds
[0m13:47:47.648361 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m13:47:47.656466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_silver)
[0m13:47:47.657506 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_gold'
[0m13:47:47.666878 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:47:47.669266 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:47:47.670337 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m13:47:47.671502 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m13:47:47.672328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:47.673346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:47.681378 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:47:47.681942 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:47:47.682903 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:47:47.683823 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:47:47.684616 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m13:47:47.685571 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m13:47:47.689400 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:47:47.689969 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m13:47:47.691840 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m13:47:47.694120 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m13:47:47.695412 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m13:47:47.696237 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m13:47:47.705053 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:47.706429 [debug] [MainThread]: On master: BEGIN
[0m13:47:47.707493 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:47:47.716432 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:47:47.717613 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:47.718802 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:47:47.724992 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m13:47:47.727715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2fc3f2d-07e8-4bb9-99b6-7c9426b8392f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1701cbeab0>]}
[0m13:47:47.728973 [debug] [MainThread]: On master: ROLLBACK
[0m13:47:47.730274 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:47.731598 [debug] [MainThread]: On master: BEGIN
[0m13:47:47.733084 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:47:47.734249 [debug] [MainThread]: On master: COMMIT
[0m13:47:47.735308 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:47.736331 [debug] [MainThread]: On master: COMMIT
[0m13:47:47.737395 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:47:47.738266 [debug] [MainThread]: On master: Close
[0m13:47:47.744727 [debug] [Thread-1 (]: Began running node model.clinical_trials.interventions
[0m13:47:47.746243 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.interventions .............................. [RUN]
[0m13:47:47.748527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver, now model.clinical_trials.interventions)
[0m13:47:47.750404 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.interventions
[0m13:47:47.761263 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.interventions"
[0m13:47:47.772876 [debug] [Thread-1 (]: Began executing node model.clinical_trials.interventions
[0m13:47:47.824902 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.interventions"
[0m13:47:47.835727 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.interventions"
[0m13:47:47.837808 [debug] [Thread-1 (]: On model.clinical_trials.interventions: BEGIN
[0m13:47:47.839429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:47.849416 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m13:47:47.851054 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.interventions"
[0m13:47:47.852239 [debug] [Thread-1 (]: On model.clinical_trials.interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.interventions"} */

  
    

  create  table "clinical_trials"."silver"."interventions__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  p.nct_id,
  nullif(trim(x), '') as intervention
from "clinical_trials"."bronze"."raw_trials" p,
lateral regexp_split_to_table(p.interventions, '\s*[;,]\s*') as x
where p.interventions is not null and p.interventions <> ''
  and nullif(trim(x), '') is not null
  );
  
[0m13:47:47.911428 [debug] [Thread-1 (]: SQL status: SELECT 1928 in 0.058 seconds
[0m13:47:47.921899 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.interventions"
[0m13:47:47.923781 [debug] [Thread-1 (]: On model.clinical_trials.interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.interventions"} */
alter table "clinical_trials"."silver"."interventions" rename to "interventions__dbt_backup"
[0m13:47:47.925641 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:47:47.930342 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.interventions"
[0m13:47:47.931785 [debug] [Thread-1 (]: On model.clinical_trials.interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.interventions"} */
alter table "clinical_trials"."silver"."interventions__dbt_tmp" rename to "interventions"
[0m13:47:47.933682 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:47:47.971507 [debug] [Thread-1 (]: On model.clinical_trials.interventions: COMMIT
[0m13:47:47.973800 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.interventions"
[0m13:47:47.975057 [debug] [Thread-1 (]: On model.clinical_trials.interventions: COMMIT
[0m13:47:47.979196 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:47:47.991608 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."interventions__dbt_backup"
[0m13:47:48.003173 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.interventions"
[0m13:47:48.004685 [debug] [Thread-1 (]: On model.clinical_trials.interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.interventions"} */
drop table if exists "clinical_trials"."silver"."interventions__dbt_backup" cascade
[0m13:47:48.011001 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m13:47:48.017229 [debug] [Thread-1 (]: On model.clinical_trials.interventions: Close
[0m13:47:48.021405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2fc3f2d-07e8-4bb9-99b6-7c9426b8392f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1705452420>]}
[0m13:47:48.023152 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.interventions ......................... [[32mSELECT 1928[0m in 0.27s]
[0m13:47:48.025312 [debug] [Thread-1 (]: Finished running node model.clinical_trials.interventions
[0m13:47:48.029706 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:48.030766 [debug] [MainThread]: On master: BEGIN
[0m13:47:48.031742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:47:48.042352 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m13:47:48.043884 [debug] [MainThread]: On master: COMMIT
[0m13:47:48.045072 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:48.045928 [debug] [MainThread]: On master: COMMIT
[0m13:47:48.046894 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:47:48.048109 [debug] [MainThread]: On master: Close
[0m13:47:48.049438 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:48.050524 [debug] [MainThread]: Connection 'model.clinical_trials.interventions' was properly closed.
[0m13:47:48.051441 [debug] [MainThread]: Connection 'list_clinical_trials_gold' was properly closed.
[0m13:47:48.052392 [info ] [MainThread]: 
[0m13:47:48.053580 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m13:47:48.056241 [debug] [MainThread]: Command end result
[0m13:47:48.115705 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:47:48.123791 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:47:48.143443 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:47:48.144922 [info ] [MainThread]: 
[0m13:47:48.146525 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:47:48.148192 [info ] [MainThread]: 
[0m13:47:48.150099 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:47:48.154228 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7063769, "process_in_blocks": "0", "process_kernel_time": 0.587753, "process_mem_max_rss": "109748", "process_out_blocks": "1600", "process_user_time": 3.009701}
[0m13:47:48.156750 [debug] [MainThread]: Command `dbt run` succeeded at 13:47:48.156377 after 1.71 seconds
[0m13:47:48.158234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1703472480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17041679b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f170027aab0>]}
[0m13:47:48.159660 [debug] [MainThread]: Flushing usage events
[0m13:47:48.642936 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:58.886699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae5031df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae654c890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae47b4bf0>]}


============================== 13:47:58.895821 | 0bdc752d-e4f5-41ab-bf6e-078b64af6980 ==============================
[0m13:47:58.895821 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:47:58.897212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select silver.processed_trials', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:47:59.141402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bdc752d-e4f5-41ab-bf6e-078b64af6980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae4587440>]}
[0m13:47:59.207157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bdc752d-e4f5-41ab-bf6e-078b64af6980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae6381520>]}
[0m13:47:59.208990 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:47:59.280827 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:47:59.506435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:47:59.507671 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:47:59.551873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bdc752d-e4f5-41ab-bf6e-078b64af6980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae2d1ad50>]}
[0m13:47:59.644284 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:47:59.651112 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:47:59.694140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bdc752d-e4f5-41ab-bf6e-078b64af6980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae2a3c6b0>]}
[0m13:47:59.695613 [info ] [MainThread]: Found 5 models, 1 source, 430 macros
[0m13:47:59.697341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bdc752d-e4f5-41ab-bf6e-078b64af6980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae45673e0>]}
[0m13:47:59.701847 [info ] [MainThread]: 
[0m13:47:59.704367 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:47:59.706737 [info ] [MainThread]: 
[0m13:47:59.708747 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:47:59.710960 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m13:47:59.776940 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m13:47:59.778385 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m13:47:59.779713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:59.791440 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.012 seconds
[0m13:47:59.794118 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m13:47:59.801214 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_silver)
[0m13:47:59.801937 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_gold'
[0m13:47:59.810635 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:47:59.813000 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:47:59.813835 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m13:47:59.814665 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m13:47:59.815473 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:59.816591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:59.824092 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:47:59.825325 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m13:47:59.825734 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:47:59.826584 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m13:47:59.827620 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m13:47:59.829045 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m13:47:59.833882 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m13:47:59.834963 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m13:47:59.838167 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m13:47:59.840810 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m13:47:59.842865 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m13:47:59.843909 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m13:47:59.854032 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:59.855594 [debug] [MainThread]: On master: BEGIN
[0m13:47:59.857099 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:47:59.863786 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:47:59.864991 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:59.866047 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:47:59.871180 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m13:47:59.873287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bdc752d-e4f5-41ab-bf6e-078b64af6980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae1be1790>]}
[0m13:47:59.874444 [debug] [MainThread]: On master: ROLLBACK
[0m13:47:59.875526 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:59.876314 [debug] [MainThread]: On master: BEGIN
[0m13:47:59.877577 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:47:59.878454 [debug] [MainThread]: On master: COMMIT
[0m13:47:59.879284 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:59.880081 [debug] [MainThread]: On master: COMMIT
[0m13:47:59.881040 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:47:59.881977 [debug] [MainThread]: On master: Close
[0m13:47:59.886577 [debug] [Thread-1 (]: Began running node model.clinical_trials.processed_trials
[0m13:47:59.888100 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.processed_trials ........................... [RUN]
[0m13:47:59.889532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_gold, now model.clinical_trials.processed_trials)
[0m13:47:59.890789 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.processed_trials
[0m13:47:59.900878 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.processed_trials"
[0m13:47:59.910170 [debug] [Thread-1 (]: Began executing node model.clinical_trials.processed_trials
[0m13:47:59.955754 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.processed_trials"
[0m13:47:59.964807 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m13:47:59.965927 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: BEGIN
[0m13:47:59.966825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:59.975020 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:47:59.976324 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m13:47:59.977554 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.processed_trials"} */

  
    

  create  table "clinical_trials"."silver"."processed_trials__dbt_tmp"
  
  
    as
  
  (
    

with src as (
  select
    nct_id,
    brief_title,
    study_type,
    case
      when coalesce(upper(study_type), '') = 'OBSERVATIONAL' then 'NOT APPLICABLE'
      when phase is null then null
      else upper(phase)
    end as phase,
    overall_status,
    start_date      as start_date_raw,
    completion_date as completion_date_raw
  from "clinical_trials"."bronze"."raw_trials"
),

-- 1) Homogenize placeholders -> NULL
nulls as (
  select
    nct_id,
    nullif(trim(brief_title),      '')              as brief_title,
    nullif(trim(study_type),       '')              as study_type,
    nullif(trim(phase),            '')              as phase,
    nullif(trim(overall_status),   '')              as status,
    nullif(trim(start_date_raw),       '')          as start_date_raw,
    nullif(trim(completion_date_raw),  '')          as completion_date_raw
  from src
),

-- Treat common placeholders (‘NA’, ‘N/A’, ‘UNKNOWN’, ‘NULL’ the *string*) as NULL
placeholders as (
  select
    nct_id,
    case when upper(brief_title)    in ('NA','N/A','UNKNOWN','NULL') then null else brief_title end    as brief_title,
    case when upper(study_type)     in ('NA','N/A','UNKNOWN','NULL') then null else study_type  end    as study_type,
    case when upper(phase)       in ('NA','N/A','UNKNOWN','NULL') then null else phase    end    as phase,
    case when upper(status)      in ('NA','N/A','UNKNOWN','NULL') then null else status   end    as status,
    case when upper(start_date_raw)     in ('NA','N/A','UNKNOWN','NULL') then null else start_date_raw  end    as start_date_raw,
    case when upper(completion_date_raw)in ('NA','N/A','UNKNOWN','NULL') then null else completion_date_raw end as completion_date_raw
  from nulls
),

-- 2) Parse partial dates (YYYY, YYYY-MM, YYYY-MM-DD) -> DATE
dates as (
  select
    nct_id,
    brief_title,
    study_type,
    status,
    phase,

    case
      when start_date_raw ~ '^\d{4}-\d{2}-\d{2}$' then to_date(start_date_raw,'YYYY-MM-DD')
      when start_date_raw ~ '^\d{4}-\d{2}$'       then to_date(start_date_raw||'-01','YYYY-MM-DD')
      when start_date_raw ~ '^\d{4}$'             then to_date(start_date_raw||'-01-01','YYYY-MM-DD')
      else null
    end as start_date,

    case
      when completion_date_raw ~ '^\d{4}-\d{2}-\d{2}$' then to_date(completion_date_raw,'YYYY-MM-DD')
      when completion_date_raw ~ '^\d{4}-\d{2}$'       then to_date(completion_date_raw||'-01','YYYY-MM-DD')
      when completion_date_raw ~ '^\d{4}$'             then to_date(completion_date_raw||'-01-01','YYYY-MM-DD')
      else null
    end as completion_date
  from placeholders
)

select 
    nct_id,
    brief_title,
    study_type,
    status,
    phase,
    start_date,
    completion_date
from dates
  );
  
[0m13:48:00.020484 [debug] [Thread-1 (]: SQL status: SELECT 1100 in 0.042 seconds
[0m13:48:00.031536 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m13:48:00.033595 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.processed_trials"} */
alter table "clinical_trials"."silver"."processed_trials" rename to "processed_trials__dbt_backup"
[0m13:48:00.035874 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:48:00.040015 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m13:48:00.041333 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.processed_trials"} */
alter table "clinical_trials"."silver"."processed_trials__dbt_tmp" rename to "processed_trials"
[0m13:48:00.042757 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:48:00.063932 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: COMMIT
[0m13:48:00.065537 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m13:48:00.066647 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: COMMIT
[0m13:48:00.069922 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:48:00.079139 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."processed_trials__dbt_backup"
[0m13:48:00.085250 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.processed_trials"
[0m13:48:00.086695 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.processed_trials"} */
drop table if exists "clinical_trials"."silver"."processed_trials__dbt_backup" cascade
[0m13:48:00.093731 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m13:48:00.097669 [debug] [Thread-1 (]: On model.clinical_trials.processed_trials: Close
[0m13:48:00.100893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bdc752d-e4f5-41ab-bf6e-078b64af6980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae64ce930>]}
[0m13:48:00.102500 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.processed_trials ...................... [[32mSELECT 1100[0m in 0.21s]
[0m13:48:00.104454 [debug] [Thread-1 (]: Finished running node model.clinical_trials.processed_trials
[0m13:48:00.108759 [debug] [MainThread]: Using postgres connection "master"
[0m13:48:00.110273 [debug] [MainThread]: On master: BEGIN
[0m13:48:00.111557 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:48:00.120000 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:48:00.121691 [debug] [MainThread]: On master: COMMIT
[0m13:48:00.123124 [debug] [MainThread]: Using postgres connection "master"
[0m13:48:00.124516 [debug] [MainThread]: On master: COMMIT
[0m13:48:00.125770 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:48:00.126725 [debug] [MainThread]: On master: Close
[0m13:48:00.128184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:48:00.129283 [debug] [MainThread]: Connection 'list_clinical_trials_silver' was properly closed.
[0m13:48:00.130172 [debug] [MainThread]: Connection 'model.clinical_trials.processed_trials' was properly closed.
[0m13:48:00.131178 [info ] [MainThread]: 
[0m13:48:00.132129 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m13:48:00.134389 [debug] [MainThread]: Command end result
[0m13:48:00.177670 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:48:00.185004 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:48:00.200134 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:48:00.201737 [info ] [MainThread]: 
[0m13:48:00.203583 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:48:00.205022 [info ] [MainThread]: 
[0m13:48:00.206569 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:48:00.208815 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3933983, "process_in_blocks": "0", "process_kernel_time": 0.32992, "process_mem_max_rss": "109964", "process_out_blocks": "1600", "process_user_time": 2.519394}
[0m13:48:00.210112 [debug] [MainThread]: Command `dbt run` succeeded at 13:48:00.209951 after 1.39 seconds
[0m13:48:00.211144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae48ea4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae2acd040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae2acdc70>]}
[0m13:48:00.212169 [debug] [MainThread]: Flushing usage events
[0m13:48:00.652053 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:51:05.295082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5447075d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54474a7f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54474a7d10>]}


============================== 14:51:05.319111 | 881d4aa8-bfcd-4433-ace8-f51d774a3cdb ==============================
[0m14:51:05.319111 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:51:05.321820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select silver.slv-processed_trials', 'send_anonymous_usage_stats': 'True'}
[0m14:51:05.697068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '881d4aa8-bfcd-4433-ace8-f51d774a3cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544692dfa0>]}
[0m14:51:05.794510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '881d4aa8-bfcd-4433-ace8-f51d774a3cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544509ce00>]}
[0m14:51:05.796829 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:51:05.898576 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:51:06.299635 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 8 files added, 0 files changed.
[0m14:51:06.302268 [debug] [MainThread]: Partial parsing: added file: clinical_trials://models/silver/slv-processed_trials.sql
[0m14:51:06.304341 [debug] [MainThread]: Partial parsing: added file: clinical_trials://models/gold/gld-countries.sql
[0m14:51:06.306340 [debug] [MainThread]: Partial parsing: added file: clinical_trials://models/silver/slv-countries.sql
[0m14:51:06.308602 [debug] [MainThread]: Partial parsing: added file: clinical_trials://models/silver/slv-conditions.sql
[0m14:51:06.310623 [debug] [MainThread]: Partial parsing: added file: clinical_trials://models/gold/gld-conditions.sql
[0m14:51:06.313195 [debug] [MainThread]: Partial parsing: added file: clinical_trials://models/gold/gld-interventions.sql
[0m14:51:06.314699 [debug] [MainThread]: Partial parsing: added file: clinical_trials://models/silver/slv-interventions.sql
[0m14:51:06.315948 [debug] [MainThread]: Partial parsing: added file: clinical_trials://models/gold/gld-enriched_trials.sql
[0m14:51:06.317080 [debug] [MainThread]: Partial parsing: deleted file: clinical_trials://models/gold/enriched_trials.sql
[0m14:51:06.318338 [debug] [MainThread]: Partial parsing: deleted file: clinical_trials://models/silver/processed_trials.sql
[0m14:51:06.319696 [debug] [MainThread]: Partial parsing: deleted file: clinical_trials://models/silver/countries.sql
[0m14:51:06.320989 [debug] [MainThread]: Partial parsing: deleted file: clinical_trials://models/silver/conditions.sql
[0m14:51:06.322191 [debug] [MainThread]: Partial parsing: deleted file: clinical_trials://models/silver/interventions.sql
[0m14:51:06.763095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '881d4aa8-bfcd-4433-ace8-f51d774a3cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5444d63e30>]}
[0m14:51:06.890065 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:51:06.899263 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:51:06.970209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '881d4aa8-bfcd-4433-ace8-f51d774a3cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5444fa3c20>]}
[0m14:51:06.972529 [info ] [MainThread]: Found 8 models, 1 source, 430 macros
[0m14:51:06.974867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '881d4aa8-bfcd-4433-ace8-f51d774a3cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5444edc8c0>]}
[0m14:51:06.979365 [info ] [MainThread]: 
[0m14:51:06.981670 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:51:06.983233 [info ] [MainThread]: 
[0m14:51:06.985126 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:51:06.988474 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m14:51:07.144261 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m14:51:07.146650 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m14:51:07.147887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:07.216984 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.069 seconds
[0m14:51:07.219707 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m14:51:07.229521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_silver)
[0m14:51:07.230634 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_gold'
[0m14:51:07.239956 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m14:51:07.243270 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m14:51:07.244574 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m14:51:07.245870 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m14:51:07.246996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:07.247963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:07.259407 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m14:51:07.260152 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m14:51:07.261303 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m14:51:07.262567 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m14:51:07.263826 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m14:51:07.264911 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m14:51:07.289840 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.024 seconds
[0m14:51:07.290606 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.024 seconds
[0m14:51:07.293466 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m14:51:07.296608 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m14:51:07.298618 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m14:51:07.299976 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m14:51:07.313863 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:07.315468 [debug] [MainThread]: On master: BEGIN
[0m14:51:07.316805 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:07.326859 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m14:51:07.328492 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:07.329910 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:51:07.347603 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m14:51:07.350354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '881d4aa8-bfcd-4433-ace8-f51d774a3cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5444d0b3e0>]}
[0m14:51:07.351685 [debug] [MainThread]: On master: ROLLBACK
[0m14:51:07.353181 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:07.354370 [debug] [MainThread]: On master: BEGIN
[0m14:51:07.356579 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:51:07.358094 [debug] [MainThread]: On master: COMMIT
[0m14:51:07.359087 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:07.360156 [debug] [MainThread]: On master: COMMIT
[0m14:51:07.361828 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:51:07.363178 [debug] [MainThread]: On master: Close
[0m14:51:07.372421 [debug] [Thread-1 (]: Began running node model.clinical_trials.slv-processed_trials
[0m14:51:07.376494 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.slv-processed_trials ....................... [RUN]
[0m14:51:07.378614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver, now model.clinical_trials.slv-processed_trials)
[0m14:51:07.380818 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.slv-processed_trials
[0m14:51:07.393155 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.slv-processed_trials"
[0m14:51:07.407873 [debug] [Thread-1 (]: Began executing node model.clinical_trials.slv-processed_trials
[0m14:51:07.456878 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.slv-processed_trials"
[0m14:51:07.469939 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv-processed_trials"
[0m14:51:07.471284 [debug] [Thread-1 (]: On model.clinical_trials.slv-processed_trials: BEGIN
[0m14:51:07.472532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:07.480945 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:51:07.482585 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv-processed_trials"
[0m14:51:07.484068 [debug] [Thread-1 (]: On model.clinical_trials.slv-processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv-processed_trials"} */

  
    

  create  table "clinical_trials"."silver"."slv-processed_trials__dbt_tmp"
  
  
    as
  
  (
    

with src as (
  select
    nct_id,
    brief_title,
    study_type,
    case
      when coalesce(upper(study_type), '') = 'OBSERVATIONAL' then 'NOT APPLICABLE'
      when phase is null then null
      else upper(phase)
    end as phase,
    overall_status,
    start_date      as start_date_raw,
    completion_date as completion_date_raw
  from "clinical_trials"."bronze"."raw_trials"
),

-- 1) Homogenize placeholders -> NULL
nulls as (
  select
    nct_id,
    nullif(trim(brief_title),      '')              as brief_title,
    nullif(trim(study_type),       '')              as study_type,
    nullif(trim(phase),            '')              as phase,
    nullif(trim(overall_status),   '')              as status,
    nullif(trim(start_date_raw),       '')          as start_date_raw,
    nullif(trim(completion_date_raw),  '')          as completion_date_raw
  from src
),

-- Treat common placeholders (‘NA’, ‘N/A’, ‘UNKNOWN’, ‘NULL’ the *string*) as NULL
placeholders as (
  select
    nct_id,
    case when upper(brief_title)    in ('NA','N/A','UNKNOWN','NULL') then null else brief_title end    as brief_title,
    case when upper(study_type)     in ('NA','N/A','UNKNOWN','NULL') then null else study_type  end    as study_type,
    case when upper(phase)       in ('NA','N/A','UNKNOWN','NULL') then null else phase    end    as phase,
    case when upper(status)      in ('NA','N/A','UNKNOWN','NULL') then null else status   end    as status,
    case when upper(start_date_raw)     in ('NA','N/A','UNKNOWN','NULL') then null else start_date_raw  end    as start_date_raw,
    case when upper(completion_date_raw)in ('NA','N/A','UNKNOWN','NULL') then null else completion_date_raw end as completion_date_raw
  from nulls
),

-- 2) Parse partial dates (YYYY, YYYY-MM, YYYY-MM-DD) -> DATE
dates as (
  select
    nct_id,
    brief_title,
    study_type,
    status,
    phase,

    case
      when start_date_raw ~ '^\d{4}-\d{2}-\d{2}$' then to_date(start_date_raw,'YYYY-MM-DD')
      when start_date_raw ~ '^\d{4}-\d{2}$'       then to_date(start_date_raw||'-01','YYYY-MM-DD')
      when start_date_raw ~ '^\d{4}$'             then to_date(start_date_raw||'-01-01','YYYY-MM-DD')
      else null
    end as start_date,

    case
      when completion_date_raw ~ '^\d{4}-\d{2}-\d{2}$' then to_date(completion_date_raw,'YYYY-MM-DD')
      when completion_date_raw ~ '^\d{4}-\d{2}$'       then to_date(completion_date_raw||'-01','YYYY-MM-DD')
      when completion_date_raw ~ '^\d{4}$'             then to_date(completion_date_raw||'-01-01','YYYY-MM-DD')
      else null
    end as completion_date
  from placeholders
)

select 
    nct_id,
    brief_title,
    study_type,
    status,
    phase,
    start_date,
    completion_date
from dates
  );
  
[0m14:51:07.564138 [debug] [Thread-1 (]: SQL status: SELECT 1100 in 0.078 seconds
[0m14:51:07.577010 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv-processed_trials"
[0m14:51:07.579141 [debug] [Thread-1 (]: On model.clinical_trials.slv-processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv-processed_trials"} */
alter table "clinical_trials"."silver"."slv-processed_trials__dbt_tmp" rename to "slv-processed_trials"
[0m14:51:07.583349 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:51:07.606501 [debug] [Thread-1 (]: On model.clinical_trials.slv-processed_trials: COMMIT
[0m14:51:07.608451 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv-processed_trials"
[0m14:51:07.609856 [debug] [Thread-1 (]: On model.clinical_trials.slv-processed_trials: COMMIT
[0m14:51:07.617409 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m14:51:07.629320 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."slv-processed_trials__dbt_backup"
[0m14:51:07.641597 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv-processed_trials"
[0m14:51:07.643820 [debug] [Thread-1 (]: On model.clinical_trials.slv-processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv-processed_trials"} */
drop table if exists "clinical_trials"."silver"."slv-processed_trials__dbt_backup" cascade
[0m14:51:07.647076 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:51:07.651007 [debug] [Thread-1 (]: On model.clinical_trials.slv-processed_trials: Close
[0m14:51:07.654626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '881d4aa8-bfcd-4433-ace8-f51d774a3cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54488de720>]}
[0m14:51:07.656344 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.slv-processed_trials .................. [[32mSELECT 1100[0m in 0.27s]
[0m14:51:07.658112 [debug] [Thread-1 (]: Finished running node model.clinical_trials.slv-processed_trials
[0m14:51:07.661671 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:07.662920 [debug] [MainThread]: On master: BEGIN
[0m14:51:07.663889 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:51:07.671942 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:51:07.673553 [debug] [MainThread]: On master: COMMIT
[0m14:51:07.675304 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:07.677125 [debug] [MainThread]: On master: COMMIT
[0m14:51:07.679247 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:07.681497 [debug] [MainThread]: On master: Close
[0m14:51:07.683259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:07.684670 [debug] [MainThread]: Connection 'model.clinical_trials.slv-processed_trials' was properly closed.
[0m14:51:07.686421 [debug] [MainThread]: Connection 'list_clinical_trials_gold' was properly closed.
[0m14:51:07.688304 [info ] [MainThread]: 
[0m14:51:07.689782 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m14:51:07.691932 [debug] [MainThread]: Command end result
[0m14:51:07.751630 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:51:07.761072 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:51:07.778437 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:51:07.780311 [info ] [MainThread]: 
[0m14:51:07.782903 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:07.784935 [info ] [MainThread]: 
[0m14:51:07.787531 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:51:07.792113 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5980923, "process_in_blocks": "0", "process_kernel_time": 2.097853, "process_mem_max_rss": "115256", "process_out_blocks": "1600", "process_user_time": 4.395502}
[0m14:51:07.794849 [debug] [MainThread]: Command `dbt run` succeeded at 14:51:07.794494 after 2.60 seconds
[0m14:51:07.797001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5446f7a0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5444cba4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5444cb8b90>]}
[0m14:51:07.799238 [debug] [MainThread]: Flushing usage events
[0m14:51:08.388010 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:51:21.774863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a7e735f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a8c90c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a7f2c500>]}


============================== 14:51:21.785774 | 877705f8-7b0e-4164-bc4a-caae79d22b3b ==============================
[0m14:51:21.785774 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:51:21.787395 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select silver.slv-interventions', 'send_anonymous_usage_stats': 'True'}
[0m14:51:22.050182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '877705f8-7b0e-4164-bc4a-caae79d22b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a79a9ca0>]}
[0m14:51:22.123385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '877705f8-7b0e-4164-bc4a-caae79d22b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a78e8860>]}
[0m14:51:22.125479 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:51:22.214526 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:51:22.542012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:51:22.543489 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:51:22.585210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '877705f8-7b0e-4164-bc4a-caae79d22b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a6075610>]}
[0m14:51:22.703535 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:51:22.712461 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:51:22.758066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '877705f8-7b0e-4164-bc4a-caae79d22b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a605b290>]}
[0m14:51:22.759740 [info ] [MainThread]: Found 8 models, 1 source, 430 macros
[0m14:51:22.761259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '877705f8-7b0e-4164-bc4a-caae79d22b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a8c8bb90>]}
[0m14:51:22.764384 [info ] [MainThread]: 
[0m14:51:22.766096 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:51:22.768109 [info ] [MainThread]: 
[0m14:51:22.770463 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:51:22.773467 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m14:51:22.853190 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m14:51:22.855115 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m14:51:22.856840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:22.869877 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.013 seconds
[0m14:51:22.873454 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m14:51:22.883216 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_silver)
[0m14:51:22.884359 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_gold'
[0m14:51:22.892689 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m14:51:22.895929 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m14:51:22.897372 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m14:51:22.898391 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m14:51:22.899560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:22.901321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:22.911193 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m14:51:22.911851 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m14:51:22.913043 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m14:51:22.914397 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m14:51:22.915627 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m14:51:22.916903 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m14:51:22.923211 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m14:51:22.923934 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m14:51:22.926879 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m14:51:22.930614 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m14:51:22.932369 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m14:51:22.933826 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m14:51:22.944628 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:22.946877 [debug] [MainThread]: On master: BEGIN
[0m14:51:22.948494 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:22.960735 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m14:51:22.962713 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:22.964398 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:51:22.971423 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m14:51:22.974295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '877705f8-7b0e-4164-bc4a-caae79d22b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a5d5aa80>]}
[0m14:51:22.975865 [debug] [MainThread]: On master: ROLLBACK
[0m14:51:22.977342 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:22.978656 [debug] [MainThread]: On master: BEGIN
[0m14:51:22.980364 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:51:22.981846 [debug] [MainThread]: On master: COMMIT
[0m14:51:22.982919 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:22.984234 [debug] [MainThread]: On master: COMMIT
[0m14:51:22.985887 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:22.987141 [debug] [MainThread]: On master: Close
[0m14:51:22.994791 [debug] [Thread-1 (]: Began running node model.clinical_trials.slv-interventions
[0m14:51:22.996332 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.slv-interventions .......................... [RUN]
[0m14:51:22.997951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_gold, now model.clinical_trials.slv-interventions)
[0m14:51:22.999313 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.slv-interventions
[0m14:51:23.008998 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.slv-interventions"
[0m14:51:23.020443 [debug] [Thread-1 (]: Began executing node model.clinical_trials.slv-interventions
[0m14:51:23.072873 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.slv-interventions"
[0m14:51:23.084233 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv-interventions"
[0m14:51:23.086415 [debug] [Thread-1 (]: On model.clinical_trials.slv-interventions: BEGIN
[0m14:51:23.087850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:23.098757 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m14:51:23.100474 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv-interventions"
[0m14:51:23.101786 [debug] [Thread-1 (]: On model.clinical_trials.slv-interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv-interventions"} */

  
    

  create  table "clinical_trials"."silver"."slv-interventions__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  p.nct_id,
  nullif(trim(x), '') as intervention
from "clinical_trials"."bronze"."raw_trials" p,
lateral regexp_split_to_table(p.interventions, '\s*[;,]\s*') as x
where p.interventions is not null and p.interventions <> ''
  and nullif(trim(x), '') is not null
  );
  
[0m14:51:23.445266 [debug] [Thread-1 (]: SQL status: SELECT 1928 in 0.342 seconds
[0m14:51:23.455434 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv-interventions"
[0m14:51:23.457541 [debug] [Thread-1 (]: On model.clinical_trials.slv-interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv-interventions"} */
alter table "clinical_trials"."silver"."slv-interventions__dbt_tmp" rename to "slv-interventions"
[0m14:51:23.460557 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:23.486420 [debug] [Thread-1 (]: On model.clinical_trials.slv-interventions: COMMIT
[0m14:51:23.488462 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv-interventions"
[0m14:51:23.490265 [debug] [Thread-1 (]: On model.clinical_trials.slv-interventions: COMMIT
[0m14:51:23.493784 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:51:23.503649 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."slv-interventions__dbt_backup"
[0m14:51:23.511443 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv-interventions"
[0m14:51:23.513677 [debug] [Thread-1 (]: On model.clinical_trials.slv-interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv-interventions"} */
drop table if exists "clinical_trials"."silver"."slv-interventions__dbt_backup" cascade
[0m14:51:23.515972 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:51:23.520426 [debug] [Thread-1 (]: On model.clinical_trials.slv-interventions: Close
[0m14:51:23.524490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '877705f8-7b0e-4164-bc4a-caae79d22b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a9836d20>]}
[0m14:51:23.526487 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.slv-interventions ..................... [[32mSELECT 1928[0m in 0.52s]
[0m14:51:23.528361 [debug] [Thread-1 (]: Finished running node model.clinical_trials.slv-interventions
[0m14:51:23.533516 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:23.535472 [debug] [MainThread]: On master: BEGIN
[0m14:51:23.537146 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:51:23.547222 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m14:51:23.549027 [debug] [MainThread]: On master: COMMIT
[0m14:51:23.550527 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:23.553015 [debug] [MainThread]: On master: COMMIT
[0m14:51:23.555042 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:23.556286 [debug] [MainThread]: On master: Close
[0m14:51:23.557640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:23.558844 [debug] [MainThread]: Connection 'list_clinical_trials_silver' was properly closed.
[0m14:51:23.560158 [debug] [MainThread]: Connection 'model.clinical_trials.slv-interventions' was properly closed.
[0m14:51:23.561753 [info ] [MainThread]: 
[0m14:51:23.563635 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m14:51:23.566045 [debug] [MainThread]: Command end result
[0m14:51:23.623743 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:51:23.632959 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:51:23.648533 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:51:23.650522 [info ] [MainThread]: 
[0m14:51:23.653999 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:23.656700 [info ] [MainThread]: 
[0m14:51:23.658840 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:51:23.662415 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9703784, "process_in_blocks": "0", "process_kernel_time": 0.558377, "process_mem_max_rss": "110056", "process_out_blocks": "1600", "process_user_time": 3.430033}
[0m14:51:23.664688 [debug] [MainThread]: Command `dbt run` succeeded at 14:51:23.664339 after 1.97 seconds
[0m14:51:23.666613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a7ca7c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a7938890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a5e01220>]}
[0m14:51:23.669394 [debug] [MainThread]: Flushing usage events
[0m14:51:24.144028 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:51:34.180691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd190ea2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd190cb2810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd191304bf0>]}


============================== 14:51:34.195559 | cb2a8f30-442c-4df8-9a74-a7bc039a7cf1 ==============================
[0m14:51:34.195559 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:51:34.197397 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select silver.slv-countries', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:51:34.477379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb2a8f30-442c-4df8-9a74-a7bc039a7cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd19142efc0>]}
[0m14:51:34.549761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb2a8f30-442c-4df8-9a74-a7bc039a7cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18f000c50>]}
[0m14:51:34.551717 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:51:34.649087 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:51:34.973527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:51:34.974920 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:51:35.024486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb2a8f30-442c-4df8-9a74-a7bc039a7cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18f0ab050>]}
[0m14:51:35.139067 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:51:35.146822 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:51:35.203048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb2a8f30-442c-4df8-9a74-a7bc039a7cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18ee3caa0>]}
[0m14:51:35.204511 [info ] [MainThread]: Found 8 models, 1 source, 430 macros
[0m14:51:35.205950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb2a8f30-442c-4df8-9a74-a7bc039a7cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18edf13d0>]}
[0m14:51:35.208904 [info ] [MainThread]: 
[0m14:51:35.210962 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:51:35.213027 [info ] [MainThread]: 
[0m14:51:35.215622 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:51:35.218345 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m14:51:35.293704 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m14:51:35.295334 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m14:51:35.296331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:35.308029 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.012 seconds
[0m14:51:35.310658 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m14:51:35.318046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_silver)
[0m14:51:35.319235 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_gold'
[0m14:51:35.327361 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m14:51:35.331130 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m14:51:35.332372 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m14:51:35.334086 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m14:51:35.335409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:35.336837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:35.345633 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m14:51:35.346813 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m14:51:35.348094 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m14:51:35.348683 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m14:51:35.350336 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m14:51:35.351300 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m14:51:35.354357 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m14:51:35.355233 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m14:51:35.358116 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m14:51:35.361139 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m14:51:35.362695 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m14:51:35.363774 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m14:51:35.375390 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:35.377529 [debug] [MainThread]: On master: BEGIN
[0m14:51:35.378999 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:35.391723 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m14:51:35.393495 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:35.395141 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:51:35.405472 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m14:51:35.408648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb2a8f30-442c-4df8-9a74-a7bc039a7cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18edb9250>]}
[0m14:51:35.410429 [debug] [MainThread]: On master: ROLLBACK
[0m14:51:35.412210 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:35.413392 [debug] [MainThread]: On master: BEGIN
[0m14:51:35.415020 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:51:35.416376 [debug] [MainThread]: On master: COMMIT
[0m14:51:35.417650 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:35.418770 [debug] [MainThread]: On master: COMMIT
[0m14:51:35.420170 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:35.421561 [debug] [MainThread]: On master: Close
[0m14:51:35.427990 [debug] [Thread-1 (]: Began running node model.clinical_trials.slv-countries
[0m14:51:35.429552 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.slv-countries .............................. [RUN]
[0m14:51:35.431196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_gold, now model.clinical_trials.slv-countries)
[0m14:51:35.432555 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.slv-countries
[0m14:51:35.444784 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.slv-countries"
[0m14:51:35.457565 [debug] [Thread-1 (]: Began executing node model.clinical_trials.slv-countries
[0m14:51:35.520339 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.slv-countries"
[0m14:51:35.532059 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv-countries"
[0m14:51:35.534174 [debug] [Thread-1 (]: On model.clinical_trials.slv-countries: BEGIN
[0m14:51:35.535864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:35.545945 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m14:51:35.547812 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv-countries"
[0m14:51:35.549183 [debug] [Thread-1 (]: On model.clinical_trials.slv-countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv-countries"} */

  
    

  create  table "clinical_trials"."silver"."slv-countries__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  p.nct_id,
  nullif(trim(x), '') as country
from "clinical_trials"."bronze"."raw_trials" p,
lateral regexp_split_to_table(p.countries, '\s*[;,]\s*') as x
where p.countries is not null and p.countries <> ''
  and nullif(trim(x), '') is not null
  );
  
[0m14:51:35.605491 [debug] [Thread-1 (]: SQL status: SELECT 1557 in 0.055 seconds
[0m14:51:35.618546 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv-countries"
[0m14:51:35.620511 [debug] [Thread-1 (]: On model.clinical_trials.slv-countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv-countries"} */
alter table "clinical_trials"."silver"."slv-countries__dbt_tmp" rename to "slv-countries"
[0m14:51:35.623038 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:35.654882 [debug] [Thread-1 (]: On model.clinical_trials.slv-countries: COMMIT
[0m14:51:35.656641 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv-countries"
[0m14:51:35.658227 [debug] [Thread-1 (]: On model.clinical_trials.slv-countries: COMMIT
[0m14:51:35.662144 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:51:35.674723 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."slv-countries__dbt_backup"
[0m14:51:35.689160 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv-countries"
[0m14:51:35.692095 [debug] [Thread-1 (]: On model.clinical_trials.slv-countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv-countries"} */
drop table if exists "clinical_trials"."silver"."slv-countries__dbt_backup" cascade
[0m14:51:35.695220 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:51:35.701403 [debug] [Thread-1 (]: On model.clinical_trials.slv-countries: Close
[0m14:51:35.706949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb2a8f30-442c-4df8-9a74-a7bc039a7cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd19283a900>]}
[0m14:51:35.708935 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.slv-countries ......................... [[32mSELECT 1557[0m in 0.27s]
[0m14:51:35.711442 [debug] [Thread-1 (]: Finished running node model.clinical_trials.slv-countries
[0m14:51:35.716046 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:35.717922 [debug] [MainThread]: On master: BEGIN
[0m14:51:35.719411 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:51:35.729564 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m14:51:35.731503 [debug] [MainThread]: On master: COMMIT
[0m14:51:35.733120 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:35.734830 [debug] [MainThread]: On master: COMMIT
[0m14:51:35.737154 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:35.738740 [debug] [MainThread]: On master: Close
[0m14:51:35.740277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:35.741508 [debug] [MainThread]: Connection 'list_clinical_trials_silver' was properly closed.
[0m14:51:35.742586 [debug] [MainThread]: Connection 'model.clinical_trials.slv-countries' was properly closed.
[0m14:51:35.744131 [info ] [MainThread]: 
[0m14:51:35.745894 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m14:51:35.748878 [debug] [MainThread]: Command end result
[0m14:51:35.807251 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:51:35.816345 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:51:35.832994 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:51:35.835022 [info ] [MainThread]: 
[0m14:51:35.837356 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:35.839926 [info ] [MainThread]: 
[0m14:51:35.842144 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:51:35.845491 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7483727, "process_in_blocks": "0", "process_kernel_time": 0.515929, "process_mem_max_rss": "110112", "process_out_blocks": "1600", "process_user_time": 3.125926}
[0m14:51:35.847587 [debug] [MainThread]: Command `dbt run` succeeded at 14:51:35.847365 after 1.75 seconds
[0m14:51:35.849094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd190ae9eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd190d66ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd191093800>]}
[0m14:51:35.850586 [debug] [MainThread]: Flushing usage events
[0m14:51:36.322967 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:51:49.548678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff57357050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff56aa3230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff57357230>]}


============================== 14:51:49.559023 | a741f78d-881e-479a-a000-ad067231600c ==============================
[0m14:51:49.559023 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:51:49.560944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select silver.slv-conditions', 'send_anonymous_usage_stats': 'True'}
[0m14:51:49.850264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a741f78d-881e-479a-a000-ad067231600c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff56a35730>]}
[0m14:51:49.932222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a741f78d-881e-479a-a000-ad067231600c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff58417c20>]}
[0m14:51:49.934653 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:51:50.084131 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:51:50.593943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:51:50.595860 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:51:50.689637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a741f78d-881e-479a-a000-ad067231600c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff54d5fda0>]}
[0m14:51:50.855386 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:51:50.866830 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:51:50.918237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a741f78d-881e-479a-a000-ad067231600c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff54c74fb0>]}
[0m14:51:50.919935 [info ] [MainThread]: Found 8 models, 1 source, 430 macros
[0m14:51:50.921549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a741f78d-881e-479a-a000-ad067231600c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff54cd7170>]}
[0m14:51:50.924793 [info ] [MainThread]: 
[0m14:51:50.926593 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:51:50.928276 [info ] [MainThread]: 
[0m14:51:50.930996 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:51:50.934487 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m14:51:51.025019 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m14:51:51.027034 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m14:51:51.028403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:51.045269 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.017 seconds
[0m14:51:51.049306 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m14:51:51.058254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_gold)
[0m14:51:51.060597 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_silver'
[0m14:51:51.069730 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m14:51:51.073023 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m14:51:51.074435 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m14:51:51.075957 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m14:51:51.077407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:51.078628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:51.088739 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m14:51:51.089371 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m14:51:51.090670 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m14:51:51.092157 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m14:51:51.093697 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m14:51:51.095453 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m14:51:51.101261 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m14:51:51.102936 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.005 seconds
[0m14:51:51.105764 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m14:51:51.109354 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m14:51:51.111257 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m14:51:51.112491 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m14:51:51.125122 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:51.127170 [debug] [MainThread]: On master: BEGIN
[0m14:51:51.128550 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:51.137585 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:51:51.139092 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:51.140589 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:51:51.149242 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m14:51:51.152417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a741f78d-881e-479a-a000-ad067231600c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff57b97f80>]}
[0m14:51:51.154061 [debug] [MainThread]: On master: ROLLBACK
[0m14:51:51.155522 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:51.157037 [debug] [MainThread]: On master: BEGIN
[0m14:51:51.158961 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:51:51.160261 [debug] [MainThread]: On master: COMMIT
[0m14:51:51.161414 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:51.162595 [debug] [MainThread]: On master: COMMIT
[0m14:51:51.164166 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:51.165718 [debug] [MainThread]: On master: Close
[0m14:51:51.171609 [debug] [Thread-1 (]: Began running node model.clinical_trials.slv-conditions
[0m14:51:51.174117 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.slv-conditions ............................. [RUN]
[0m14:51:51.176763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver, now model.clinical_trials.slv-conditions)
[0m14:51:51.178432 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.slv-conditions
[0m14:51:51.191252 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.slv-conditions"
[0m14:51:51.206193 [debug] [Thread-1 (]: Began executing node model.clinical_trials.slv-conditions
[0m14:51:51.264084 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.slv-conditions"
[0m14:51:51.276649 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv-conditions"
[0m14:51:51.278247 [debug] [Thread-1 (]: On model.clinical_trials.slv-conditions: BEGIN
[0m14:51:51.279771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:51.287732 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:51:51.289371 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv-conditions"
[0m14:51:51.290887 [debug] [Thread-1 (]: On model.clinical_trials.slv-conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv-conditions"} */

  
    

  create  table "clinical_trials"."silver"."slv-conditions__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  p.nct_id,
  nullif(trim(x), '') as condition
from "clinical_trials"."bronze"."raw_trials" p,
lateral regexp_split_to_table(p.conditions, '\s*[;,]\s*') as x
where p.conditions is not null and p.conditions <> ''
  and nullif(trim(x), '') is not null
  );
  
[0m14:51:51.360388 [debug] [Thread-1 (]: SQL status: SELECT 2168 in 0.068 seconds
[0m14:51:51.371037 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv-conditions"
[0m14:51:51.372818 [debug] [Thread-1 (]: On model.clinical_trials.slv-conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv-conditions"} */
alter table "clinical_trials"."silver"."slv-conditions__dbt_tmp" rename to "slv-conditions"
[0m14:51:51.375430 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:51.402664 [debug] [Thread-1 (]: On model.clinical_trials.slv-conditions: COMMIT
[0m14:51:51.404575 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv-conditions"
[0m14:51:51.406156 [debug] [Thread-1 (]: On model.clinical_trials.slv-conditions: COMMIT
[0m14:51:51.410547 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:51:51.419909 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."slv-conditions__dbt_backup"
[0m14:51:51.428198 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv-conditions"
[0m14:51:51.430141 [debug] [Thread-1 (]: On model.clinical_trials.slv-conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv-conditions"} */
drop table if exists "clinical_trials"."silver"."slv-conditions__dbt_backup" cascade
[0m14:51:51.432855 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:51:51.437833 [debug] [Thread-1 (]: On model.clinical_trials.slv-conditions: Close
[0m14:51:51.441495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a741f78d-881e-479a-a000-ad067231600c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff58762ab0>]}
[0m14:51:51.443670 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.slv-conditions ........................ [[32mSELECT 2168[0m in 0.26s]
[0m14:51:51.445925 [debug] [Thread-1 (]: Finished running node model.clinical_trials.slv-conditions
[0m14:51:51.450427 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:51.452130 [debug] [MainThread]: On master: BEGIN
[0m14:51:51.453753 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:51:51.463042 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:51:51.465163 [debug] [MainThread]: On master: COMMIT
[0m14:51:51.467105 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:51.469141 [debug] [MainThread]: On master: COMMIT
[0m14:51:51.471284 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:51.472657 [debug] [MainThread]: On master: Close
[0m14:51:51.474280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:51.475750 [debug] [MainThread]: Connection 'list_clinical_trials_gold' was properly closed.
[0m14:51:51.477219 [debug] [MainThread]: Connection 'model.clinical_trials.slv-conditions' was properly closed.
[0m14:51:51.478534 [info ] [MainThread]: 
[0m14:51:51.480290 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m14:51:51.482286 [debug] [MainThread]: Command end result
[0m14:51:51.538923 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:51:51.546954 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:51:51.561380 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:51:51.563244 [info ] [MainThread]: 
[0m14:51:51.565147 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:51.567490 [info ] [MainThread]: 
[0m14:51:51.569235 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:51:51.571883 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1104486, "process_in_blocks": "0", "process_kernel_time": 0.536729, "process_mem_max_rss": "108560", "process_out_blocks": "1600", "process_user_time": 3.230318}
[0m14:51:51.574159 [debug] [MainThread]: Command `dbt run` succeeded at 14:51:51.573762 after 2.11 seconds
[0m14:51:51.576137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff573544a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff577dde20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff4cd1ae70>]}
[0m14:51:51.578217 [debug] [MainThread]: Flushing usage events
[0m14:51:52.068428 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:55:30.246140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe8e1e1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe8dcda1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe8deae4b0>]}


============================== 14:55:30.269551 | aed79165-07bb-473b-92ff-14f452a42ab3 ==============================
[0m14:55:30.269551 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:55:30.273534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt seed --select country_centroids', 'send_anonymous_usage_stats': 'True'}
[0m14:55:30.928944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aed79165-07bb-473b-92ff-14f452a42ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe8f5eb9b0>]}
[0m14:55:31.087566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aed79165-07bb-473b-92ff-14f452a42ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe8deac440>]}
[0m14:55:31.095818 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:55:31.271472 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:55:31.911443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:55:31.913819 [debug] [MainThread]: Partial parsing: added file: clinical_trials://seeds/country_codes.csv
[0m14:55:32.362249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aed79165-07bb-473b-92ff-14f452a42ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe8ba8cb30>]}
[0m14:55:32.491496 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:55:32.500616 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:55:32.554594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aed79165-07bb-473b-92ff-14f452a42ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe8ba7f2f0>]}
[0m14:55:32.556211 [info ] [MainThread]: Found 8 models, 1 seed, 1 source, 430 macros
[0m14:55:32.557858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aed79165-07bb-473b-92ff-14f452a42ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe8d66a660>]}
[0m14:55:32.560152 [warn ] [MainThread]: The selection criterion 'country_centroids' does not match any enabled nodes
[0m14:55:32.563703 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:55:32.565895 [debug] [MainThread]: Command end result
[0m14:55:32.613758 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:55:32.620760 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:55:32.630592 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:55:32.631789 [info ] [MainThread]: 
[0m14:55:32.633134 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:55:32.634946 [info ] [MainThread]: 
[0m14:55:32.636584 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m14:55:32.639499 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 2.550605, "process_in_blocks": "0", "process_kernel_time": 0.524316, "process_mem_max_rss": "102704", "process_out_blocks": "1600", "process_user_time": 3.851707}
[0m14:55:32.641173 [debug] [MainThread]: Command `dbt seed` succeeded at 14:55:32.640957 after 2.55 seconds
[0m14:55:32.642685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe90e3aba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe8d8ecfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe8bbede80>]}
[0m14:55:32.644509 [debug] [MainThread]: Flushing usage events
[0m14:55:33.165051 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:03:46.886843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7fda7b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ff7c4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7fe1db530>]}


============================== 15:03:46.895881 | d6d45f94-e630-436a-b973-a512a2ae78fe ==============================
[0m15:03:46.895881 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:03:46.898163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select gold.gld-countries', 'send_anonymous_usage_stats': 'True'}
[0m15:03:47.127445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6d45f94-e630-436a-b973-a512a2ae78fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ff747740>]}
[0m15:03:47.205715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6d45f94-e630-436a-b973-a512a2ae78fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7fd8c11c0>]}
[0m15:03:47.207663 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:03:47.290125 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:03:47.579625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:03:47.580958 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/gold/gld-countries.sql
[0m15:03:47.810336 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.clinical_trials.gld-countries' (models/gold/gld-countries.sql) depends on a node named 'trials_countries' which was not found
[0m15:03:47.813107 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9970009, "process_in_blocks": "0", "process_kernel_time": 0.416261, "process_mem_max_rss": "99372", "process_out_blocks": "1488", "process_user_time": 2.229973}
[0m15:03:47.814476 [debug] [MainThread]: Command `dbt run` failed at 15:03:47.814296 after 1.00 seconds
[0m15:03:47.815411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7fda7b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7fbfec350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7fd855df0>]}
[0m15:03:47.816423 [debug] [MainThread]: Flushing usage events
[0m15:03:48.290733 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:05:46.342358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ed939190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ee6123c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75edd3f5c0>]}


============================== 15:05:46.354295 | c34e22ad-afad-4b44-989b-0573dc2f264e ==============================
[0m15:05:46.354295 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:05:46.356507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select gold.gld-countries', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:05:46.620535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c34e22ad-afad-4b44-989b-0573dc2f264e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ef6336b0>]}
[0m15:05:46.691420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c34e22ad-afad-4b44-989b-0573dc2f264e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ebdfc4a0>]}
[0m15:05:46.693421 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:05:46.782761 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:05:47.198622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:05:47.200271 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/gold/gld-countries.sql
[0m15:05:47.466147 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.clinical_trials.gld-countries' (models/gold/gld-countries.sql) depends on a node named 'trials_countries' which was not found
[0m15:05:47.468990 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2005767, "process_in_blocks": "0", "process_kernel_time": 0.45666, "process_mem_max_rss": "99544", "process_out_blocks": "1488", "process_user_time": 2.700251}
[0m15:05:47.470762 [debug] [MainThread]: Command `dbt run` failed at 15:05:47.470571 after 1.20 seconds
[0m15:05:47.472375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ee6123c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ef4e4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ebed4fe0>]}
[0m15:05:47.473463 [debug] [MainThread]: Flushing usage events
[0m15:05:47.951511 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:10:22.173450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefe02c8aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefe03d86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefe0ce27b0>]}


============================== 15:10:22.185581 | a9537c5c-3885-4454-b2aa-d1eb89ef5194 ==============================
[0m15:10:22.185581 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:10:22.187891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select gold.gld-countries', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:10:22.476590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9537c5c-3885-4454-b2aa-d1eb89ef5194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefe1f4f410>]}
[0m15:10:22.554356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9537c5c-3885-4454-b2aa-d1eb89ef5194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefe00f4a70>]}
[0m15:10:22.556926 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:10:22.648256 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:10:23.041067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:10:23.042740 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/gold/gld-countries.sql
[0m15:10:23.385858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9537c5c-3885-4454-b2aa-d1eb89ef5194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefde3f1d00>]}
[0m15:10:23.502119 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:10:23.513290 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:10:23.568247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9537c5c-3885-4454-b2aa-d1eb89ef5194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefde6f19a0>]}
[0m15:10:23.570219 [info ] [MainThread]: Found 8 models, 1 seed, 1 source, 430 macros
[0m15:10:23.572298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9537c5c-3885-4454-b2aa-d1eb89ef5194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdc802510>]}
[0m15:10:23.575651 [info ] [MainThread]: 
[0m15:10:23.578285 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:10:23.580149 [info ] [MainThread]: 
[0m15:10:23.582604 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:10:23.586943 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m15:10:23.668683 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m15:10:23.670281 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m15:10:23.671786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:23.692739 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.021 seconds
[0m15:10:23.695582 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m15:10:23.703546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_silver)
[0m15:10:23.704988 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_gold'
[0m15:10:23.712881 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:10:23.716651 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:10:23.718532 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m15:10:23.719909 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m15:10:23.721035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:23.722057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:23.732013 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m15:10:23.732562 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m15:10:23.733699 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:10:23.734729 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:10:23.735979 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m15:10:23.737303 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m15:10:23.745617 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.007 seconds
[0m15:10:23.746184 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m15:10:23.748633 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m15:10:23.750703 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m15:10:23.752175 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m15:10:23.753251 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m15:10:23.765216 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:23.766804 [debug] [MainThread]: On master: BEGIN
[0m15:10:23.768177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:10:23.776451 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:10:23.778240 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:23.779515 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:10:23.788328 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m15:10:23.790997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9537c5c-3885-4454-b2aa-d1eb89ef5194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefe05dc7d0>]}
[0m15:10:23.792311 [debug] [MainThread]: On master: ROLLBACK
[0m15:10:23.793588 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:23.794988 [debug] [MainThread]: On master: BEGIN
[0m15:10:23.797253 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:10:23.798498 [debug] [MainThread]: On master: COMMIT
[0m15:10:23.799710 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:23.800892 [debug] [MainThread]: On master: COMMIT
[0m15:10:23.802306 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:10:23.803433 [debug] [MainThread]: On master: Close
[0m15:10:23.807918 [debug] [Thread-1 (]: Began running node model.clinical_trials.gld-countries
[0m15:10:23.809587 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.gld-countries ................................ [RUN]
[0m15:10:23.811347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_gold, now model.clinical_trials.gld-countries)
[0m15:10:23.812786 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.gld-countries
[0m15:10:23.823859 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.gld-countries"
[0m15:10:23.841856 [debug] [Thread-1 (]: Began executing node model.clinical_trials.gld-countries
[0m15:10:23.891001 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.gld-countries"
[0m15:10:23.909262 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld-countries"
[0m15:10:23.910848 [debug] [Thread-1 (]: On model.clinical_trials.gld-countries: BEGIN
[0m15:10:23.912149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:23.921468 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:10:23.922908 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld-countries"
[0m15:10:23.924133 [debug] [Thread-1 (]: On model.clinical_trials.gld-countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld-countries"} */

  
    

  create  table "clinical_trials"."gold"."gld-countries__dbt_tmp"
  
  
    as
  
  (
    

select
  tc.nct_id,
  tc.country,
  cc.latitude,
  cc.longitude
from "clinical_trials"."silver"."slv-countries" tc
left join "clinical_trials"."silver"."country_codes" cc
  on lower(cc.country) = lower(tc.country)
  );
  
[0m15:10:23.927925 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "silver.country_codes" does not exist
LINE 20: left join "clinical_trials"."silver"."country_codes" cc
                   ^

[0m15:10:23.929681 [debug] [Thread-1 (]: On model.clinical_trials.gld-countries: ROLLBACK
[0m15:10:23.931241 [debug] [Thread-1 (]: On model.clinical_trials.gld-countries: Close
[0m15:10:23.940040 [debug] [Thread-1 (]: Database Error in model gld-countries (models/gold/gld-countries.sql)
  relation "silver.country_codes" does not exist
  LINE 20: left join "clinical_trials"."silver"."country_codes" cc
                     ^
  compiled code at target/run/clinical_trials/models/gold/gld-countries.sql
[0m15:10:23.943067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9537c5c-3885-4454-b2aa-d1eb89ef5194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefe0b06ff0>]}
[0m15:10:23.944633 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model gold.gld-countries ....................... [[31mERROR[0m in 0.13s]
[0m15:10:23.946245 [debug] [Thread-1 (]: Finished running node model.clinical_trials.gld-countries
[0m15:10:23.948436 [debug] [Thread-7 (]: Marking all children of 'model.clinical_trials.gld-countries' to be skipped because of status 'error'.  Reason: Database Error in model gld-countries (models/gold/gld-countries.sql)
  relation "silver.country_codes" does not exist
  LINE 20: left join "clinical_trials"."silver"."country_codes" cc
                     ^
  compiled code at target/run/clinical_trials/models/gold/gld-countries.sql.
[0m15:10:23.953384 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:23.954907 [debug] [MainThread]: On master: BEGIN
[0m15:10:23.956412 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:10:23.965564 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m15:10:23.967732 [debug] [MainThread]: On master: COMMIT
[0m15:10:23.969168 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:23.970654 [debug] [MainThread]: On master: COMMIT
[0m15:10:23.972380 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:10:23.973845 [debug] [MainThread]: On master: Close
[0m15:10:23.975837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:23.977584 [debug] [MainThread]: Connection 'list_clinical_trials_silver' was properly closed.
[0m15:10:23.979386 [debug] [MainThread]: Connection 'model.clinical_trials.gld-countries' was properly closed.
[0m15:10:23.981625 [info ] [MainThread]: 
[0m15:10:23.983907 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m15:10:23.986896 [debug] [MainThread]: Command end result
[0m15:10:24.042367 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:10:24.050698 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:10:24.064225 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:10:24.065863 [info ] [MainThread]: 
[0m15:10:24.067546 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:10:24.069119 [info ] [MainThread]: 
[0m15:10:24.070552 [error] [MainThread]:   Database Error in model gld-countries (models/gold/gld-countries.sql)
  relation "silver.country_codes" does not exist
  LINE 20: left join "clinical_trials"."silver"."country_codes" cc
                     ^
  compiled code at target/run/clinical_trials/models/gold/gld-countries.sql
[0m15:10:24.072408 [info ] [MainThread]: 
[0m15:10:24.073888 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:10:24.076265 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9934074, "process_in_blocks": "0", "process_kernel_time": 0.752474, "process_mem_max_rss": "112080", "process_out_blocks": "1600", "process_user_time": 3.495044}
[0m15:10:24.078171 [debug] [MainThread]: Command `dbt run` failed at 15:10:24.077853 after 2.00 seconds
[0m15:10:24.079744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefe0282360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefe06faa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefe0576e70>]}
[0m15:10:24.081711 [debug] [MainThread]: Flushing usage events
[0m15:10:24.617012 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:16:44.880099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9cf80d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9d01b4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9cf80d220>]}


============================== 15:16:44.890121 | 5a22e367-bdaa-4a56-b4fc-3bd80a34ce00 ==============================
[0m15:16:44.890121 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:16:44.892339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed --select country_codes', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:16:45.171341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a22e367-bdaa-4a56-b4fc-3bd80a34ce00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9ced12ff0>]}
[0m15:16:45.249675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a22e367-bdaa-4a56-b4fc-3bd80a34ce00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9d0a4c2c0>]}
[0m15:16:45.252105 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:16:45.364358 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:16:45.506006 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:16:45.507733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5a22e367-bdaa-4a56-b4fc-3bd80a34ce00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9cf228530>]}
[0m15:16:47.059253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a22e367-bdaa-4a56-b4fc-3bd80a34ce00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9cc1285f0>]}
[0m15:16:47.255676 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:16:47.265497 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:16:47.312751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a22e367-bdaa-4a56-b4fc-3bd80a34ce00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9cc12b9b0>]}
[0m15:16:47.314393 [info ] [MainThread]: Found 8 models, 1 seed, 1 source, 430 macros
[0m15:16:47.316197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a22e367-bdaa-4a56-b4fc-3bd80a34ce00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9cf558f80>]}
[0m15:16:47.320334 [info ] [MainThread]: 
[0m15:16:47.322373 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:16:47.324043 [info ] [MainThread]: 
[0m15:16:47.326125 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:16:47.328306 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m15:16:47.421494 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m15:16:47.422953 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m15:16:47.424020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:47.436426 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.012 seconds
[0m15:16:47.439626 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m15:16:47.448966 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_silver)
[0m15:16:47.450000 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_gold'
[0m15:16:47.459896 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:16:47.464158 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:16:47.465834 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m15:16:47.467666 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m15:16:47.469225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:47.470435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:47.478722 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:16:47.479785 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m15:16:47.480852 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:16:47.481634 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:16:47.482601 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m15:16:47.483848 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m15:16:47.488460 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m15:16:47.489153 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m15:16:47.491210 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m15:16:47.493034 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m15:16:47.494317 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m15:16:47.495205 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m15:16:47.505191 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:47.506763 [debug] [MainThread]: On master: BEGIN
[0m15:16:47.507831 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:16:47.515187 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:16:47.516523 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:47.517821 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:16:47.525388 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m15:16:47.527610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a22e367-bdaa-4a56-b4fc-3bd80a34ce00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9cc1324e0>]}
[0m15:16:47.528791 [debug] [MainThread]: On master: ROLLBACK
[0m15:16:47.529806 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:47.530650 [debug] [MainThread]: On master: BEGIN
[0m15:16:47.531835 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:16:47.532842 [debug] [MainThread]: On master: COMMIT
[0m15:16:47.533784 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:47.534452 [debug] [MainThread]: On master: COMMIT
[0m15:16:47.535285 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:16:47.536004 [debug] [MainThread]: On master: Close
[0m15:16:47.541957 [debug] [Thread-1 (]: Began running node seed.clinical_trials.country_codes
[0m15:16:47.543330 [info ] [Thread-1 (]: 1 of 1 START seed file silver.country_codes .................................... [RUN]
[0m15:16:47.544771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_gold, now seed.clinical_trials.country_codes)
[0m15:16:47.545973 [debug] [Thread-1 (]: Began compiling node seed.clinical_trials.country_codes
[0m15:16:47.547423 [debug] [Thread-1 (]: Began executing node seed.clinical_trials.country_codes
[0m15:16:47.590914 [debug] [Thread-1 (]: Using postgres connection "seed.clinical_trials.country_codes"
[0m15:16:47.592362 [debug] [Thread-1 (]: On seed.clinical_trials.country_codes: BEGIN
[0m15:16:47.593542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:47.600698 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m15:16:47.601957 [debug] [Thread-1 (]: Using postgres connection "seed.clinical_trials.country_codes"
[0m15:16:47.603006 [debug] [Thread-1 (]: On seed.clinical_trials.country_codes: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "seed.clinical_trials.country_codes"} */

    create table "clinical_trials"."silver"."country_codes" ("country" text,"latitude" numeric,"longitude" numeric)
  
[0m15:16:47.617612 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.013 seconds
[0m15:16:47.664457 [debug] [Thread-1 (]: Using postgres connection "seed.clinical_trials.country_codes"
[0m15:16:47.666241 [debug] [Thread-1 (]: On seed.clinical_trials.country_codes: 
          insert into "clinical_trials"."silver"."country_codes" ("country", "latitude", "longitude") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m15:16:47.673107 [debug] [Thread-1 (]: SQL status: INSERT 0 88 in 0.005 seconds
[0m15:16:47.681387 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.clinical_trials.country_codes"
[0m15:16:47.712965 [debug] [Thread-1 (]: On seed.clinical_trials.country_codes: COMMIT
[0m15:16:47.714536 [debug] [Thread-1 (]: Using postgres connection "seed.clinical_trials.country_codes"
[0m15:16:47.715736 [debug] [Thread-1 (]: On seed.clinical_trials.country_codes: COMMIT
[0m15:16:47.719174 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:16:47.721962 [debug] [Thread-1 (]: On seed.clinical_trials.country_codes: Close
[0m15:16:47.724375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a22e367-bdaa-4a56-b4fc-3bd80a34ce00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9cf762db0>]}
[0m15:16:47.725794 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file silver.country_codes ................................ [[32mINSERT 88[0m in 0.18s]
[0m15:16:47.727425 [debug] [Thread-1 (]: Finished running node seed.clinical_trials.country_codes
[0m15:16:47.730904 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:47.732059 [debug] [MainThread]: On master: BEGIN
[0m15:16:47.733117 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:16:47.740717 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:16:47.742197 [debug] [MainThread]: On master: COMMIT
[0m15:16:47.743289 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:47.744448 [debug] [MainThread]: On master: COMMIT
[0m15:16:47.746282 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:16:47.747806 [debug] [MainThread]: On master: Close
[0m15:16:47.749398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:16:47.751478 [debug] [MainThread]: Connection 'list_clinical_trials_silver' was properly closed.
[0m15:16:47.752810 [debug] [MainThread]: Connection 'seed.clinical_trials.country_codes' was properly closed.
[0m15:16:47.753989 [info ] [MainThread]: 
[0m15:16:47.755374 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m15:16:47.757794 [debug] [MainThread]: Command end result
[0m15:16:47.807691 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:16:47.816378 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:16:47.829236 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:16:47.830800 [info ] [MainThread]: 
[0m15:16:47.832122 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:16:47.833711 [info ] [MainThread]: 
[0m15:16:47.835241 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:16:47.837675 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 3.0677648, "process_in_blocks": "0", "process_kernel_time": 0.669798, "process_mem_max_rss": "116616", "process_out_blocks": "1600", "process_user_time": 4.127143}
[0m15:16:47.839165 [debug] [MainThread]: Command `dbt seed` succeeded at 15:16:47.838967 after 3.07 seconds
[0m15:16:47.840251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9cf0d6660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9cef14860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9cf80e6c0>]}
[0m15:16:47.841675 [debug] [MainThread]: Flushing usage events
[0m15:16:48.365778 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:17:12.355357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9daae79d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9da902fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9da964c0b0>]}


============================== 15:17:12.364144 | 6f46f510-2650-42c5-b020-af5c57ab10a1 ==============================
[0m15:17:12.364144 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:17:12.365460 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select gold.gld-countries', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:17:12.630204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f46f510-2650-42c5-b020-af5c57ab10a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9da9072330>]}
[0m15:17:12.707510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f46f510-2650-42c5-b020-af5c57ab10a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9da94823c0>]}
[0m15:17:12.710300 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:17:12.800560 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:17:13.122406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:17:13.123772 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:17:13.178592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f46f510-2650-42c5-b020-af5c57ab10a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9da779e120>]}
[0m15:17:13.283162 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:17:13.291331 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:17:13.334097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f46f510-2650-42c5-b020-af5c57ab10a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9da760f050>]}
[0m15:17:13.336009 [info ] [MainThread]: Found 8 models, 1 seed, 1 source, 430 macros
[0m15:17:13.337338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f46f510-2650-42c5-b020-af5c57ab10a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9da77b5e50>]}
[0m15:17:13.340992 [info ] [MainThread]: 
[0m15:17:13.342620 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:17:13.344182 [info ] [MainThread]: 
[0m15:17:13.346375 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:17:13.348721 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m15:17:13.407672 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m15:17:13.409652 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m15:17:13.410883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:13.423930 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.013 seconds
[0m15:17:13.427078 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m15:17:13.434217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_gold)
[0m15:17:13.435035 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_silver'
[0m15:17:13.441796 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:17:13.444142 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:17:13.445072 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m15:17:13.445928 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m15:17:13.446942 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:13.447737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:13.455465 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m15:17:13.456432 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:17:13.457291 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:17:13.458248 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:17:13.459144 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m15:17:13.460239 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m15:17:13.464646 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.003 seconds
[0m15:17:13.465284 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m15:17:13.467772 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m15:17:13.469630 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m15:17:13.470836 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m15:17:13.471603 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m15:17:13.481354 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:13.482532 [debug] [MainThread]: On master: BEGIN
[0m15:17:13.483310 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:17:13.490391 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:17:13.491465 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:13.492309 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:17:13.497901 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m15:17:13.500025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f46f510-2650-42c5-b020-af5c57ab10a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9da667a540>]}
[0m15:17:13.501069 [debug] [MainThread]: On master: ROLLBACK
[0m15:17:13.502159 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:13.503134 [debug] [MainThread]: On master: BEGIN
[0m15:17:13.504451 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:17:13.505434 [debug] [MainThread]: On master: COMMIT
[0m15:17:13.506389 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:13.507227 [debug] [MainThread]: On master: COMMIT
[0m15:17:13.508156 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:17:13.508930 [debug] [MainThread]: On master: Close
[0m15:17:13.513534 [debug] [Thread-1 (]: Began running node model.clinical_trials.gld-countries
[0m15:17:13.514738 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.gld-countries ................................ [RUN]
[0m15:17:13.515943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_gold, now model.clinical_trials.gld-countries)
[0m15:17:13.517389 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.gld-countries
[0m15:17:13.527324 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.gld-countries"
[0m15:17:13.539126 [debug] [Thread-1 (]: Began executing node model.clinical_trials.gld-countries
[0m15:17:13.581786 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.gld-countries"
[0m15:17:13.591250 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld-countries"
[0m15:17:13.592259 [debug] [Thread-1 (]: On model.clinical_trials.gld-countries: BEGIN
[0m15:17:13.593247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:13.600080 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m15:17:13.601197 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld-countries"
[0m15:17:13.602104 [debug] [Thread-1 (]: On model.clinical_trials.gld-countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld-countries"} */

  
    

  create  table "clinical_trials"."gold"."gld-countries__dbt_tmp"
  
  
    as
  
  (
    

select
  tc.nct_id,
  tc.country,
  cc.latitude,
  cc.longitude
from "clinical_trials"."silver"."slv-countries" tc
left join "clinical_trials"."silver"."country_codes" cc
  on lower(cc.country) = lower(tc.country)
  );
  
[0m15:17:13.621685 [debug] [Thread-1 (]: SQL status: SELECT 1557 in 0.018 seconds
[0m15:17:13.630526 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld-countries"
[0m15:17:13.631764 [debug] [Thread-1 (]: On model.clinical_trials.gld-countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld-countries"} */
alter table "clinical_trials"."gold"."gld-countries__dbt_tmp" rename to "gld-countries"
[0m15:17:13.634034 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:17:13.655755 [debug] [Thread-1 (]: On model.clinical_trials.gld-countries: COMMIT
[0m15:17:13.657151 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld-countries"
[0m15:17:13.657973 [debug] [Thread-1 (]: On model.clinical_trials.gld-countries: COMMIT
[0m15:17:13.660431 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:17:13.667085 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."gold"."gld-countries__dbt_backup"
[0m15:17:13.672668 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld-countries"
[0m15:17:13.673640 [debug] [Thread-1 (]: On model.clinical_trials.gld-countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld-countries"} */
drop table if exists "clinical_trials"."gold"."gld-countries__dbt_backup" cascade
[0m15:17:13.675301 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:17:13.678333 [debug] [Thread-1 (]: On model.clinical_trials.gld-countries: Close
[0m15:17:13.680607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f46f510-2650-42c5-b020-af5c57ab10a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9daaf36540>]}
[0m15:17:13.681979 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.gld-countries ........................... [[32mSELECT 1557[0m in 0.16s]
[0m15:17:13.683408 [debug] [Thread-1 (]: Finished running node model.clinical_trials.gld-countries
[0m15:17:13.686867 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:13.688125 [debug] [MainThread]: On master: BEGIN
[0m15:17:13.689044 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:17:13.695425 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:17:13.696446 [debug] [MainThread]: On master: COMMIT
[0m15:17:13.697257 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:13.698015 [debug] [MainThread]: On master: COMMIT
[0m15:17:13.699006 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:17:13.699969 [debug] [MainThread]: On master: Close
[0m15:17:13.701415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:13.702379 [debug] [MainThread]: Connection 'model.clinical_trials.gld-countries' was properly closed.
[0m15:17:13.703484 [debug] [MainThread]: Connection 'list_clinical_trials_silver' was properly closed.
[0m15:17:13.704516 [info ] [MainThread]: 
[0m15:17:13.706109 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m15:17:13.708472 [debug] [MainThread]: Command end result
[0m15:17:13.754270 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:17:13.762652 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:17:13.775981 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:17:13.777353 [info ] [MainThread]: 
[0m15:17:13.779302 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:17:13.781203 [info ] [MainThread]: 
[0m15:17:13.783060 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:17:13.786741 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5069025, "process_in_blocks": "0", "process_kernel_time": 0.42918, "process_mem_max_rss": "109644", "process_out_blocks": "1600", "process_user_time": 2.754737}
[0m15:17:13.788734 [debug] [MainThread]: Command `dbt run` succeeded at 15:17:13.788511 after 1.51 seconds
[0m15:17:13.790446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9da9b54380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9da9b55310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9da9597530>]}
[0m15:17:13.791915 [debug] [MainThread]: Flushing usage events
[0m15:17:14.297031 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:21.289283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe129348b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12a492210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1291414c0>]}


============================== 15:23:21.298764 | 46c49813-7a98-4056-bdf3-15f93bc242b0 ==============================
[0m15:23:21.298764 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:23:21.300469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select path:models/silver', 'send_anonymous_usage_stats': 'True'}
[0m15:23:21.682340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46c49813-7a98-4056-bdf3-15f93bc242b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12a54f890>]}
[0m15:23:21.811166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46c49813-7a98-4056-bdf3-15f93bc242b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe126d14410>]}
[0m15:23:21.815340 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:23:21.945818 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:23:22.463775 [debug] [MainThread]: Partial parsing enabled: 8 files deleted, 8 files added, 0 files changed.
[0m15:23:22.465559 [debug] [MainThread]: Partial parsing: added file: clinical_trials://models/gold/gld_countries.sql
[0m15:23:22.466859 [debug] [MainThread]: Partial parsing: added file: clinical_trials://models/silver/slv_processed_trials.sql
[0m15:23:22.468089 [debug] [MainThread]: Partial parsing: added file: clinical_trials://models/gold/gld_enriched_trials.sql
[0m15:23:22.469281 [debug] [MainThread]: Partial parsing: added file: clinical_trials://models/silver/slv_countries.sql
[0m15:23:22.470557 [debug] [MainThread]: Partial parsing: added file: clinical_trials://models/gold/gld_conditions.sql
[0m15:23:22.471668 [debug] [MainThread]: Partial parsing: added file: clinical_trials://models/silver/slv_interventions.sql
[0m15:23:22.472549 [debug] [MainThread]: Partial parsing: added file: clinical_trials://models/silver/slv_conditions.sql
[0m15:23:22.473632 [debug] [MainThread]: Partial parsing: added file: clinical_trials://models/gold/gld_interventions.sql
[0m15:23:22.474868 [debug] [MainThread]: Partial parsing: deleted file: clinical_trials://models/silver/slv-processed_trials.sql
[0m15:23:22.476013 [debug] [MainThread]: Partial parsing: deleted file: clinical_trials://models/silver/slv-conditions.sql
[0m15:23:22.477170 [debug] [MainThread]: Partial parsing: deleted file: clinical_trials://models/gold/gld-conditions.sql
[0m15:23:22.478176 [debug] [MainThread]: Partial parsing: deleted file: clinical_trials://models/silver/slv-countries.sql
[0m15:23:22.479518 [debug] [MainThread]: Partial parsing: deleted file: clinical_trials://models/silver/slv-interventions.sql
[0m15:23:22.480641 [debug] [MainThread]: Partial parsing: deleted file: clinical_trials://models/gold/gld-enriched_trials.sql
[0m15:23:22.481655 [debug] [MainThread]: Partial parsing: deleted file: clinical_trials://models/gold/gld-interventions.sql
[0m15:23:22.482588 [debug] [MainThread]: Partial parsing: deleted file: clinical_trials://models/gold/gld-countries.sql
[0m15:23:22.875171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46c49813-7a98-4056-bdf3-15f93bc242b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12692c5c0>]}
[0m15:23:23.008652 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:23:23.017891 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:23:23.079006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46c49813-7a98-4056-bdf3-15f93bc242b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe126b0b2f0>]}
[0m15:23:23.081441 [info ] [MainThread]: Found 1 seed, 8 models, 1 source, 430 macros
[0m15:23:23.084215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46c49813-7a98-4056-bdf3-15f93bc242b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12861bc20>]}
[0m15:23:23.094510 [info ] [MainThread]: 
[0m15:23:23.096374 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:23:23.098471 [info ] [MainThread]: 
[0m15:23:23.100952 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:23.110793 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m15:23:23.184341 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m15:23:23.185922 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m15:23:23.186974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:23.201966 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.015 seconds
[0m15:23:23.205518 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m15:23:23.209342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_silver)
[0m15:23:23.211739 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_gold'
[0m15:23:23.222528 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:23:23.226281 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:23:23.228085 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m15:23:23.229264 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m15:23:23.230470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:23.231697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:23.241034 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:23:23.242785 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m15:23:23.244033 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:23:23.245456 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:23:23.246618 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m15:23:23.247730 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m15:23:23.254155 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m15:23:23.255168 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.006 seconds
[0m15:23:23.257345 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m15:23:23.260462 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m15:23:23.262435 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m15:23:23.263543 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m15:23:23.278271 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:23.280182 [debug] [MainThread]: On master: BEGIN
[0m15:23:23.281438 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:23.290641 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m15:23:23.292547 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:23.293979 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:23:23.301094 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m15:23:23.304139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46c49813-7a98-4056-bdf3-15f93bc242b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12859fcb0>]}
[0m15:23:23.305438 [debug] [MainThread]: On master: ROLLBACK
[0m15:23:23.306989 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:23.308189 [debug] [MainThread]: On master: BEGIN
[0m15:23:23.309903 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:23:23.311142 [debug] [MainThread]: On master: COMMIT
[0m15:23:23.312118 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:23.312981 [debug] [MainThread]: On master: COMMIT
[0m15:23:23.314011 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:23:23.314991 [debug] [MainThread]: On master: Close
[0m15:23:23.319722 [debug] [Thread-1 (]: Began running node model.clinical_trials.slv_conditions
[0m15:23:23.320441 [debug] [Thread-2 (]: Began running node model.clinical_trials.slv_countries
[0m15:23:23.320951 [debug] [Thread-3 (]: Began running node model.clinical_trials.slv_interventions
[0m15:23:23.321566 [debug] [Thread-4 (]: Began running node model.clinical_trials.slv_processed_trials
[0m15:23:23.322727 [info ] [Thread-1 (]: 1 of 4 START sql table model silver.slv_conditions ............................. [RUN]
[0m15:23:23.324269 [info ] [Thread-2 (]: 2 of 4 START sql table model silver.slv_countries .............................. [RUN]
[0m15:23:23.326166 [info ] [Thread-3 (]: 3 of 4 START sql table model silver.slv_interventions .......................... [RUN]
[0m15:23:23.327615 [info ] [Thread-4 (]: 4 of 4 START sql table model silver.slv_processed_trials ....................... [RUN]
[0m15:23:23.329522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver, now model.clinical_trials.slv_conditions)
[0m15:23:23.331100 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_clinical_trials_gold, now model.clinical_trials.slv_countries)
[0m15:23:23.332498 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.clinical_trials.slv_interventions'
[0m15:23:23.333702 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.clinical_trials.slv_processed_trials'
[0m15:23:23.335077 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.slv_conditions
[0m15:23:23.336283 [debug] [Thread-2 (]: Began compiling node model.clinical_trials.slv_countries
[0m15:23:23.337458 [debug] [Thread-3 (]: Began compiling node model.clinical_trials.slv_interventions
[0m15:23:23.338473 [debug] [Thread-4 (]: Began compiling node model.clinical_trials.slv_processed_trials
[0m15:23:23.348987 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.slv_conditions"
[0m15:23:23.353692 [debug] [Thread-2 (]: Writing injected SQL for node "model.clinical_trials.slv_countries"
[0m15:23:23.361880 [debug] [Thread-3 (]: Writing injected SQL for node "model.clinical_trials.slv_interventions"
[0m15:23:23.368929 [debug] [Thread-4 (]: Writing injected SQL for node "model.clinical_trials.slv_processed_trials"
[0m15:23:23.376765 [debug] [Thread-3 (]: Began executing node model.clinical_trials.slv_interventions
[0m15:23:23.389859 [debug] [Thread-2 (]: Began executing node model.clinical_trials.slv_countries
[0m15:23:23.407956 [debug] [Thread-1 (]: Began executing node model.clinical_trials.slv_conditions
[0m15:23:23.433776 [debug] [Thread-4 (]: Began executing node model.clinical_trials.slv_processed_trials
[0m15:23:23.440543 [debug] [Thread-2 (]: Writing runtime sql for node "model.clinical_trials.slv_countries"
[0m15:23:23.444585 [debug] [Thread-3 (]: Writing runtime sql for node "model.clinical_trials.slv_interventions"
[0m15:23:23.448757 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.slv_conditions"
[0m15:23:23.452775 [debug] [Thread-4 (]: Writing runtime sql for node "model.clinical_trials.slv_processed_trials"
[0m15:23:23.461023 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv_conditions"
[0m15:23:23.462723 [debug] [Thread-1 (]: On model.clinical_trials.slv_conditions: BEGIN
[0m15:23:23.463595 [debug] [Thread-3 (]: Using postgres connection "model.clinical_trials.slv_interventions"
[0m15:23:23.465102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:23.466165 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.slv_countries"
[0m15:23:23.467663 [debug] [Thread-3 (]: On model.clinical_trials.slv_interventions: BEGIN
[0m15:23:23.470190 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.slv_processed_trials"
[0m15:23:23.471887 [debug] [Thread-2 (]: On model.clinical_trials.slv_countries: BEGIN
[0m15:23:23.473773 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:23:23.475322 [debug] [Thread-4 (]: On model.clinical_trials.slv_processed_trials: BEGIN
[0m15:23:23.477099 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:23.478043 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m15:23:23.480525 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:23:23.482949 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv_conditions"
[0m15:23:23.485811 [debug] [Thread-1 (]: On model.clinical_trials.slv_conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv_conditions"} */

  
    

  create  table "clinical_trials"."silver"."slv_conditions__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  p.nct_id,
  nullif(trim(x), '') as condition
from "clinical_trials"."bronze"."raw_trials" p,
lateral regexp_split_to_table(p.conditions, '\s*[;,]\s*') as x
where p.conditions is not null and p.conditions <> ''
  and nullif(trim(x), '') is not null
  );
  
[0m15:23:23.487187 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m15:23:23.488859 [debug] [Thread-3 (]: Using postgres connection "model.clinical_trials.slv_interventions"
[0m15:23:23.490371 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m15:23:23.491019 [debug] [Thread-3 (]: On model.clinical_trials.slv_interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv_interventions"} */

  
    

  create  table "clinical_trials"."silver"."slv_interventions__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  p.nct_id,
  nullif(trim(x), '') as intervention
from "clinical_trials"."bronze"."raw_trials" p,
lateral regexp_split_to_table(p.interventions, '\s*[;,]\s*') as x
where p.interventions is not null and p.interventions <> ''
  and nullif(trim(x), '') is not null
  );
  
[0m15:23:23.492336 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.slv_countries"
[0m15:23:23.493974 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m15:23:23.494815 [debug] [Thread-2 (]: On model.clinical_trials.slv_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv_countries"} */

  
    

  create  table "clinical_trials"."silver"."slv_countries__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  p.nct_id,
  nullif(trim(x), '') as country
from "clinical_trials"."bronze"."raw_trials" p,
lateral regexp_split_to_table(p.countries, '\s*[;,]\s*') as x
where p.countries is not null and p.countries <> ''
  and nullif(trim(x), '') is not null
  );
  
[0m15:23:23.495980 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.slv_processed_trials"
[0m15:23:23.498680 [debug] [Thread-4 (]: On model.clinical_trials.slv_processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv_processed_trials"} */

  
    

  create  table "clinical_trials"."silver"."slv_processed_trials__dbt_tmp"
  
  
    as
  
  (
    

with src as (
  select
    nct_id,
    brief_title,
    study_type,
    case
      when coalesce(upper(study_type), '') = 'OBSERVATIONAL' then 'NOT APPLICABLE'
      when phase is null then null
      else upper(phase)
    end as phase,
    overall_status,
    start_date      as start_date_raw,
    completion_date as completion_date_raw
  from "clinical_trials"."bronze"."raw_trials"
),

-- 1) Homogenize placeholders -> NULL
nulls as (
  select
    nct_id,
    nullif(trim(brief_title),      '')              as brief_title,
    nullif(trim(study_type),       '')              as study_type,
    nullif(trim(phase),            '')              as phase,
    nullif(trim(overall_status),   '')              as status,
    nullif(trim(start_date_raw),       '')          as start_date_raw,
    nullif(trim(completion_date_raw),  '')          as completion_date_raw
  from src
),

-- Treat common placeholders (‘NA’, ‘N/A’, ‘UNKNOWN’, ‘NULL’ the *string*) as NULL
placeholders as (
  select
    nct_id,
    case when upper(brief_title)    in ('NA','N/A','UNKNOWN','NULL') then null else brief_title end    as brief_title,
    case when upper(study_type)     in ('NA','N/A','UNKNOWN','NULL') then null else study_type  end    as study_type,
    case when upper(phase)       in ('NA','N/A','UNKNOWN','NULL') then null else phase    end    as phase,
    case when upper(status)      in ('NA','N/A','UNKNOWN','NULL') then null else status   end    as status,
    case when upper(start_date_raw)     in ('NA','N/A','UNKNOWN','NULL') then null else start_date_raw  end    as start_date_raw,
    case when upper(completion_date_raw)in ('NA','N/A','UNKNOWN','NULL') then null else completion_date_raw end as completion_date_raw
  from nulls
),

-- 2) Parse partial dates (YYYY, YYYY-MM, YYYY-MM-DD) -> DATE
dates as (
  select
    nct_id,
    brief_title,
    study_type,
    status,
    phase,

    case
      when start_date_raw ~ '^\d{4}-\d{2}-\d{2}$' then to_date(start_date_raw,'YYYY-MM-DD')
      when start_date_raw ~ '^\d{4}-\d{2}$'       then to_date(start_date_raw||'-01','YYYY-MM-DD')
      when start_date_raw ~ '^\d{4}$'             then to_date(start_date_raw||'-01-01','YYYY-MM-DD')
      else null
    end as start_date,

    case
      when completion_date_raw ~ '^\d{4}-\d{2}-\d{2}$' then to_date(completion_date_raw,'YYYY-MM-DD')
      when completion_date_raw ~ '^\d{4}-\d{2}$'       then to_date(completion_date_raw||'-01','YYYY-MM-DD')
      when completion_date_raw ~ '^\d{4}$'             then to_date(completion_date_raw||'-01-01','YYYY-MM-DD')
      else null
    end as completion_date
  from placeholders
)

select 
    nct_id,
    brief_title,
    study_type,
    status,
    phase,
    start_date,
    completion_date
from dates
  );
  
[0m15:23:23.550213 [debug] [Thread-4 (]: SQL status: SELECT 1100 in 0.050 seconds
[0m15:23:23.559012 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.slv_processed_trials"
[0m15:23:23.560382 [debug] [Thread-4 (]: On model.clinical_trials.slv_processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv_processed_trials"} */
alter table "clinical_trials"."silver"."slv_processed_trials__dbt_tmp" rename to "slv_processed_trials"
[0m15:23:23.562607 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:23.586785 [debug] [Thread-4 (]: On model.clinical_trials.slv_processed_trials: COMMIT
[0m15:23:23.588454 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.slv_processed_trials"
[0m15:23:23.590048 [debug] [Thread-4 (]: On model.clinical_trials.slv_processed_trials: COMMIT
[0m15:23:23.594465 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m15:23:23.603006 [debug] [Thread-4 (]: Applying DROP to: "clinical_trials"."silver"."slv_processed_trials__dbt_backup"
[0m15:23:23.614478 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.slv_processed_trials"
[0m15:23:23.616128 [debug] [Thread-4 (]: On model.clinical_trials.slv_processed_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv_processed_trials"} */
drop table if exists "clinical_trials"."silver"."slv_processed_trials__dbt_backup" cascade
[0m15:23:23.618091 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:23:23.624223 [debug] [Thread-4 (]: On model.clinical_trials.slv_processed_trials: Close
[0m15:23:23.630400 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46c49813-7a98-4056-bdf3-15f93bc242b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12a54ea50>]}
[0m15:23:23.632515 [info ] [Thread-4 (]: 4 of 4 OK created sql table model silver.slv_processed_trials .................. [[32mSELECT 1100[0m in 0.29s]
[0m15:23:23.635144 [debug] [Thread-4 (]: Finished running node model.clinical_trials.slv_processed_trials
[0m15:23:23.806936 [debug] [Thread-1 (]: SQL status: SELECT 2168 in 0.319 seconds
[0m15:23:23.808551 [debug] [Thread-3 (]: SQL status: SELECT 1928 in 0.315 seconds
[0m15:23:23.809361 [debug] [Thread-2 (]: SQL status: SELECT 1557 in 0.312 seconds
[0m15:23:23.815692 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv_conditions"
[0m15:23:23.819672 [debug] [Thread-3 (]: Using postgres connection "model.clinical_trials.slv_interventions"
[0m15:23:23.823764 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.slv_countries"
[0m15:23:23.824824 [debug] [Thread-1 (]: On model.clinical_trials.slv_conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv_conditions"} */
alter table "clinical_trials"."silver"."slv_conditions__dbt_tmp" rename to "slv_conditions"
[0m15:23:23.825908 [debug] [Thread-3 (]: On model.clinical_trials.slv_interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv_interventions"} */
alter table "clinical_trials"."silver"."slv_interventions__dbt_tmp" rename to "slv_interventions"
[0m15:23:23.827136 [debug] [Thread-2 (]: On model.clinical_trials.slv_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv_countries"} */
alter table "clinical_trials"."silver"."slv_countries__dbt_tmp" rename to "slv_countries"
[0m15:23:23.828802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:23.829905 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:23.830883 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:23:23.833253 [debug] [Thread-1 (]: On model.clinical_trials.slv_conditions: COMMIT
[0m15:23:23.835749 [debug] [Thread-3 (]: On model.clinical_trials.slv_interventions: COMMIT
[0m15:23:23.838915 [debug] [Thread-2 (]: On model.clinical_trials.slv_countries: COMMIT
[0m15:23:23.840388 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv_conditions"
[0m15:23:23.841645 [debug] [Thread-3 (]: Using postgres connection "model.clinical_trials.slv_interventions"
[0m15:23:23.842850 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.slv_countries"
[0m15:23:23.843963 [debug] [Thread-1 (]: On model.clinical_trials.slv_conditions: COMMIT
[0m15:23:23.845013 [debug] [Thread-3 (]: On model.clinical_trials.slv_interventions: COMMIT
[0m15:23:23.846932 [debug] [Thread-2 (]: On model.clinical_trials.slv_countries: COMMIT
[0m15:23:23.856912 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m15:23:23.857766 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m15:23:23.858581 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m15:23:23.864400 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."slv_conditions__dbt_backup"
[0m15:23:23.872079 [debug] [Thread-2 (]: Applying DROP to: "clinical_trials"."silver"."slv_countries__dbt_backup"
[0m15:23:23.876665 [debug] [Thread-3 (]: Applying DROP to: "clinical_trials"."silver"."slv_interventions__dbt_backup"
[0m15:23:23.878408 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv_conditions"
[0m15:23:23.879751 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.slv_countries"
[0m15:23:23.881796 [debug] [Thread-3 (]: Using postgres connection "model.clinical_trials.slv_interventions"
[0m15:23:23.883196 [debug] [Thread-1 (]: On model.clinical_trials.slv_conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv_conditions"} */
drop table if exists "clinical_trials"."silver"."slv_conditions__dbt_backup" cascade
[0m15:23:23.884346 [debug] [Thread-2 (]: On model.clinical_trials.slv_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv_countries"} */
drop table if exists "clinical_trials"."silver"."slv_countries__dbt_backup" cascade
[0m15:23:23.885403 [debug] [Thread-3 (]: On model.clinical_trials.slv_interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv_interventions"} */
drop table if exists "clinical_trials"."silver"."slv_interventions__dbt_backup" cascade
[0m15:23:23.887048 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:23:23.888184 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:23:23.889302 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:23:23.891196 [debug] [Thread-1 (]: On model.clinical_trials.slv_conditions: Close
[0m15:23:23.893548 [debug] [Thread-2 (]: On model.clinical_trials.slv_countries: Close
[0m15:23:23.895892 [debug] [Thread-3 (]: On model.clinical_trials.slv_interventions: Close
[0m15:23:23.897949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46c49813-7a98-4056-bdf3-15f93bc242b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe11e733f80>]}
[0m15:23:23.899427 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46c49813-7a98-4056-bdf3-15f93bc242b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe124042270>]}
[0m15:23:23.901460 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46c49813-7a98-4056-bdf3-15f93bc242b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe124040b30>]}
[0m15:23:23.903600 [info ] [Thread-1 (]: 1 of 4 OK created sql table model silver.slv_conditions ........................ [[32mSELECT 2168[0m in 0.57s]
[0m15:23:23.906201 [info ] [Thread-2 (]: 2 of 4 OK created sql table model silver.slv_countries ......................... [[32mSELECT 1557[0m in 0.57s]
[0m15:23:23.908640 [info ] [Thread-3 (]: 3 of 4 OK created sql table model silver.slv_interventions ..................... [[32mSELECT 1928[0m in 0.57s]
[0m15:23:23.911344 [debug] [Thread-1 (]: Finished running node model.clinical_trials.slv_conditions
[0m15:23:23.913753 [debug] [Thread-2 (]: Finished running node model.clinical_trials.slv_countries
[0m15:23:23.915823 [debug] [Thread-3 (]: Finished running node model.clinical_trials.slv_interventions
[0m15:23:23.923757 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:23.926007 [debug] [MainThread]: On master: BEGIN
[0m15:23:23.927917 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:23.937326 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m15:23:23.939079 [debug] [MainThread]: On master: COMMIT
[0m15:23:23.940892 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:23.942744 [debug] [MainThread]: On master: COMMIT
[0m15:23:23.944629 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:23:23.946197 [debug] [MainThread]: On master: Close
[0m15:23:23.948253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:23.949665 [debug] [MainThread]: Connection 'model.clinical_trials.slv_conditions' was properly closed.
[0m15:23:23.950722 [debug] [MainThread]: Connection 'model.clinical_trials.slv_countries' was properly closed.
[0m15:23:23.951886 [debug] [MainThread]: Connection 'model.clinical_trials.slv_interventions' was properly closed.
[0m15:23:23.952809 [debug] [MainThread]: Connection 'model.clinical_trials.slv_processed_trials' was properly closed.
[0m15:23:23.953939 [info ] [MainThread]: 
[0m15:23:23.955597 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m15:23:23.959182 [debug] [MainThread]: Command end result
[0m15:23:24.017722 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:23:24.027577 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:23:24.046336 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:23:24.047955 [info ] [MainThread]: 
[0m15:23:24.050162 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:23:24.052588 [info ] [MainThread]: 
[0m15:23:24.054694 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:23:24.058445 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8508034, "process_in_blocks": "0", "process_kernel_time": 0.585221, "process_mem_max_rss": "113360", "process_out_blocks": "1600", "process_user_time": 3.440699}
[0m15:23:24.060703 [debug] [MainThread]: Command `dbt run` succeeded at 15:23:24.060210 after 2.85 seconds
[0m15:23:24.062600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1288d61e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe128e0f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe124053c20>]}
[0m15:23:24.064194 [debug] [MainThread]: Flushing usage events
[0m15:23:24.555099 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:56.662784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94144c0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93f34f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93f6bf1a0>]}


============================== 15:23:56.672931 | ea682c49-6b03-41f5-a860-d317f9fc99de ==============================
[0m15:23:56.672931 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:23:56.674230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select path:models/gold', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:23:56.930691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea682c49-6b03-41f5-a860-d317f9fc99de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93f53cbc0>]}
[0m15:23:57.000948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea682c49-6b03-41f5-a860-d317f9fc99de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93f18cb30>]}
[0m15:23:57.002554 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:23:57.090008 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:23:57.364006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:23:57.365155 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:23:57.418562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea682c49-6b03-41f5-a860-d317f9fc99de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93d85b0e0>]}
[0m15:23:57.530086 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:23:57.537339 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:23:57.578995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea682c49-6b03-41f5-a860-d317f9fc99de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93d57d430>]}
[0m15:23:57.580310 [info ] [MainThread]: Found 1 seed, 8 models, 1 source, 430 macros
[0m15:23:57.581383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea682c49-6b03-41f5-a860-d317f9fc99de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93d5969f0>]}
[0m15:23:57.589019 [info ] [MainThread]: 
[0m15:23:57.590965 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:23:57.592492 [info ] [MainThread]: 
[0m15:23:57.594505 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:57.599688 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m15:23:57.662940 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m15:23:57.664327 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m15:23:57.665484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:57.675563 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m15:23:57.678062 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m15:23:57.680969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_silver)
[0m15:23:57.682643 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_gold'
[0m15:23:57.689485 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:23:57.691650 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:23:57.692493 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m15:23:57.693168 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m15:23:57.693852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:57.694740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:57.702390 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:23:57.703013 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:23:57.703927 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:23:57.704921 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:23:57.705663 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m15:23:57.706699 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m15:23:57.710344 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.002 seconds
[0m15:23:57.711000 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m15:23:57.713726 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m15:23:57.715565 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m15:23:57.716857 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m15:23:57.717459 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m15:23:57.726751 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:57.727857 [debug] [MainThread]: On master: BEGIN
[0m15:23:57.728595 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:57.735689 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:23:57.736747 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:57.737765 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:23:57.744042 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m15:23:57.746063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea682c49-6b03-41f5-a860-d317f9fc99de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93f05b8c0>]}
[0m15:23:57.747139 [debug] [MainThread]: On master: ROLLBACK
[0m15:23:57.748399 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:57.749241 [debug] [MainThread]: On master: BEGIN
[0m15:23:57.750403 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:23:57.751184 [debug] [MainThread]: On master: COMMIT
[0m15:23:57.751896 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:57.752900 [debug] [MainThread]: On master: COMMIT
[0m15:23:57.753834 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:23:57.754764 [debug] [MainThread]: On master: Close
[0m15:23:57.758106 [debug] [Thread-1 (]: Began running node model.clinical_trials.gld_conditions
[0m15:23:57.758520 [debug] [Thread-2 (]: Began running node model.clinical_trials.gld_countries
[0m15:23:57.758861 [debug] [Thread-3 (]: Began running node model.clinical_trials.gld_enriched_trials
[0m15:23:57.759197 [debug] [Thread-4 (]: Began running node model.clinical_trials.gld_interventions
[0m15:23:57.759795 [info ] [Thread-1 (]: 1 of 4 START sql table model gold.gld_conditions ............................... [RUN]
[0m15:23:57.760912 [info ] [Thread-2 (]: 2 of 4 START sql table model gold.gld_countries ................................ [RUN]
[0m15:23:57.762541 [info ] [Thread-3 (]: 3 of 4 START sql table model gold.gld_enriched_trials .......................... [RUN]
[0m15:23:57.763731 [info ] [Thread-4 (]: 4 of 4 START sql table model gold.gld_interventions ............................ [RUN]
[0m15:23:57.764971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_gold, now model.clinical_trials.gld_conditions)
[0m15:23:57.766139 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver, now model.clinical_trials.gld_countries)
[0m15:23:57.767278 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.clinical_trials.gld_enriched_trials'
[0m15:23:57.768349 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.clinical_trials.gld_interventions'
[0m15:23:57.769375 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.gld_conditions
[0m15:23:57.770377 [debug] [Thread-2 (]: Began compiling node model.clinical_trials.gld_countries
[0m15:23:57.771332 [debug] [Thread-3 (]: Began compiling node model.clinical_trials.gld_enriched_trials
[0m15:23:57.772214 [debug] [Thread-4 (]: Began compiling node model.clinical_trials.gld_interventions
[0m15:23:57.788189 [debug] [Thread-2 (]: Writing injected SQL for node "model.clinical_trials.gld_countries"
[0m15:23:57.793964 [debug] [Thread-3 (]: Writing injected SQL for node "model.clinical_trials.gld_enriched_trials"
[0m15:23:57.804802 [debug] [Thread-2 (]: Began executing node model.clinical_trials.gld_countries
[0m15:23:57.808298 [debug] [Thread-4 (]: Compilation Error in model gld_interventions (models/gold/gld_interventions.sql)
  'force_lineage' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:23:57.809760 [debug] [Thread-1 (]: Compilation Error in model gld_conditions (models/gold/gld_conditions.sql)
  'force_lineage' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:23:57.810368 [debug] [Thread-3 (]: Began executing node model.clinical_trials.gld_enriched_trials
[0m15:23:57.863235 [debug] [Thread-2 (]: Writing runtime sql for node "model.clinical_trials.gld_countries"
[0m15:23:57.863847 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea682c49-6b03-41f5-a860-d317f9fc99de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93fc0ea20>]}
[0m15:23:57.864305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea682c49-6b03-41f5-a860-d317f9fc99de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93d803500>]}
[0m15:23:57.867829 [debug] [Thread-3 (]: Writing runtime sql for node "model.clinical_trials.gld_enriched_trials"
[0m15:23:57.870665 [error] [Thread-4 (]: 4 of 4 ERROR creating sql table model gold.gld_interventions ................... [[31mERROR[0m in 0.07s]
[0m15:23:57.872184 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model gold.gld_conditions ...................... [[31mERROR[0m in 0.09s]
[0m15:23:57.874825 [debug] [Thread-4 (]: Finished running node model.clinical_trials.gld_interventions
[0m15:23:57.876400 [debug] [Thread-1 (]: Finished running node model.clinical_trials.gld_conditions
[0m15:23:57.878487 [debug] [Thread-7 (]: Marking all children of 'model.clinical_trials.gld_interventions' to be skipped because of status 'error'.  Reason: Compilation Error in model gld_interventions (models/gold/gld_interventions.sql)
  'force_lineage' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:23:57.879289 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:23:57.882470 [debug] [Thread-7 (]: Marking all children of 'model.clinical_trials.gld_conditions' to be skipped because of status 'error'.  Reason: Compilation Error in model gld_conditions (models/gold/gld_conditions.sql)
  'force_lineage' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:23:57.883241 [debug] [Thread-3 (]: Using postgres connection "model.clinical_trials.gld_enriched_trials"
[0m15:23:57.884128 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: BEGIN
[0m15:23:57.885544 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: BEGIN
[0m15:23:57.886300 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:57.886925 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:23:57.894024 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m15:23:57.895267 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m15:23:57.896195 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:23:57.897047 [debug] [Thread-3 (]: Using postgres connection "model.clinical_trials.gld_enriched_trials"
[0m15:23:57.897930 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */

  
    

  create  table "clinical_trials"."gold"."gld_countries__dbt_tmp"
  
  
    as
  
  (
    

select
  tc.nct_id,
  tc.country,
  cc.latitude,
  cc.longitude
from "clinical_trials"."silver"."slv_countries" tc
left join "clinical_trials"."silver"."country_codes" cc
  on lower(cc.country) = lower(tc.country)
  );
  
[0m15:23:57.898633 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_enriched_trials"} */

  
    

  create  table "clinical_trials"."gold"."gld_enriched_trials__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    nct_id,
    brief_title,
    study_type,
    status,
    phase,
    start_date,
    completion_date,
    co.country,
    cd.condition,
    iv.intervention,
    case
        when start_date is not null
        and completion_date is not null
        and completion_date >= start_date
        then round(((completion_date - start_date)::numeric / 365.25), 2)
        else null
    end as study_length_years
from "clinical_trials"."silver"."slv_processed_trials" p
left join countries co on co.nct_id = p.nct_id
left join conditions cd on cd.nct_id = p.nct_id
left join interventions iv on iv.nct_id = p.nct_id
  );
  
[0m15:23:57.901897 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "countries" does not exist
LINE 33: left join countries co on co.nct_id = p.nct_id
                   ^

[0m15:23:57.903685 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: ROLLBACK
[0m15:23:57.905282 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: Close
[0m15:23:57.911713 [debug] [Thread-3 (]: Database Error in model gld_enriched_trials (models/gold/gld_enriched_trials.sql)
  relation "countries" does not exist
  LINE 33: left join countries co on co.nct_id = p.nct_id
                     ^
  compiled code at target/run/clinical_trials/models/gold/gld_enriched_trials.sql
[0m15:23:57.913336 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea682c49-6b03-41f5-a860-d317f9fc99de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93c7fb530>]}
[0m15:23:57.913916 [debug] [Thread-2 (]: SQL status: SELECT 1557 in 0.014 seconds
[0m15:23:57.914925 [error] [Thread-3 (]: 3 of 4 ERROR creating sql table model gold.gld_enriched_trials ................. [[31mERROR[0m in 0.15s]
[0m15:23:57.923860 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:23:57.925127 [debug] [Thread-3 (]: Finished running node model.clinical_trials.gld_enriched_trials
[0m15:23:57.926219 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */
alter table "clinical_trials"."gold"."gld_countries__dbt_tmp" rename to "gld_countries"
[0m15:23:57.927375 [debug] [Thread-7 (]: Marking all children of 'model.clinical_trials.gld_enriched_trials' to be skipped because of status 'error'.  Reason: Database Error in model gld_enriched_trials (models/gold/gld_enriched_trials.sql)
  relation "countries" does not exist
  LINE 33: left join countries co on co.nct_id = p.nct_id
                     ^
  compiled code at target/run/clinical_trials/models/gold/gld_enriched_trials.sql.
[0m15:23:57.928970 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:57.954347 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: COMMIT
[0m15:23:57.955692 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:23:57.956826 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: COMMIT
[0m15:23:57.961713 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m15:23:57.971633 [debug] [Thread-2 (]: Applying DROP to: "clinical_trials"."gold"."gld_countries__dbt_backup"
[0m15:23:57.977754 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:23:57.979195 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */
drop table if exists "clinical_trials"."gold"."gld_countries__dbt_backup" cascade
[0m15:23:57.980761 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:23:57.984617 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: Close
[0m15:23:57.986258 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea682c49-6b03-41f5-a860-d317f9fc99de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94102e5a0>]}
[0m15:23:57.987897 [info ] [Thread-2 (]: 2 of 4 OK created sql table model gold.gld_countries ........................... [[32mSELECT 1557[0m in 0.22s]
[0m15:23:57.989809 [debug] [Thread-2 (]: Finished running node model.clinical_trials.gld_countries
[0m15:23:57.993761 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:57.995125 [debug] [MainThread]: On master: BEGIN
[0m15:23:57.996159 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:58.002886 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:23:58.004131 [debug] [MainThread]: On master: COMMIT
[0m15:23:58.005112 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:58.006055 [debug] [MainThread]: On master: COMMIT
[0m15:23:58.007192 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:23:58.008285 [debug] [MainThread]: On master: Close
[0m15:23:58.009668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:58.010752 [debug] [MainThread]: Connection 'model.clinical_trials.gld_countries' was properly closed.
[0m15:23:58.011640 [debug] [MainThread]: Connection 'model.clinical_trials.gld_conditions' was properly closed.
[0m15:23:58.012415 [debug] [MainThread]: Connection 'model.clinical_trials.gld_enriched_trials' was properly closed.
[0m15:23:58.013301 [debug] [MainThread]: Connection 'model.clinical_trials.gld_interventions' was properly closed.
[0m15:23:58.014277 [info ] [MainThread]: 
[0m15:23:58.015318 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m15:23:58.018202 [debug] [MainThread]: Command end result
[0m15:23:58.061115 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:23:58.068031 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:23:58.081367 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:23:58.082608 [info ] [MainThread]: 
[0m15:23:58.084046 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m15:23:58.085691 [info ] [MainThread]: 
[0m15:23:58.087147 [error] [MainThread]:   Compilation Error in model gld_interventions (models/gold/gld_interventions.sql)
  'force_lineage' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:23:58.088630 [info ] [MainThread]: 
[0m15:23:58.090660 [error] [MainThread]:   Compilation Error in model gld_conditions (models/gold/gld_conditions.sql)
  'force_lineage' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:23:58.092146 [info ] [MainThread]: 
[0m15:23:58.093490 [error] [MainThread]:   Database Error in model gld_enriched_trials (models/gold/gld_enriched_trials.sql)
  relation "countries" does not exist
  LINE 33: left join countries co on co.nct_id = p.nct_id
                     ^
  compiled code at target/run/clinical_trials/models/gold/gld_enriched_trials.sql
[0m15:23:58.094801 [info ] [MainThread]: 
[0m15:23:58.096106 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=0 TOTAL=4
[0m15:23:58.098894 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5111182, "process_in_blocks": "0", "process_kernel_time": 0.39571, "process_mem_max_rss": "111060", "process_out_blocks": "1600", "process_user_time": 2.710619}
[0m15:23:58.101256 [debug] [MainThread]: Command `dbt run` failed at 15:23:58.100967 after 1.51 seconds
[0m15:23:58.102591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93f41e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93fc2d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93c6bbf80>]}
[0m15:23:58.103879 [debug] [MainThread]: Flushing usage events
[0m15:23:58.558573 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:30:45.152251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff99b083080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff99ae3b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff99b54bbf0>]}


============================== 15:30:45.161149 | 036c276e-904f-469e-b2f0-b378140b9e4f ==============================
[0m15:30:45.161149 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:30:45.162821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select path:models/gold', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:30:45.444048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '036c276e-904f-469e-b2f0-b378140b9e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff998fc9ac0>]}
[0m15:30:45.562041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '036c276e-904f-469e-b2f0-b378140b9e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff99b51a210>]}
[0m15:30:45.564896 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:30:45.667958 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:30:46.073713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:30:46.076075 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/gold/gld_interventions.sql
[0m15:30:46.077719 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/gold/gld_conditions.sql
[0m15:30:46.484224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '036c276e-904f-469e-b2f0-b378140b9e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff999071430>]}
[0m15:30:46.639365 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:30:46.650048 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:30:46.712543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '036c276e-904f-469e-b2f0-b378140b9e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff998dfeb70>]}
[0m15:30:46.714785 [info ] [MainThread]: Found 1 seed, 8 models, 1 source, 430 macros
[0m15:30:46.717161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '036c276e-904f-469e-b2f0-b378140b9e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff998bedd30>]}
[0m15:30:46.726506 [info ] [MainThread]: 
[0m15:30:46.728248 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:30:46.730016 [info ] [MainThread]: 
[0m15:30:46.732770 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:30:46.741706 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m15:30:46.815955 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m15:30:46.817566 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m15:30:46.818870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:46.834507 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.015 seconds
[0m15:30:46.837740 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m15:30:46.840954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_gold)
[0m15:30:46.842106 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_silver'
[0m15:30:46.852561 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:30:46.858318 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:30:46.859797 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m15:30:46.860933 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m15:30:46.862103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:46.863281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:46.870568 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:30:46.874556 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m15:30:46.875297 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:30:46.876744 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:30:46.877999 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m15:30:46.879487 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m15:30:46.886516 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m15:30:46.887259 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.006 seconds
[0m15:30:46.890485 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m15:30:46.893184 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m15:30:46.894959 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m15:30:46.896027 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m15:30:46.911368 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:46.912952 [debug] [MainThread]: On master: BEGIN
[0m15:30:46.913901 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:30:46.921626 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:30:46.923021 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:46.924266 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:30:46.935419 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m15:30:46.938140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '036c276e-904f-469e-b2f0-b378140b9e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98a2aff80>]}
[0m15:30:46.939405 [debug] [MainThread]: On master: ROLLBACK
[0m15:30:46.940654 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:46.941805 [debug] [MainThread]: On master: BEGIN
[0m15:30:46.943604 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:30:46.945035 [debug] [MainThread]: On master: COMMIT
[0m15:30:46.946089 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:46.947303 [debug] [MainThread]: On master: COMMIT
[0m15:30:46.948381 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:30:46.949307 [debug] [MainThread]: On master: Close
[0m15:30:46.955725 [debug] [Thread-1 (]: Began running node model.clinical_trials.gld_conditions
[0m15:30:46.956407 [debug] [Thread-2 (]: Began running node model.clinical_trials.gld_countries
[0m15:30:46.957020 [debug] [Thread-3 (]: Began running node model.clinical_trials.gld_enriched_trials
[0m15:30:46.957424 [debug] [Thread-4 (]: Began running node model.clinical_trials.gld_interventions
[0m15:30:46.958392 [info ] [Thread-1 (]: 1 of 4 START sql table model gold.gld_conditions ............................... [RUN]
[0m15:30:46.959877 [info ] [Thread-2 (]: 2 of 4 START sql table model gold.gld_countries ................................ [RUN]
[0m15:30:46.961499 [info ] [Thread-3 (]: 3 of 4 START sql table model gold.gld_enriched_trials .......................... [RUN]
[0m15:30:46.962924 [info ] [Thread-4 (]: 4 of 4 START sql table model gold.gld_interventions ............................ [RUN]
[0m15:30:46.964504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver, now model.clinical_trials.gld_conditions)
[0m15:30:46.966011 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_clinical_trials_gold, now model.clinical_trials.gld_countries)
[0m15:30:46.967289 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.clinical_trials.gld_enriched_trials'
[0m15:30:46.968655 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.clinical_trials.gld_interventions'
[0m15:30:46.970004 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.gld_conditions
[0m15:30:46.971230 [debug] [Thread-2 (]: Began compiling node model.clinical_trials.gld_countries
[0m15:30:46.972362 [debug] [Thread-3 (]: Began compiling node model.clinical_trials.gld_enriched_trials
[0m15:30:46.973738 [debug] [Thread-4 (]: Began compiling node model.clinical_trials.gld_interventions
[0m15:30:46.983461 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.gld_conditions"
[0m15:30:46.989771 [debug] [Thread-2 (]: Writing injected SQL for node "model.clinical_trials.gld_countries"
[0m15:30:46.994853 [debug] [Thread-3 (]: Writing injected SQL for node "model.clinical_trials.gld_enriched_trials"
[0m15:30:47.001213 [debug] [Thread-4 (]: Writing injected SQL for node "model.clinical_trials.gld_interventions"
[0m15:30:47.009017 [debug] [Thread-3 (]: Began executing node model.clinical_trials.gld_enriched_trials
[0m15:30:47.010193 [debug] [Thread-2 (]: Began executing node model.clinical_trials.gld_countries
[0m15:30:47.011201 [debug] [Thread-4 (]: Began executing node model.clinical_trials.gld_interventions
[0m15:30:47.023738 [debug] [Thread-1 (]: Began executing node model.clinical_trials.gld_conditions
[0m15:30:47.083416 [debug] [Thread-3 (]: Writing runtime sql for node "model.clinical_trials.gld_enriched_trials"
[0m15:30:47.087925 [debug] [Thread-4 (]: Writing runtime sql for node "model.clinical_trials.gld_interventions"
[0m15:30:47.088439 [debug] [Thread-2 (]: Writing runtime sql for node "model.clinical_trials.gld_countries"
[0m15:30:47.094936 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.gld_conditions"
[0m15:30:47.103259 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:30:47.104896 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:30:47.105455 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: BEGIN
[0m15:30:47.107710 [debug] [Thread-3 (]: Using postgres connection "model.clinical_trials.gld_enriched_trials"
[0m15:30:47.108488 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: BEGIN
[0m15:30:47.109374 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:30:47.110887 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:30:47.112133 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: BEGIN
[0m15:30:47.113242 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:30:47.114398 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: BEGIN
[0m15:30:47.116873 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:30:47.119449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:47.123455 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m15:30:47.125564 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:30:47.126667 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m15:30:47.127743 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */

  
    

  create  table "clinical_trials"."gold"."gld_countries__dbt_tmp"
  
  
    as
  
  (
    

select
  tc.nct_id,
  tc.country,
  cc.latitude,
  cc.longitude
from "clinical_trials"."silver"."slv_countries" tc
left join "clinical_trials"."silver"."country_codes" cc
  on lower(cc.country) = lower(tc.country)
  );
  
[0m15:30:47.128791 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m15:30:47.129711 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:30:47.130894 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m15:30:47.132413 [debug] [Thread-3 (]: Using postgres connection "model.clinical_trials.gld_enriched_trials"
[0m15:30:47.134031 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_interventions"} */

  
    

  create  table "clinical_trials"."gold"."gld_interventions__dbt_tmp"
  
  
    as
  
  (
    

select *
from "clinical_trials"."silver"."slv_interventions"
  );
  
[0m15:30:47.135348 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:30:47.136858 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_enriched_trials"} */

  
    

  create  table "clinical_trials"."gold"."gld_enriched_trials__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    nct_id,
    brief_title,
    study_type,
    status,
    phase,
    start_date,
    completion_date,
    co.country,
    cd.condition,
    iv.intervention,
    case
        when start_date is not null
        and completion_date is not null
        and completion_date >= start_date
        then round(((completion_date - start_date)::numeric / 365.25), 2)
        else null
    end as study_length_years
from "clinical_trials"."silver"."slv_processed_trials" p
left join countries co on co.nct_id = p.nct_id
left join conditions cd on cd.nct_id = p.nct_id
left join interventions iv on iv.nct_id = p.nct_id
  );
  
[0m15:30:47.139168 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_conditions"} */

  
    

  create  table "clinical_trials"."gold"."gld_conditions__dbt_tmp"
  
  
    as
  
  (
    

select *
from "clinical_trials"."silver"."slv_conditions";
  );
  
[0m15:30:47.141985 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "countries" does not exist
LINE 33: left join countries co on co.nct_id = p.nct_id
                   ^

[0m15:30:47.142685 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: from "clinical_trials"."silver"."slv_conditions";
                                                         ^

[0m15:30:47.143990 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: ROLLBACK
[0m15:30:47.145140 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: ROLLBACK
[0m15:30:47.146671 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: Close
[0m15:30:47.148036 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: Close
[0m15:30:47.154256 [debug] [Thread-4 (]: SQL status: SELECT 1928 in 0.016 seconds
[0m15:30:47.155694 [debug] [Thread-2 (]: SQL status: SELECT 1557 in 0.024 seconds
[0m15:30:47.167020 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:30:47.170192 [debug] [Thread-1 (]: Database Error in model gld_conditions (models/gold/gld_conditions.sql)
  syntax error at or near ";"
  LINE 15: from "clinical_trials"."silver"."slv_conditions";
                                                           ^
  compiled code at target/run/clinical_trials/models/gold/gld_conditions.sql
[0m15:30:47.171469 [debug] [Thread-3 (]: Database Error in model gld_enriched_trials (models/gold/gld_enriched_trials.sql)
  relation "countries" does not exist
  LINE 33: left join countries co on co.nct_id = p.nct_id
                     ^
  compiled code at target/run/clinical_trials/models/gold/gld_enriched_trials.sql
[0m15:30:47.175699 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:30:47.176988 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_interventions"} */
alter table "clinical_trials"."gold"."gld_interventions__dbt_tmp" rename to "gld_interventions"
[0m15:30:47.179831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036c276e-904f-469e-b2f0-b378140b9e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98a0982c0>]}
[0m15:30:47.181064 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036c276e-904f-469e-b2f0-b378140b9e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98a084050>]}
[0m15:30:47.182326 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */
alter table "clinical_trials"."gold"."gld_countries" rename to "gld_countries__dbt_backup"
[0m15:30:47.184094 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:30:47.185342 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model gold.gld_conditions ...................... [[31mERROR[0m in 0.21s]
[0m15:30:47.187292 [error] [Thread-3 (]: 3 of 4 ERROR creating sql table model gold.gld_enriched_trials ................. [[31mERROR[0m in 0.21s]
[0m15:30:47.189460 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:30:47.213079 [debug] [Thread-1 (]: Finished running node model.clinical_trials.gld_conditions
[0m15:30:47.219627 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: COMMIT
[0m15:30:47.221538 [debug] [Thread-3 (]: Finished running node model.clinical_trials.gld_enriched_trials
[0m15:30:47.226939 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:30:47.228911 [debug] [Thread-7 (]: Marking all children of 'model.clinical_trials.gld_conditions' to be skipped because of status 'error'.  Reason: Database Error in model gld_conditions (models/gold/gld_conditions.sql)
  syntax error at or near ";"
  LINE 15: from "clinical_trials"."silver"."slv_conditions";
                                                           ^
  compiled code at target/run/clinical_trials/models/gold/gld_conditions.sql.
[0m15:30:47.230590 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:30:47.232658 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */
alter table "clinical_trials"."gold"."gld_countries__dbt_tmp" rename to "gld_countries"
[0m15:30:47.234670 [debug] [Thread-7 (]: Marking all children of 'model.clinical_trials.gld_enriched_trials' to be skipped because of status 'error'.  Reason: Database Error in model gld_enriched_trials (models/gold/gld_enriched_trials.sql)
  relation "countries" does not exist
  LINE 33: left join countries co on co.nct_id = p.nct_id
                     ^
  compiled code at target/run/clinical_trials/models/gold/gld_enriched_trials.sql.
[0m15:30:47.235758 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: COMMIT
[0m15:30:47.237628 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:30:47.246345 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: COMMIT
[0m15:30:47.247011 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m15:30:47.247942 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:30:47.256053 [debug] [Thread-4 (]: Applying DROP to: "clinical_trials"."gold"."gld_interventions__dbt_backup"
[0m15:30:47.257348 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: COMMIT
[0m15:30:47.264740 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:30:47.266818 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_interventions"} */
drop table if exists "clinical_trials"."gold"."gld_interventions__dbt_backup" cascade
[0m15:30:47.267604 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:30:47.269260 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:30:47.273287 [debug] [Thread-2 (]: Applying DROP to: "clinical_trials"."gold"."gld_countries__dbt_backup"
[0m15:30:47.278207 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: Close
[0m15:30:47.279876 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:30:47.281265 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036c276e-904f-469e-b2f0-b378140b9e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff99c8129f0>]}
[0m15:30:47.282354 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */
drop table if exists "clinical_trials"."gold"."gld_countries__dbt_backup" cascade
[0m15:30:47.284198 [info ] [Thread-4 (]: 4 of 4 OK created sql table model gold.gld_interventions ....................... [[32mSELECT 1928[0m in 0.31s]
[0m15:30:47.287462 [debug] [Thread-4 (]: Finished running node model.clinical_trials.gld_interventions
[0m15:30:47.294626 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.009 seconds
[0m15:30:47.298343 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: Close
[0m15:30:47.300735 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036c276e-904f-469e-b2f0-b378140b9e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98a204890>]}
[0m15:30:47.303080 [info ] [Thread-2 (]: 2 of 4 OK created sql table model gold.gld_countries ........................... [[32mSELECT 1557[0m in 0.33s]
[0m15:30:47.305480 [debug] [Thread-2 (]: Finished running node model.clinical_trials.gld_countries
[0m15:30:47.309473 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:47.311120 [debug] [MainThread]: On master: BEGIN
[0m15:30:47.312532 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:30:47.320246 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:30:47.321516 [debug] [MainThread]: On master: COMMIT
[0m15:30:47.322898 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:47.324091 [debug] [MainThread]: On master: COMMIT
[0m15:30:47.325427 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:30:47.326417 [debug] [MainThread]: On master: Close
[0m15:30:47.327987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:47.329689 [debug] [MainThread]: Connection 'model.clinical_trials.gld_countries' was properly closed.
[0m15:30:47.331047 [debug] [MainThread]: Connection 'model.clinical_trials.gld_conditions' was properly closed.
[0m15:30:47.332542 [debug] [MainThread]: Connection 'model.clinical_trials.gld_enriched_trials' was properly closed.
[0m15:30:47.333831 [debug] [MainThread]: Connection 'model.clinical_trials.gld_interventions' was properly closed.
[0m15:30:47.335013 [info ] [MainThread]: 
[0m15:30:47.336308 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m15:30:47.339455 [debug] [MainThread]: Command end result
[0m15:30:47.388757 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:30:47.395931 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:30:47.413215 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:30:47.414560 [info ] [MainThread]: 
[0m15:30:47.415978 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:30:47.417689 [info ] [MainThread]: 
[0m15:30:47.419151 [error] [MainThread]:   Database Error in model gld_conditions (models/gold/gld_conditions.sql)
  syntax error at or near ";"
  LINE 15: from "clinical_trials"."silver"."slv_conditions";
                                                           ^
  compiled code at target/run/clinical_trials/models/gold/gld_conditions.sql
[0m15:30:47.420787 [info ] [MainThread]: 
[0m15:30:47.422425 [error] [MainThread]:   Database Error in model gld_enriched_trials (models/gold/gld_enriched_trials.sql)
  relation "countries" does not exist
  LINE 33: left join countries co on co.nct_id = p.nct_id
                     ^
  compiled code at target/run/clinical_trials/models/gold/gld_enriched_trials.sql
[0m15:30:47.424040 [info ] [MainThread]: 
[0m15:30:47.425920 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m15:30:47.428770 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.3563733, "process_in_blocks": "0", "process_kernel_time": 0.602843, "process_mem_max_rss": "117008", "process_out_blocks": "1600", "process_user_time": 3.2654}
[0m15:30:47.430703 [debug] [MainThread]: Command `dbt run` failed at 15:30:47.430442 after 2.36 seconds
[0m15:30:47.432283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff99aaba600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff998e983e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff99b5a42f0>]}
[0m15:30:47.433698 [debug] [MainThread]: Flushing usage events
[0m15:30:47.907307 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:31:00.908587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8367aae3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8367112840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8366fdb5c0>]}


============================== 15:31:00.918005 | 66f056b3-e5c6-4f74-bbbd-b4cf9262b0f4 ==============================
[0m15:31:00.918005 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:31:00.919368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select path:models/gold', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:31:01.145455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66f056b3-e5c6-4f74-bbbd-b4cf9262b0f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8368cf7620>]}
[0m15:31:01.216425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66f056b3-e5c6-4f74-bbbd-b4cf9262b0f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836798d1c0>]}
[0m15:31:01.218612 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:31:01.294748 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:31:01.586413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:31:01.587823 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/gold/gld_conditions.sql
[0m15:31:01.933561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66f056b3-e5c6-4f74-bbbd-b4cf9262b0f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83650c9820>]}
[0m15:31:02.076363 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:31:02.087864 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:31:02.152231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66f056b3-e5c6-4f74-bbbd-b4cf9262b0f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83652f64e0>]}
[0m15:31:02.154870 [info ] [MainThread]: Found 1 seed, 8 models, 1 source, 430 macros
[0m15:31:02.157203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66f056b3-e5c6-4f74-bbbd-b4cf9262b0f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83653cb1a0>]}
[0m15:31:02.169230 [info ] [MainThread]: 
[0m15:31:02.171324 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:31:02.173656 [info ] [MainThread]: 
[0m15:31:02.176549 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:31:02.186346 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m15:31:02.264571 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m15:31:02.266237 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m15:31:02.268484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:02.280735 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.012 seconds
[0m15:31:02.283989 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m15:31:02.288663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_gold)
[0m15:31:02.290151 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_silver'
[0m15:31:02.300844 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:31:02.308246 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:31:02.310200 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m15:31:02.311891 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m15:31:02.313466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:31:02.315908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:02.330223 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m15:31:02.332549 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m15:31:02.333901 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:31:02.335298 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:31:02.336715 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m15:31:02.338481 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m15:31:02.343069 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m15:31:02.347934 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m15:31:02.348824 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.008 seconds
[0m15:31:02.350858 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m15:31:02.355420 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m15:31:02.360736 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m15:31:02.371336 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:02.372575 [debug] [MainThread]: On master: BEGIN
[0m15:31:02.373620 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:31:02.382756 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m15:31:02.384347 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:02.385621 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:31:02.395666 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m15:31:02.400028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66f056b3-e5c6-4f74-bbbd-b4cf9262b0f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835e726150>]}
[0m15:31:02.402125 [debug] [MainThread]: On master: ROLLBACK
[0m15:31:02.404243 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:02.406612 [debug] [MainThread]: On master: BEGIN
[0m15:31:02.409224 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:31:02.410830 [debug] [MainThread]: On master: COMMIT
[0m15:31:02.412002 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:02.413012 [debug] [MainThread]: On master: COMMIT
[0m15:31:02.414358 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:31:02.415359 [debug] [MainThread]: On master: Close
[0m15:31:02.420971 [debug] [Thread-1 (]: Began running node model.clinical_trials.gld_conditions
[0m15:31:02.421596 [debug] [Thread-2 (]: Began running node model.clinical_trials.gld_countries
[0m15:31:02.422140 [debug] [Thread-3 (]: Began running node model.clinical_trials.gld_enriched_trials
[0m15:31:02.423012 [debug] [Thread-4 (]: Began running node model.clinical_trials.gld_interventions
[0m15:31:02.424448 [info ] [Thread-1 (]: 1 of 4 START sql table model gold.gld_conditions ............................... [RUN]
[0m15:31:02.426326 [info ] [Thread-2 (]: 2 of 4 START sql table model gold.gld_countries ................................ [RUN]
[0m15:31:02.427901 [info ] [Thread-3 (]: 3 of 4 START sql table model gold.gld_enriched_trials .......................... [RUN]
[0m15:31:02.429342 [info ] [Thread-4 (]: 4 of 4 START sql table model gold.gld_interventions ............................ [RUN]
[0m15:31:02.431088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver, now model.clinical_trials.gld_conditions)
[0m15:31:02.432716 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_clinical_trials_gold, now model.clinical_trials.gld_countries)
[0m15:31:02.434362 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.clinical_trials.gld_enriched_trials'
[0m15:31:02.435943 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.clinical_trials.gld_interventions'
[0m15:31:02.437434 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.gld_conditions
[0m15:31:02.439007 [debug] [Thread-2 (]: Began compiling node model.clinical_trials.gld_countries
[0m15:31:02.440989 [debug] [Thread-3 (]: Began compiling node model.clinical_trials.gld_enriched_trials
[0m15:31:02.442614 [debug] [Thread-4 (]: Began compiling node model.clinical_trials.gld_interventions
[0m15:31:02.456062 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.gld_conditions"
[0m15:31:02.460538 [debug] [Thread-2 (]: Writing injected SQL for node "model.clinical_trials.gld_countries"
[0m15:31:02.465568 [debug] [Thread-3 (]: Writing injected SQL for node "model.clinical_trials.gld_enriched_trials"
[0m15:31:02.471457 [debug] [Thread-4 (]: Writing injected SQL for node "model.clinical_trials.gld_interventions"
[0m15:31:02.479759 [debug] [Thread-1 (]: Began executing node model.clinical_trials.gld_conditions
[0m15:31:02.480962 [debug] [Thread-2 (]: Began executing node model.clinical_trials.gld_countries
[0m15:31:02.482840 [debug] [Thread-3 (]: Began executing node model.clinical_trials.gld_enriched_trials
[0m15:31:02.489128 [debug] [Thread-4 (]: Began executing node model.clinical_trials.gld_interventions
[0m15:31:02.590497 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.gld_conditions"
[0m15:31:02.596506 [debug] [Thread-3 (]: Writing runtime sql for node "model.clinical_trials.gld_enriched_trials"
[0m15:31:02.599537 [debug] [Thread-2 (]: Writing runtime sql for node "model.clinical_trials.gld_countries"
[0m15:31:02.605217 [debug] [Thread-4 (]: Writing runtime sql for node "model.clinical_trials.gld_interventions"
[0m15:31:02.611916 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:31:02.613106 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:31:02.614057 [debug] [Thread-3 (]: Using postgres connection "model.clinical_trials.gld_enriched_trials"
[0m15:31:02.615252 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: BEGIN
[0m15:31:02.616261 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:31:02.617384 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: BEGIN
[0m15:31:02.619285 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: BEGIN
[0m15:31:02.620962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:02.622699 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: BEGIN
[0m15:31:02.624008 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:31:02.625356 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:31:02.627962 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:31:02.636166 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m15:31:02.638235 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m15:31:02.639113 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:31:02.639774 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m15:31:02.641164 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m15:31:02.641962 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:31:02.643243 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_conditions"} */

  
    

  create  table "clinical_trials"."gold"."gld_conditions__dbt_tmp"
  
  
    as
  
  (
    

select *
from "clinical_trials"."silver"."slv_conditions"
  );
  
[0m15:31:02.644309 [debug] [Thread-3 (]: Using postgres connection "model.clinical_trials.gld_enriched_trials"
[0m15:31:02.645241 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:31:02.646041 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */

  
    

  create  table "clinical_trials"."gold"."gld_countries__dbt_tmp"
  
  
    as
  
  (
    

select
  tc.nct_id,
  tc.country,
  cc.latitude,
  cc.longitude
from "clinical_trials"."silver"."slv_countries" tc
left join "clinical_trials"."silver"."country_codes" cc
  on lower(cc.country) = lower(tc.country)
  );
  
[0m15:31:02.647888 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_enriched_trials"} */

  
    

  create  table "clinical_trials"."gold"."gld_enriched_trials__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    nct_id,
    brief_title,
    study_type,
    status,
    phase,
    start_date,
    completion_date,
    co.country,
    cd.condition,
    iv.intervention,
    case
        when start_date is not null
        and completion_date is not null
        and completion_date >= start_date
        then round(((completion_date - start_date)::numeric / 365.25), 2)
        else null
    end as study_length_years
from "clinical_trials"."silver"."slv_processed_trials" p
left join countries co on co.nct_id = p.nct_id
left join conditions cd on cd.nct_id = p.nct_id
left join interventions iv on iv.nct_id = p.nct_id
  );
  
[0m15:31:02.649634 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_interventions"} */

  
    

  create  table "clinical_trials"."gold"."gld_interventions__dbt_tmp"
  
  
    as
  
  (
    

select *
from "clinical_trials"."silver"."slv_interventions"
  );
  
[0m15:31:02.653476 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "countries" does not exist
LINE 33: left join countries co on co.nct_id = p.nct_id
                   ^

[0m15:31:02.655600 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: ROLLBACK
[0m15:31:02.657730 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: Close
[0m15:31:02.663012 [debug] [Thread-3 (]: Database Error in model gld_enriched_trials (models/gold/gld_enriched_trials.sql)
  relation "countries" does not exist
  LINE 33: left join countries co on co.nct_id = p.nct_id
                     ^
  compiled code at target/run/clinical_trials/models/gold/gld_enriched_trials.sql
[0m15:31:02.664533 [debug] [Thread-1 (]: SQL status: SELECT 2168 in 0.017 seconds
[0m15:31:02.667657 [debug] [Thread-4 (]: SQL status: SELECT 1928 in 0.013 seconds
[0m15:31:02.668713 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66f056b3-e5c6-4f74-bbbd-b4cf9262b0f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83650c8d70>]}
[0m15:31:02.675206 [debug] [Thread-2 (]: SQL status: SELECT 1557 in 0.024 seconds
[0m15:31:02.680062 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:31:02.686169 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:31:02.688056 [error] [Thread-3 (]: 3 of 4 ERROR creating sql table model gold.gld_enriched_trials ................. [[31mERROR[0m in 0.23s]
[0m15:31:02.695243 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:31:02.696817 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_conditions"} */
alter table "clinical_trials"."gold"."gld_conditions__dbt_tmp" rename to "gld_conditions"
[0m15:31:02.698302 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_interventions"} */
alter table "clinical_trials"."gold"."gld_interventions" rename to "gld_interventions__dbt_backup"
[0m15:31:02.699915 [debug] [Thread-3 (]: Finished running node model.clinical_trials.gld_enriched_trials
[0m15:31:02.701189 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */
alter table "clinical_trials"."gold"."gld_countries" rename to "gld_countries__dbt_backup"
[0m15:31:02.702759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:02.703781 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:02.704941 [debug] [Thread-7 (]: Marking all children of 'model.clinical_trials.gld_enriched_trials' to be skipped because of status 'error'.  Reason: Database Error in model gld_enriched_trials (models/gold/gld_enriched_trials.sql)
  relation "countries" does not exist
  LINE 33: left join countries co on co.nct_id = p.nct_id
                     ^
  compiled code at target/run/clinical_trials/models/gold/gld_enriched_trials.sql.
[0m15:31:02.713009 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m15:31:02.735624 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: COMMIT
[0m15:31:02.739282 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:31:02.746271 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:31:02.747520 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:31:02.748747 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_interventions"} */
alter table "clinical_trials"."gold"."gld_interventions__dbt_tmp" rename to "gld_interventions"
[0m15:31:02.750148 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */
alter table "clinical_trials"."gold"."gld_countries__dbt_tmp" rename to "gld_countries"
[0m15:31:02.751495 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: COMMIT
[0m15:31:02.753049 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:02.754609 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:02.759601 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: COMMIT
[0m15:31:02.762900 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: COMMIT
[0m15:31:02.763439 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m15:31:02.764371 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:31:02.765614 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:31:02.776574 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."gold"."gld_conditions__dbt_backup"
[0m15:31:02.777998 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: COMMIT
[0m15:31:02.778967 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: COMMIT
[0m15:31:02.787107 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:31:02.789726 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_conditions"} */
drop table if exists "clinical_trials"."gold"."gld_conditions__dbt_backup" cascade
[0m15:31:02.790281 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m15:31:02.790766 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:31:02.791864 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:31:02.796403 [debug] [Thread-4 (]: Applying DROP to: "clinical_trials"."gold"."gld_interventions__dbt_backup"
[0m15:31:02.800423 [debug] [Thread-2 (]: Applying DROP to: "clinical_trials"."gold"."gld_countries__dbt_backup"
[0m15:31:02.805757 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: Close
[0m15:31:02.807262 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:31:02.808755 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:31:02.810412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66f056b3-e5c6-4f74-bbbd-b4cf9262b0f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8368cf6750>]}
[0m15:31:02.811490 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_interventions"} */
drop table if exists "clinical_trials"."gold"."gld_interventions__dbt_backup" cascade
[0m15:31:02.812806 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */
drop table if exists "clinical_trials"."gold"."gld_countries__dbt_backup" cascade
[0m15:31:02.814811 [info ] [Thread-1 (]: 1 of 4 OK created sql table model gold.gld_conditions .......................... [[32mSELECT 2168[0m in 0.38s]
[0m15:31:02.819785 [debug] [Thread-1 (]: Finished running node model.clinical_trials.gld_conditions
[0m15:31:02.821700 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m15:31:02.823655 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:31:02.827039 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: Close
[0m15:31:02.829999 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: Close
[0m15:31:02.832364 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66f056b3-e5c6-4f74-bbbd-b4cf9262b0f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835e7e07a0>]}
[0m15:31:02.834745 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66f056b3-e5c6-4f74-bbbd-b4cf9262b0f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835e7e3440>]}
[0m15:31:02.837042 [info ] [Thread-4 (]: 4 of 4 OK created sql table model gold.gld_interventions ....................... [[32mSELECT 1928[0m in 0.40s]
[0m15:31:02.839347 [info ] [Thread-2 (]: 2 of 4 OK created sql table model gold.gld_countries ........................... [[32mSELECT 1557[0m in 0.40s]
[0m15:31:02.841971 [debug] [Thread-4 (]: Finished running node model.clinical_trials.gld_interventions
[0m15:31:02.843889 [debug] [Thread-2 (]: Finished running node model.clinical_trials.gld_countries
[0m15:31:02.849276 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:02.850945 [debug] [MainThread]: On master: BEGIN
[0m15:31:02.852187 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:31:02.861807 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m15:31:02.863340 [debug] [MainThread]: On master: COMMIT
[0m15:31:02.864594 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:02.865770 [debug] [MainThread]: On master: COMMIT
[0m15:31:02.867343 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:31:02.868714 [debug] [MainThread]: On master: Close
[0m15:31:02.869873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:02.870789 [debug] [MainThread]: Connection 'model.clinical_trials.gld_countries' was properly closed.
[0m15:31:02.871830 [debug] [MainThread]: Connection 'model.clinical_trials.gld_conditions' was properly closed.
[0m15:31:02.872876 [debug] [MainThread]: Connection 'model.clinical_trials.gld_enriched_trials' was properly closed.
[0m15:31:02.874001 [debug] [MainThread]: Connection 'model.clinical_trials.gld_interventions' was properly closed.
[0m15:31:02.875241 [info ] [MainThread]: 
[0m15:31:02.876380 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m15:31:02.880361 [debug] [MainThread]: Command end result
[0m15:31:02.931327 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:31:02.938954 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:31:02.953703 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:31:02.954931 [info ] [MainThread]: 
[0m15:31:02.956218 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:31:02.957857 [info ] [MainThread]: 
[0m15:31:02.959811 [error] [MainThread]:   Database Error in model gld_enriched_trials (models/gold/gld_enriched_trials.sql)
  relation "countries" does not exist
  LINE 33: left join countries co on co.nct_id = p.nct_id
                     ^
  compiled code at target/run/clinical_trials/models/gold/gld_enriched_trials.sql
[0m15:31:02.961554 [info ] [MainThread]: 
[0m15:31:02.963519 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m15:31:02.966392 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1276097, "process_in_blocks": "0", "process_kernel_time": 0.434793, "process_mem_max_rss": "116960", "process_out_blocks": "1600", "process_user_time": 2.972773}
[0m15:31:02.968465 [debug] [MainThread]: Command `dbt run` failed at 15:31:02.968181 after 2.13 seconds
[0m15:31:02.969872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83675ee660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83672ec440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835cedd430>]}
[0m15:31:02.971262 [debug] [MainThread]: Flushing usage events
[0m15:31:03.410899 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:37:02.025741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4240dab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe425f11970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe42433a900>]}


============================== 15:37:02.033919 | 4569cc3c-9f42-4982-b3a2-a0e52066848c ==============================
[0m15:37:02.033919 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:37:02.036470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ls --select country_codes', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:37:02.387166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4569cc3c-9f42-4982-b3a2-a0e52066848c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe425d6b410>]}
[0m15:37:02.511713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4569cc3c-9f42-4982-b3a2-a0e52066848c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe425792180>]}
[0m15:37:02.514456 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:37:02.636679 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:37:03.002539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:37:03.004053 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:37:03.078206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4569cc3c-9f42-4982-b3a2-a0e52066848c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4225e0cb0>]}
[0m15:37:03.197202 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:37:03.207239 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:37:03.238496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4569cc3c-9f42-4982-b3a2-a0e52066848c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe42233d940>]}
[0m15:37:03.240522 [info ] [MainThread]: Found 1 seed, 8 models, 1 source, 430 macros
[0m15:37:03.242780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4569cc3c-9f42-4982-b3a2-a0e52066848c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe423e07f20>]}
[0m15:37:03.245769 [info ] [MainThread]: clinical_trials.country_codes
[0m15:37:03.248771 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.2976896, "process_in_blocks": "0", "process_kernel_time": 0.415661, "process_mem_max_rss": "99460", "process_out_blocks": "1512", "process_user_time": 2.632524}
[0m15:37:03.250946 [debug] [MainThread]: Command `dbt ls` succeeded at 15:37:03.250644 after 1.30 seconds
[0m15:37:03.252952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe424217ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe422295a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe422299dc0>]}
[0m15:37:03.254795 [debug] [MainThread]: Flushing usage events
[0m15:37:03.759605 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:37:29.669482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e60e99a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e5e3dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e61d66f0>]}


============================== 15:37:29.677508 | ae7ffde6-c834-4ba6-b919-9104ee9e223d ==============================
[0m15:37:29.677508 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:37:29.679434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select silver.slv_countries', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:37:29.965802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae7ffde6-c834-4ba6-b919-9104ee9e223d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e3fcc0b0>]}
[0m15:37:30.046317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae7ffde6-c834-4ba6-b919-9104ee9e223d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e5918440>]}
[0m15:37:30.048764 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:37:30.181851 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:37:30.484379 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:37:30.485571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:37:30.538068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae7ffde6-c834-4ba6-b919-9104ee9e223d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e40a96d0>]}
[0m15:37:30.641638 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:37:30.650126 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:37:30.699336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae7ffde6-c834-4ba6-b919-9104ee9e223d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e3d795b0>]}
[0m15:37:30.701095 [info ] [MainThread]: Found 1 seed, 8 models, 1 source, 430 macros
[0m15:37:30.702445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae7ffde6-c834-4ba6-b919-9104ee9e223d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e598b140>]}
[0m15:37:30.705381 [info ] [MainThread]: 
[0m15:37:30.706806 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:37:30.708509 [info ] [MainThread]: 
[0m15:37:30.710837 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:37:30.713848 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m15:37:30.783247 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m15:37:30.785126 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m15:37:30.786245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:30.800258 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.014 seconds
[0m15:37:30.803415 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m15:37:30.810390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_silver)
[0m15:37:30.811390 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_gold'
[0m15:37:30.819323 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:37:30.822795 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:37:30.824098 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m15:37:30.825111 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m15:37:30.826367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:30.827676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:30.836968 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:37:30.837549 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m15:37:30.838653 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:37:30.840005 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:37:30.841676 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m15:37:30.843049 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m15:37:30.848766 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m15:37:30.849522 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.004 seconds
[0m15:37:30.852208 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m15:37:30.855282 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m15:37:30.856708 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m15:37:30.857731 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m15:37:30.870253 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:30.871715 [debug] [MainThread]: On master: BEGIN
[0m15:37:30.872900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:37:30.881353 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:37:30.882413 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:30.883225 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:37:30.891886 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m15:37:30.894717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae7ffde6-c834-4ba6-b919-9104ee9e223d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e4075580>]}
[0m15:37:30.895912 [debug] [MainThread]: On master: ROLLBACK
[0m15:37:30.897121 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:30.898345 [debug] [MainThread]: On master: BEGIN
[0m15:37:30.900112 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:37:30.901297 [debug] [MainThread]: On master: COMMIT
[0m15:37:30.902590 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:30.903841 [debug] [MainThread]: On master: COMMIT
[0m15:37:30.904982 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:37:30.906124 [debug] [MainThread]: On master: Close
[0m15:37:30.912310 [debug] [Thread-1 (]: Began running node model.clinical_trials.slv_countries
[0m15:37:30.913848 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.slv_countries .............................. [RUN]
[0m15:37:30.915210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver, now model.clinical_trials.slv_countries)
[0m15:37:30.916330 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.slv_countries
[0m15:37:30.925644 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.slv_countries"
[0m15:37:30.933401 [debug] [Thread-1 (]: Began executing node model.clinical_trials.slv_countries
[0m15:37:30.983007 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.slv_countries"
[0m15:37:30.993798 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv_countries"
[0m15:37:30.995554 [debug] [Thread-1 (]: On model.clinical_trials.slv_countries: BEGIN
[0m15:37:30.997235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:31.004892 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:37:31.006066 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv_countries"
[0m15:37:31.007589 [debug] [Thread-1 (]: On model.clinical_trials.slv_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv_countries"} */

  
    

  create  table "clinical_trials"."silver"."slv_countries__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  p.nct_id,
  nullif(trim(x), '') as country
from "clinical_trials"."bronze"."raw_trials" p,
lateral regexp_split_to_table(p.countries, '\s*[;,]\s*') as x
where p.countries is not null and p.countries <> ''
  and nullif(trim(x), '') is not null
  );
  
[0m15:37:31.188461 [debug] [Thread-1 (]: SQL status: SELECT 1557 in 0.180 seconds
[0m15:37:31.196265 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv_countries"
[0m15:37:31.197690 [debug] [Thread-1 (]: On model.clinical_trials.slv_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv_countries"} */
alter table "clinical_trials"."silver"."slv_countries" rename to "slv_countries__dbt_backup"
[0m15:37:31.199951 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:37:31.204619 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv_countries"
[0m15:37:31.205840 [debug] [Thread-1 (]: On model.clinical_trials.slv_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv_countries"} */
alter table "clinical_trials"."silver"."slv_countries__dbt_tmp" rename to "slv_countries"
[0m15:37:31.207828 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:37:31.230777 [debug] [Thread-1 (]: On model.clinical_trials.slv_countries: COMMIT
[0m15:37:31.232105 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv_countries"
[0m15:37:31.232926 [debug] [Thread-1 (]: On model.clinical_trials.slv_countries: COMMIT
[0m15:37:31.244603 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m15:37:31.254854 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."silver"."slv_countries__dbt_backup"
[0m15:37:31.265166 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.slv_countries"
[0m15:37:31.266777 [debug] [Thread-1 (]: On model.clinical_trials.slv_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.slv_countries"} */
drop table if exists "clinical_trials"."silver"."slv_countries__dbt_backup" cascade
[0m15:37:31.272851 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:37:31.276985 [debug] [Thread-1 (]: On model.clinical_trials.slv_countries: Close
[0m15:37:31.280325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae7ffde6-c834-4ba6-b919-9104ee9e223d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e63de960>]}
[0m15:37:31.281919 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.slv_countries ......................... [[32mSELECT 1557[0m in 0.36s]
[0m15:37:31.283999 [debug] [Thread-1 (]: Finished running node model.clinical_trials.slv_countries
[0m15:37:31.288618 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:31.290501 [debug] [MainThread]: On master: BEGIN
[0m15:37:31.292009 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:37:31.300418 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:37:31.301836 [debug] [MainThread]: On master: COMMIT
[0m15:37:31.302962 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:31.303943 [debug] [MainThread]: On master: COMMIT
[0m15:37:31.305051 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:37:31.306148 [debug] [MainThread]: On master: Close
[0m15:37:31.308290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:31.309832 [debug] [MainThread]: Connection 'model.clinical_trials.slv_countries' was properly closed.
[0m15:37:31.310946 [debug] [MainThread]: Connection 'list_clinical_trials_gold' was properly closed.
[0m15:37:31.311975 [info ] [MainThread]: 
[0m15:37:31.313667 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m15:37:31.316218 [debug] [MainThread]: Command end result
[0m15:37:31.365388 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:37:31.373350 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:37:31.387564 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:37:31.388988 [info ] [MainThread]: 
[0m15:37:31.390394 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:37:31.391889 [info ] [MainThread]: 
[0m15:37:31.393609 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:37:31.396373 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7994974, "process_in_blocks": "0", "process_kernel_time": 0.483499, "process_mem_max_rss": "110212", "process_out_blocks": "1600", "process_user_time": 2.679395}
[0m15:37:31.398883 [debug] [MainThread]: Command `dbt run` succeeded at 15:37:31.398474 after 1.80 seconds
[0m15:37:31.400496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e9056b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e5e67fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e5e67f50>]}
[0m15:37:31.401922 [debug] [MainThread]: Flushing usage events
[0m15:37:31.872437 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:37:38.754397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8829e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc883d8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8698f7a0>]}


============================== 15:37:38.762050 | c98f84f1-9ccd-46d1-8969-96d466324df3 ==============================
[0m15:37:38.762050 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:37:38.763425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select gold.gld_countries', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:37:39.015750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c98f84f1-9ccd-46d1-8969-96d466324df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8835b890>]}
[0m15:37:39.102822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c98f84f1-9ccd-46d1-8969-96d466324df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc86fd90a0>]}
[0m15:37:39.105065 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:37:39.194260 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:37:39.537680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:37:39.539329 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:37:39.595427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c98f84f1-9ccd-46d1-8969-96d466324df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc84bd5a60>]}
[0m15:37:39.722390 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:37:39.732488 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:37:39.784750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c98f84f1-9ccd-46d1-8969-96d466324df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc848cb950>]}
[0m15:37:39.786605 [info ] [MainThread]: Found 1 seed, 8 models, 1 source, 430 macros
[0m15:37:39.788428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c98f84f1-9ccd-46d1-8969-96d466324df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc84c01970>]}
[0m15:37:39.792305 [info ] [MainThread]: 
[0m15:37:39.794333 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:37:39.797018 [info ] [MainThread]: 
[0m15:37:39.799592 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:37:39.802415 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m15:37:39.865029 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m15:37:39.866470 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m15:37:39.867514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:39.876408 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m15:37:39.878943 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m15:37:39.885947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_silver)
[0m15:37:39.887320 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_gold'
[0m15:37:39.896839 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:37:39.899918 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:37:39.901300 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m15:37:39.902400 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m15:37:39.903454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:39.904356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:39.915419 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m15:37:39.915995 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m15:37:39.917203 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:37:39.918651 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:37:39.919947 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m15:37:39.921434 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m15:37:39.928203 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.003 seconds
[0m15:37:39.929618 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m15:37:39.932826 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m15:37:39.936099 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m15:37:39.938193 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m15:37:39.939350 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m15:37:39.953163 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:39.955135 [debug] [MainThread]: On master: BEGIN
[0m15:37:39.956595 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:37:39.967927 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m15:37:39.969697 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:39.971167 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:37:39.980677 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m15:37:39.983994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c98f84f1-9ccd-46d1-8969-96d466324df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc863d80b0>]}
[0m15:37:39.985745 [debug] [MainThread]: On master: ROLLBACK
[0m15:37:39.987512 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:39.988902 [debug] [MainThread]: On master: BEGIN
[0m15:37:39.990910 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:37:39.992318 [debug] [MainThread]: On master: COMMIT
[0m15:37:39.993729 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:39.995282 [debug] [MainThread]: On master: COMMIT
[0m15:37:39.997325 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:37:39.998925 [debug] [MainThread]: On master: Close
[0m15:37:40.003776 [debug] [Thread-1 (]: Began running node model.clinical_trials.gld_countries
[0m15:37:40.005254 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.gld_countries ................................ [RUN]
[0m15:37:40.006740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_gold, now model.clinical_trials.gld_countries)
[0m15:37:40.008200 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.gld_countries
[0m15:37:40.018540 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.gld_countries"
[0m15:37:40.030554 [debug] [Thread-1 (]: Began executing node model.clinical_trials.gld_countries
[0m15:37:40.085376 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.gld_countries"
[0m15:37:40.094841 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:37:40.096651 [debug] [Thread-1 (]: On model.clinical_trials.gld_countries: BEGIN
[0m15:37:40.098040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:40.106176 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:37:40.107802 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:37:40.109810 [debug] [Thread-1 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */

  
    

  create  table "clinical_trials"."gold"."gld_countries__dbt_tmp"
  
  
    as
  
  (
    

select
  tc.nct_id,
  tc.country,
  cc.latitude,
  cc.longitude
from "clinical_trials"."silver"."slv_countries" tc
left join "clinical_trials"."silver"."country_codes" cc
  on lower(cc.country) = lower(tc.country)
  );
  
[0m15:37:40.125283 [debug] [Thread-1 (]: SQL status: SELECT 1557 in 0.014 seconds
[0m15:37:40.134039 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:37:40.135651 [debug] [Thread-1 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */
alter table "clinical_trials"."gold"."gld_countries" rename to "gld_countries__dbt_backup"
[0m15:37:40.137408 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:37:40.141644 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:37:40.143255 [debug] [Thread-1 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */
alter table "clinical_trials"."gold"."gld_countries__dbt_tmp" rename to "gld_countries"
[0m15:37:40.145258 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:37:40.170574 [debug] [Thread-1 (]: On model.clinical_trials.gld_countries: COMMIT
[0m15:37:40.172463 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:37:40.174510 [debug] [Thread-1 (]: On model.clinical_trials.gld_countries: COMMIT
[0m15:37:40.179112 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:37:40.192241 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."gold"."gld_countries__dbt_backup"
[0m15:37:40.199976 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:37:40.201902 [debug] [Thread-1 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */
drop table if exists "clinical_trials"."gold"."gld_countries__dbt_backup" cascade
[0m15:37:40.207602 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:37:40.211729 [debug] [Thread-1 (]: On model.clinical_trials.gld_countries: Close
[0m15:37:40.215236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c98f84f1-9ccd-46d1-8969-96d466324df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc86f2e2a0>]}
[0m15:37:40.217700 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.gld_countries ........................... [[32mSELECT 1557[0m in 0.21s]
[0m15:37:40.220545 [debug] [Thread-1 (]: Finished running node model.clinical_trials.gld_countries
[0m15:37:40.225222 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:40.226544 [debug] [MainThread]: On master: BEGIN
[0m15:37:40.227738 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:37:40.237898 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m15:37:40.239711 [debug] [MainThread]: On master: COMMIT
[0m15:37:40.241254 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:40.242338 [debug] [MainThread]: On master: COMMIT
[0m15:37:40.243669 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:37:40.244789 [debug] [MainThread]: On master: Close
[0m15:37:40.246806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:40.248678 [debug] [MainThread]: Connection 'list_clinical_trials_silver' was properly closed.
[0m15:37:40.250547 [debug] [MainThread]: Connection 'model.clinical_trials.gld_countries' was properly closed.
[0m15:37:40.252329 [info ] [MainThread]: 
[0m15:37:40.253843 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m15:37:40.256640 [debug] [MainThread]: Command end result
[0m15:37:40.311297 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:37:40.319136 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:37:40.334150 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:37:40.335578 [info ] [MainThread]: 
[0m15:37:40.337381 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:37:40.338794 [info ] [MainThread]: 
[0m15:37:40.340514 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:37:40.343708 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6689639, "process_in_blocks": "0", "process_kernel_time": 0.320802, "process_mem_max_rss": "108628", "process_out_blocks": "1600", "process_user_time": 2.676693}
[0m15:37:40.345734 [debug] [MainThread]: Command `dbt run` succeeded at 15:37:40.345478 after 1.67 seconds
[0m15:37:40.347302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8829e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc86468380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc84bd5a00>]}
[0m15:37:40.348759 [debug] [MainThread]: Flushing usage events
[0m15:37:40.773511 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:37:55.514499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66c2bf290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66c2bdaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66c2be420>]}


============================== 15:37:55.522226 | 292e6a09-fe30-400d-aea9-8c3c330d435a ==============================
[0m15:37:55.522226 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:37:55.524208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select path:models/gold', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:37:55.807805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '292e6a09-fe30-400d-aea9-8c3c330d435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66bf3dca0>]}
[0m15:37:55.871281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '292e6a09-fe30-400d-aea9-8c3c330d435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66c4429f0>]}
[0m15:37:55.873044 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:37:55.958039 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:37:56.257373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:37:56.258759 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:37:56.311820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '292e6a09-fe30-400d-aea9-8c3c330d435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66a4f52b0>]}
[0m15:37:56.432186 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:37:56.440526 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:37:56.491404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '292e6a09-fe30-400d-aea9-8c3c330d435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66a1ed610>]}
[0m15:37:56.493358 [info ] [MainThread]: Found 1 seed, 8 models, 1 source, 430 macros
[0m15:37:56.495412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '292e6a09-fe30-400d-aea9-8c3c330d435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66a1d9ee0>]}
[0m15:37:56.506074 [info ] [MainThread]: 
[0m15:37:56.507883 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:37:56.509851 [info ] [MainThread]: 
[0m15:37:56.512466 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:37:56.523493 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m15:37:56.589548 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m15:37:56.591078 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m15:37:56.592255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:56.603990 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.012 seconds
[0m15:37:56.606580 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m15:37:56.610250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_silver)
[0m15:37:56.611161 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_gold'
[0m15:37:56.621247 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:37:56.624890 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:37:56.626170 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m15:37:56.628088 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m15:37:56.629526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:56.630794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:56.638535 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:37:56.639202 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:37:56.640085 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:37:56.641091 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:37:56.642268 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m15:37:56.643458 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m15:37:56.647603 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.003 seconds
[0m15:37:56.648330 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m15:37:56.650755 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m15:37:56.653802 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m15:37:56.655205 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m15:37:56.656150 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m15:37:56.671313 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:56.672796 [debug] [MainThread]: On master: BEGIN
[0m15:37:56.673796 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:37:56.682414 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:37:56.684428 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:56.685693 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:37:56.694463 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m15:37:56.699320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '292e6a09-fe30-400d-aea9-8c3c330d435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66bd99670>]}
[0m15:37:56.701485 [debug] [MainThread]: On master: ROLLBACK
[0m15:37:56.703007 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:56.703948 [debug] [MainThread]: On master: BEGIN
[0m15:37:56.705978 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:37:56.707234 [debug] [MainThread]: On master: COMMIT
[0m15:37:56.708424 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:56.709520 [debug] [MainThread]: On master: COMMIT
[0m15:37:56.710843 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:37:56.711864 [debug] [MainThread]: On master: Close
[0m15:37:56.718520 [debug] [Thread-1 (]: Began running node model.clinical_trials.gld_conditions
[0m15:37:56.719077 [debug] [Thread-2 (]: Began running node model.clinical_trials.gld_countries
[0m15:37:56.719552 [debug] [Thread-3 (]: Began running node model.clinical_trials.gld_enriched_trials
[0m15:37:56.720125 [debug] [Thread-4 (]: Began running node model.clinical_trials.gld_interventions
[0m15:37:56.721127 [info ] [Thread-1 (]: 1 of 4 START sql table model gold.gld_conditions ............................... [RUN]
[0m15:37:56.722592 [info ] [Thread-2 (]: 2 of 4 START sql table model gold.gld_countries ................................ [RUN]
[0m15:37:56.724219 [info ] [Thread-3 (]: 3 of 4 START sql table model gold.gld_enriched_trials .......................... [RUN]
[0m15:37:56.725975 [info ] [Thread-4 (]: 4 of 4 START sql table model gold.gld_interventions ............................ [RUN]
[0m15:37:56.727559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_gold, now model.clinical_trials.gld_conditions)
[0m15:37:56.729601 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver, now model.clinical_trials.gld_countries)
[0m15:37:56.731527 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.clinical_trials.gld_enriched_trials'
[0m15:37:56.733137 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.clinical_trials.gld_interventions'
[0m15:37:56.734686 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.gld_conditions
[0m15:37:56.736354 [debug] [Thread-2 (]: Began compiling node model.clinical_trials.gld_countries
[0m15:37:56.737658 [debug] [Thread-3 (]: Began compiling node model.clinical_trials.gld_enriched_trials
[0m15:37:56.738752 [debug] [Thread-4 (]: Began compiling node model.clinical_trials.gld_interventions
[0m15:37:56.752388 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.gld_conditions"
[0m15:37:56.757071 [debug] [Thread-2 (]: Writing injected SQL for node "model.clinical_trials.gld_countries"
[0m15:37:56.760958 [debug] [Thread-3 (]: Writing injected SQL for node "model.clinical_trials.gld_enriched_trials"
[0m15:37:56.766146 [debug] [Thread-4 (]: Writing injected SQL for node "model.clinical_trials.gld_interventions"
[0m15:37:56.775180 [debug] [Thread-1 (]: Began executing node model.clinical_trials.gld_conditions
[0m15:37:56.776241 [debug] [Thread-2 (]: Began executing node model.clinical_trials.gld_countries
[0m15:37:56.783253 [debug] [Thread-3 (]: Began executing node model.clinical_trials.gld_enriched_trials
[0m15:37:56.784168 [debug] [Thread-4 (]: Began executing node model.clinical_trials.gld_interventions
[0m15:37:56.865911 [debug] [Thread-3 (]: Writing runtime sql for node "model.clinical_trials.gld_enriched_trials"
[0m15:37:56.868521 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.gld_conditions"
[0m15:37:56.872977 [debug] [Thread-2 (]: Writing runtime sql for node "model.clinical_trials.gld_countries"
[0m15:37:56.877138 [debug] [Thread-4 (]: Writing runtime sql for node "model.clinical_trials.gld_interventions"
[0m15:37:56.886024 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:37:56.887102 [debug] [Thread-3 (]: Using postgres connection "model.clinical_trials.gld_enriched_trials"
[0m15:37:56.887941 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:37:56.888890 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: BEGIN
[0m15:37:56.889871 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:37:56.890795 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: BEGIN
[0m15:37:56.892033 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: BEGIN
[0m15:37:56.893070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:56.894166 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: BEGIN
[0m15:37:56.895185 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:37:56.896187 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:37:56.898438 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:37:56.903577 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:37:56.904931 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:37:56.906140 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_conditions"} */

  
    

  create  table "clinical_trials"."gold"."gld_conditions__dbt_tmp"
  
  
    as
  
  (
    

select *
from "clinical_trials"."silver"."slv_conditions"
  );
  
[0m15:37:56.907342 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m15:37:56.908126 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m15:37:56.909254 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m15:37:56.910034 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:37:56.910972 [debug] [Thread-3 (]: Using postgres connection "model.clinical_trials.gld_enriched_trials"
[0m15:37:56.911930 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:37:56.913005 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */

  
    

  create  table "clinical_trials"."gold"."gld_countries__dbt_tmp"
  
  
    as
  
  (
    

select
  tc.nct_id,
  tc.country,
  cc.latitude,
  cc.longitude
from "clinical_trials"."silver"."slv_countries" tc
left join "clinical_trials"."silver"."country_codes" cc
  on lower(cc.country) = lower(tc.country)
  );
  
[0m15:37:56.914339 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_enriched_trials"} */

  
    

  create  table "clinical_trials"."gold"."gld_enriched_trials__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    nct_id,
    brief_title,
    study_type,
    status,
    phase,
    start_date,
    completion_date,
    co.country,
    cd.condition,
    iv.intervention,
    case
        when start_date is not null
        and completion_date is not null
        and completion_date >= start_date
        then round(((completion_date - start_date)::numeric / 365.25), 2)
        else null
    end as study_length_years
from "clinical_trials"."silver"."slv_processed_trials" p
left join countries co on co.nct_id = p.nct_id
left join conditions cd on cd.nct_id = p.nct_id
left join interventions iv on iv.nct_id = p.nct_id
  );
  
[0m15:37:56.915455 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_interventions"} */

  
    

  create  table "clinical_trials"."gold"."gld_interventions__dbt_tmp"
  
  
    as
  
  (
    

select *
from "clinical_trials"."silver"."slv_interventions"
  );
  
[0m15:37:56.918005 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "countries" does not exist
LINE 33: left join countries co on co.nct_id = p.nct_id
                   ^

[0m15:37:56.919396 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: ROLLBACK
[0m15:37:56.921234 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: Close
[0m15:37:56.922486 [debug] [Thread-1 (]: SQL status: SELECT 2168 in 0.014 seconds
[0m15:37:56.931389 [debug] [Thread-4 (]: SQL status: SELECT 1928 in 0.013 seconds
[0m15:37:56.936313 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:37:56.937130 [debug] [Thread-2 (]: SQL status: SELECT 1557 in 0.021 seconds
[0m15:37:56.942730 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:37:56.945458 [debug] [Thread-3 (]: Database Error in model gld_enriched_trials (models/gold/gld_enriched_trials.sql)
  relation "countries" does not exist
  LINE 33: left join countries co on co.nct_id = p.nct_id
                     ^
  compiled code at target/run/clinical_trials/models/gold/gld_enriched_trials.sql
[0m15:37:56.946083 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_conditions"} */
alter table "clinical_trials"."gold"."gld_conditions" rename to "gld_conditions__dbt_backup"
[0m15:37:56.950541 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:37:56.951502 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_interventions"} */
alter table "clinical_trials"."gold"."gld_interventions" rename to "gld_interventions__dbt_backup"
[0m15:37:56.954839 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '292e6a09-fe30-400d-aea9-8c3c330d435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66c85ee40>]}
[0m15:37:56.956272 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:37:56.956719 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */
alter table "clinical_trials"."gold"."gld_countries" rename to "gld_countries__dbt_backup"
[0m15:37:56.958257 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:37:56.959381 [error] [Thread-3 (]: 3 of 4 ERROR creating sql table model gold.gld_enriched_trials ................. [[31mERROR[0m in 0.22s]
[0m15:37:56.964205 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:37:56.965969 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:37:56.970417 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:37:56.971945 [debug] [Thread-3 (]: Finished running node model.clinical_trials.gld_enriched_trials
[0m15:37:56.972939 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_conditions"} */
alter table "clinical_trials"."gold"."gld_conditions__dbt_tmp" rename to "gld_conditions"
[0m15:37:56.977266 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:37:56.978735 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_interventions"} */
alter table "clinical_trials"."gold"."gld_interventions__dbt_tmp" rename to "gld_interventions"
[0m15:37:56.980654 [debug] [Thread-7 (]: Marking all children of 'model.clinical_trials.gld_enriched_trials' to be skipped because of status 'error'.  Reason: Database Error in model gld_enriched_trials (models/gold/gld_enriched_trials.sql)
  relation "countries" does not exist
  LINE 33: left join countries co on co.nct_id = p.nct_id
                     ^
  compiled code at target/run/clinical_trials/models/gold/gld_enriched_trials.sql.
[0m15:37:56.982767 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:37:56.983430 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */
alter table "clinical_trials"."gold"."gld_countries__dbt_tmp" rename to "gld_countries"
[0m15:37:56.985209 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:37:57.013643 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: COMMIT
[0m15:37:57.014384 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m15:37:57.016940 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: COMMIT
[0m15:37:57.018372 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:37:57.020590 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: COMMIT
[0m15:37:57.021675 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:37:57.022804 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: COMMIT
[0m15:37:57.023854 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:37:57.024848 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: COMMIT
[0m15:37:57.026684 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: COMMIT
[0m15:37:57.027348 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:37:57.029327 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m15:37:57.035252 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m15:37:57.039269 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."gold"."gld_conditions__dbt_backup"
[0m15:37:57.042633 [debug] [Thread-4 (]: Applying DROP to: "clinical_trials"."gold"."gld_interventions__dbt_backup"
[0m15:37:57.045697 [debug] [Thread-2 (]: Applying DROP to: "clinical_trials"."gold"."gld_countries__dbt_backup"
[0m15:37:57.055230 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:37:57.056333 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:37:57.057640 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:37:57.058706 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_conditions"} */
drop table if exists "clinical_trials"."gold"."gld_conditions__dbt_backup" cascade
[0m15:37:57.059781 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_interventions"} */
drop table if exists "clinical_trials"."gold"."gld_interventions__dbt_backup" cascade
[0m15:37:57.060781 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */
drop table if exists "clinical_trials"."gold"."gld_countries__dbt_backup" cascade
[0m15:37:57.066048 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:37:57.066691 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:37:57.067245 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m15:37:57.070459 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: Close
[0m15:37:57.072853 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: Close
[0m15:37:57.074914 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: Close
[0m15:37:57.076335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '292e6a09-fe30-400d-aea9-8c3c330d435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66dc8e4e0>]}
[0m15:37:57.077758 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '292e6a09-fe30-400d-aea9-8c3c330d435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66830b2f0>]}
[0m15:37:57.079359 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '292e6a09-fe30-400d-aea9-8c3c330d435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6693d1820>]}
[0m15:37:57.081245 [info ] [Thread-1 (]: 1 of 4 OK created sql table model gold.gld_conditions .......................... [[32mSELECT 2168[0m in 0.35s]
[0m15:37:57.082625 [info ] [Thread-2 (]: 2 of 4 OK created sql table model gold.gld_countries ........................... [[32mSELECT 1557[0m in 0.35s]
[0m15:37:57.084599 [info ] [Thread-4 (]: 4 of 4 OK created sql table model gold.gld_interventions ....................... [[32mSELECT 1928[0m in 0.35s]
[0m15:37:57.086114 [debug] [Thread-1 (]: Finished running node model.clinical_trials.gld_conditions
[0m15:37:57.087472 [debug] [Thread-2 (]: Finished running node model.clinical_trials.gld_countries
[0m15:37:57.088892 [debug] [Thread-4 (]: Finished running node model.clinical_trials.gld_interventions
[0m15:37:57.093032 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:57.093990 [debug] [MainThread]: On master: BEGIN
[0m15:37:57.094917 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:37:57.102964 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:37:57.104624 [debug] [MainThread]: On master: COMMIT
[0m15:37:57.105640 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:57.106673 [debug] [MainThread]: On master: COMMIT
[0m15:37:57.108011 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:37:57.109128 [debug] [MainThread]: On master: Close
[0m15:37:57.110271 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:57.111446 [debug] [MainThread]: Connection 'model.clinical_trials.gld_countries' was properly closed.
[0m15:37:57.112563 [debug] [MainThread]: Connection 'model.clinical_trials.gld_conditions' was properly closed.
[0m15:37:57.113651 [debug] [MainThread]: Connection 'model.clinical_trials.gld_enriched_trials' was properly closed.
[0m15:37:57.114586 [debug] [MainThread]: Connection 'model.clinical_trials.gld_interventions' was properly closed.
[0m15:37:57.115863 [info ] [MainThread]: 
[0m15:37:57.117186 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m15:37:57.120292 [debug] [MainThread]: Command end result
[0m15:37:57.167796 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:37:57.174507 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:37:57.189611 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:37:57.190929 [info ] [MainThread]: 
[0m15:37:57.192386 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:37:57.194068 [info ] [MainThread]: 
[0m15:37:57.195657 [error] [MainThread]:   Database Error in model gld_enriched_trials (models/gold/gld_enriched_trials.sql)
  relation "countries" does not exist
  LINE 33: left join countries co on co.nct_id = p.nct_id
                     ^
  compiled code at target/run/clinical_trials/models/gold/gld_enriched_trials.sql
[0m15:37:57.197283 [info ] [MainThread]: 
[0m15:37:57.198979 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m15:37:57.202101 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7721478, "process_in_blocks": "0", "process_kernel_time": 0.480594, "process_mem_max_rss": "111372", "process_out_blocks": "1600", "process_user_time": 3.109155}
[0m15:37:57.203745 [debug] [MainThread]: Command `dbt run` failed at 15:37:57.203517 after 1.77 seconds
[0m15:37:57.206113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66c016ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66a205a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66c87d430>]}
[0m15:37:57.207573 [debug] [MainThread]: Flushing usage events
[0m15:37:57.633436 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:51:14.546140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a41f784d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a42171370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a41f780b0>]}


============================== 15:51:14.558028 | 5bdecd18-599b-4cc6-9ed2-c5bf0e122796 ==============================
[0m15:51:14.558028 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:51:14.560281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select path:models/gold', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:51:14.865051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bdecd18-599b-4cc6-9ed2-c5bf0e122796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a42143bc0>]}
[0m15:51:14.952072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bdecd18-599b-4cc6-9ed2-c5bf0e122796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a423c2930>]}
[0m15:51:14.954630 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:51:15.059049 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:51:15.546830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:51:15.549317 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/gold/gld_enriched_trials.sql
[0m15:51:16.016894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bdecd18-599b-4cc6-9ed2-c5bf0e122796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a403257c0>]}
[0m15:51:16.207948 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:51:16.223009 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:51:16.317712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bdecd18-599b-4cc6-9ed2-c5bf0e122796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a405faab0>]}
[0m15:51:16.320854 [info ] [MainThread]: Found 1 seed, 8 models, 1 source, 430 macros
[0m15:51:16.323805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bdecd18-599b-4cc6-9ed2-c5bf0e122796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a406fe4b0>]}
[0m15:51:16.340272 [info ] [MainThread]: 
[0m15:51:16.343170 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:51:16.345507 [info ] [MainThread]: 
[0m15:51:16.348062 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:51:16.360949 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m15:51:16.491764 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m15:51:16.494108 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m15:51:16.495881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:16.544851 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.049 seconds
[0m15:51:16.549703 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m15:51:16.555392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_silver)
[0m15:51:16.556961 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_gold'
[0m15:51:16.569782 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:51:16.577193 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:51:16.578861 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m15:51:16.580529 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m15:51:16.582076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:16.583562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:16.596907 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m15:51:16.598323 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m15:51:16.599183 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:51:16.600274 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:51:16.601459 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m15:51:16.602826 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m15:51:16.611875 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m15:51:16.612826 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.008 seconds
[0m15:51:16.616404 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m15:51:16.620541 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m15:51:16.623514 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m15:51:16.625463 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m15:51:16.644388 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:16.647055 [debug] [MainThread]: On master: BEGIN
[0m15:51:16.648710 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:51:16.660048 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m15:51:16.662054 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:16.663828 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:51:16.676159 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m15:51:16.679298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bdecd18-599b-4cc6-9ed2-c5bf0e122796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3dae6630>]}
[0m15:51:16.680720 [debug] [MainThread]: On master: ROLLBACK
[0m15:51:16.682075 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:16.683099 [debug] [MainThread]: On master: BEGIN
[0m15:51:16.685114 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:51:16.686955 [debug] [MainThread]: On master: COMMIT
[0m15:51:16.688827 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:16.690358 [debug] [MainThread]: On master: COMMIT
[0m15:51:16.692267 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:51:16.693843 [debug] [MainThread]: On master: Close
[0m15:51:16.699782 [debug] [Thread-1 (]: Began running node model.clinical_trials.gld_conditions
[0m15:51:16.700611 [debug] [Thread-2 (]: Began running node model.clinical_trials.gld_countries
[0m15:51:16.701497 [debug] [Thread-3 (]: Began running node model.clinical_trials.gld_enriched_trials
[0m15:51:16.702447 [debug] [Thread-4 (]: Began running node model.clinical_trials.gld_interventions
[0m15:51:16.703845 [info ] [Thread-1 (]: 1 of 4 START sql table model gold.gld_conditions ............................... [RUN]
[0m15:51:16.706083 [info ] [Thread-2 (]: 2 of 4 START sql table model gold.gld_countries ................................ [RUN]
[0m15:51:16.709028 [info ] [Thread-3 (]: 3 of 4 START sql table model gold.gld_enriched_trials .......................... [RUN]
[0m15:51:16.711462 [info ] [Thread-4 (]: 4 of 4 START sql table model gold.gld_interventions ............................ [RUN]
[0m15:51:16.714328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver, now model.clinical_trials.gld_conditions)
[0m15:51:16.716649 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_clinical_trials_gold, now model.clinical_trials.gld_countries)
[0m15:51:16.718675 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.clinical_trials.gld_enriched_trials'
[0m15:51:16.720606 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.clinical_trials.gld_interventions'
[0m15:51:16.722542 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.gld_conditions
[0m15:51:16.724681 [debug] [Thread-2 (]: Began compiling node model.clinical_trials.gld_countries
[0m15:51:16.726968 [debug] [Thread-3 (]: Began compiling node model.clinical_trials.gld_enriched_trials
[0m15:51:16.728751 [debug] [Thread-4 (]: Began compiling node model.clinical_trials.gld_interventions
[0m15:51:16.745388 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.gld_conditions"
[0m15:51:16.751451 [debug] [Thread-2 (]: Writing injected SQL for node "model.clinical_trials.gld_countries"
[0m15:51:16.758016 [debug] [Thread-3 (]: Writing injected SQL for node "model.clinical_trials.gld_enriched_trials"
[0m15:51:16.765555 [debug] [Thread-4 (]: Writing injected SQL for node "model.clinical_trials.gld_interventions"
[0m15:51:16.776789 [debug] [Thread-1 (]: Began executing node model.clinical_trials.gld_conditions
[0m15:51:16.778741 [debug] [Thread-2 (]: Began executing node model.clinical_trials.gld_countries
[0m15:51:16.779785 [debug] [Thread-3 (]: Began executing node model.clinical_trials.gld_enriched_trials
[0m15:51:16.786561 [debug] [Thread-4 (]: Began executing node model.clinical_trials.gld_interventions
[0m15:51:16.907167 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.gld_conditions"
[0m15:51:16.916853 [debug] [Thread-2 (]: Writing runtime sql for node "model.clinical_trials.gld_countries"
[0m15:51:16.921115 [debug] [Thread-3 (]: Writing runtime sql for node "model.clinical_trials.gld_enriched_trials"
[0m15:51:16.922435 [debug] [Thread-4 (]: Writing runtime sql for node "model.clinical_trials.gld_interventions"
[0m15:51:16.935226 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:51:16.936525 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:51:16.938835 [debug] [Thread-3 (]: Using postgres connection "model.clinical_trials.gld_enriched_trials"
[0m15:51:16.939778 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: BEGIN
[0m15:51:16.942186 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: BEGIN
[0m15:51:16.943135 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:51:16.944832 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: BEGIN
[0m15:51:16.946554 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:51:16.948233 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:51:16.949930 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: BEGIN
[0m15:51:16.951533 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:51:16.955886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:16.963101 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m15:51:16.964043 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m15:51:16.965628 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:51:16.967504 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:51:16.969096 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m15:51:16.969833 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_interventions"} */

  
    

  create  table "clinical_trials"."gold"."gld_interventions__dbt_tmp"
  
  
    as
  
  (
    

select *
from "clinical_trials"."silver"."slv_interventions"
  );
  
[0m15:51:16.971757 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */

  
    

  create  table "clinical_trials"."gold"."gld_countries__dbt_tmp"
  
  
    as
  
  (
    

select
  tc.nct_id,
  tc.country,
  cc.latitude,
  cc.longitude
from "clinical_trials"."silver"."slv_countries" tc
left join "clinical_trials"."silver"."country_codes" cc
  on lower(cc.country) = lower(tc.country)
  );
  
[0m15:51:16.973254 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m15:51:16.973943 [debug] [Thread-3 (]: Using postgres connection "model.clinical_trials.gld_enriched_trials"
[0m15:51:16.985645 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:51:16.987825 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_enriched_trials"} */

  
    

  create  table "clinical_trials"."gold"."gld_enriched_trials__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    nct_id,
    brief_title,
    study_type,
    status,
    phase,
    start_date,
    completion_date,
    co.country,
    cd.condition,
    iv.intervention,
    case
        when start_date is not null
        and completion_date is not null
        and completion_date >= start_date
        then round(((completion_date - start_date)::numeric / 365.25), 2)
        else null
    end as study_length_years
from "clinical_trials"."silver"."slv_processed_trials"
  );
  
[0m15:51:16.989956 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_conditions"} */

  
    

  create  table "clinical_trials"."gold"."gld_conditions__dbt_tmp"
  
  
    as
  
  (
    

select *
from "clinical_trials"."silver"."slv_conditions"
  );
  
[0m15:51:16.994317 [debug] [Thread-3 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "co"
LINE 22:     co.country,
             ^

[0m15:51:16.997454 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: ROLLBACK
[0m15:51:17.000049 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: Close
[0m15:51:17.013850 [debug] [Thread-3 (]: Database Error in model gld_enriched_trials (models/gold/gld_enriched_trials.sql)
  missing FROM-clause entry for table "co"
  LINE 22:     co.country,
               ^
  compiled code at target/run/clinical_trials/models/gold/gld_enriched_trials.sql
[0m15:51:17.018168 [debug] [Thread-1 (]: SQL status: SELECT 2168 in 0.025 seconds
[0m15:51:17.019098 [debug] [Thread-4 (]: SQL status: SELECT 1928 in 0.043 seconds
[0m15:51:17.020442 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bdecd18-599b-4cc6-9ed2-c5bf0e122796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a42a6a8a0>]}
[0m15:51:17.033484 [debug] [Thread-2 (]: SQL status: SELECT 1557 in 0.056 seconds
[0m15:51:17.034738 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:51:17.040264 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:51:17.043026 [error] [Thread-3 (]: 3 of 4 ERROR creating sql table model gold.gld_enriched_trials ................. [[31mERROR[0m in 0.30s]
[0m15:51:17.051709 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:51:17.053413 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_conditions"} */
alter table "clinical_trials"."gold"."gld_conditions" rename to "gld_conditions__dbt_backup"
[0m15:51:17.055198 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_interventions"} */
alter table "clinical_trials"."gold"."gld_interventions" rename to "gld_interventions__dbt_backup"
[0m15:51:17.057857 [debug] [Thread-3 (]: Finished running node model.clinical_trials.gld_enriched_trials
[0m15:51:17.059931 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */
alter table "clinical_trials"."gold"."gld_countries" rename to "gld_countries__dbt_backup"
[0m15:51:17.062825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:51:17.065291 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:51:17.067167 [debug] [Thread-7 (]: Marking all children of 'model.clinical_trials.gld_enriched_trials' to be skipped because of status 'error'.  Reason: Database Error in model gld_enriched_trials (models/gold/gld_enriched_trials.sql)
  missing FROM-clause entry for table "co"
  LINE 22:     co.country,
               ^
  compiled code at target/run/clinical_trials/models/gold/gld_enriched_trials.sql.
[0m15:51:17.076021 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m15:51:17.077342 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:51:17.086008 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:51:17.096377 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:51:17.098044 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_conditions"} */
alter table "clinical_trials"."gold"."gld_conditions__dbt_tmp" rename to "gld_conditions"
[0m15:51:17.099695 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_interventions"} */
alter table "clinical_trials"."gold"."gld_interventions__dbt_tmp" rename to "gld_interventions"
[0m15:51:17.101654 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */
alter table "clinical_trials"."gold"."gld_countries__dbt_tmp" rename to "gld_countries"
[0m15:51:17.104291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:51:17.106555 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:51:17.108209 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:51:17.153621 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: COMMIT
[0m15:51:17.154515 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: COMMIT
[0m15:51:17.158688 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: COMMIT
[0m15:51:17.160981 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:51:17.162783 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:51:17.164480 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:51:17.166391 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: COMMIT
[0m15:51:17.168010 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: COMMIT
[0m15:51:17.169593 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: COMMIT
[0m15:51:17.180749 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m15:51:17.181872 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m15:51:17.182827 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m15:51:17.198594 [debug] [Thread-4 (]: Applying DROP to: "clinical_trials"."gold"."gld_interventions__dbt_backup"
[0m15:51:17.204648 [debug] [Thread-2 (]: Applying DROP to: "clinical_trials"."gold"."gld_countries__dbt_backup"
[0m15:51:17.213572 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."gold"."gld_conditions__dbt_backup"
[0m15:51:17.226881 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:51:17.228638 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:51:17.230594 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:51:17.232232 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_interventions"} */
drop table if exists "clinical_trials"."gold"."gld_interventions__dbt_backup" cascade
[0m15:51:17.233520 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */
drop table if exists "clinical_trials"."gold"."gld_countries__dbt_backup" cascade
[0m15:51:17.234993 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_conditions"} */
drop table if exists "clinical_trials"."gold"."gld_conditions__dbt_backup" cascade
[0m15:51:17.242162 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.005 seconds
[0m15:51:17.243422 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m15:51:17.244400 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:51:17.250997 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: Close
[0m15:51:17.253763 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: Close
[0m15:51:17.257028 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: Close
[0m15:51:17.258979 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bdecd18-599b-4cc6-9ed2-c5bf0e122796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3c0705c0>]}
[0m15:51:17.260627 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bdecd18-599b-4cc6-9ed2-c5bf0e122796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3c070b30>]}
[0m15:51:17.262325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bdecd18-599b-4cc6-9ed2-c5bf0e122796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3c070860>]}
[0m15:51:17.264305 [info ] [Thread-2 (]: 2 of 4 OK created sql table model gold.gld_countries ........................... [[32mSELECT 1557[0m in 0.54s]
[0m15:51:17.266472 [info ] [Thread-4 (]: 4 of 4 OK created sql table model gold.gld_interventions ....................... [[32mSELECT 1928[0m in 0.54s]
[0m15:51:17.268861 [info ] [Thread-1 (]: 1 of 4 OK created sql table model gold.gld_conditions .......................... [[32mSELECT 2168[0m in 0.55s]
[0m15:51:17.271853 [debug] [Thread-2 (]: Finished running node model.clinical_trials.gld_countries
[0m15:51:17.273917 [debug] [Thread-4 (]: Finished running node model.clinical_trials.gld_interventions
[0m15:51:17.275525 [debug] [Thread-1 (]: Finished running node model.clinical_trials.gld_conditions
[0m15:51:17.283517 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:17.286119 [debug] [MainThread]: On master: BEGIN
[0m15:51:17.288338 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:51:17.301204 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m15:51:17.303463 [debug] [MainThread]: On master: COMMIT
[0m15:51:17.305667 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:17.308118 [debug] [MainThread]: On master: COMMIT
[0m15:51:17.310348 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:51:17.311663 [debug] [MainThread]: On master: Close
[0m15:51:17.313019 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:17.314348 [debug] [MainThread]: Connection 'model.clinical_trials.gld_conditions' was properly closed.
[0m15:51:17.316259 [debug] [MainThread]: Connection 'model.clinical_trials.gld_countries' was properly closed.
[0m15:51:17.323071 [debug] [MainThread]: Connection 'model.clinical_trials.gld_enriched_trials' was properly closed.
[0m15:51:17.330155 [debug] [MainThread]: Connection 'model.clinical_trials.gld_interventions' was properly closed.
[0m15:51:17.333270 [info ] [MainThread]: 
[0m15:51:17.336071 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m15:51:17.351195 [debug] [MainThread]: Command end result
[0m15:51:17.434328 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:51:17.443772 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:51:17.459811 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:51:17.461586 [info ] [MainThread]: 
[0m15:51:17.463516 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:51:17.466229 [info ] [MainThread]: 
[0m15:51:17.468710 [error] [MainThread]:   Database Error in model gld_enriched_trials (models/gold/gld_enriched_trials.sql)
  missing FROM-clause entry for table "co"
  LINE 22:     co.country,
               ^
  compiled code at target/run/clinical_trials/models/gold/gld_enriched_trials.sql
[0m15:51:17.470967 [info ] [MainThread]: 
[0m15:51:17.473539 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m15:51:17.476973 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.0310857, "process_in_blocks": "0", "process_kernel_time": 1.139125, "process_mem_max_rss": "116268", "process_out_blocks": "1600", "process_user_time": 4.346664}
[0m15:51:17.479523 [debug] [MainThread]: Command `dbt run` failed at 15:51:17.479186 after 3.03 seconds
[0m15:51:17.481390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a41f793d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a403aed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a40314680>]}
[0m15:51:17.483756 [debug] [MainThread]: Flushing usage events
[0m15:51:18.010313 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:51:31.127716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2263e5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2276e24e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2259098e0>]}


============================== 15:51:31.137228 | d05ff31a-8677-4b29-b3d3-b1b83067b815 ==============================
[0m15:51:31.137228 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:51:31.140298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select path:models/gold', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:51:31.446438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd05ff31a-8677-4b29-b3d3-b1b83067b815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe223774890>]}
[0m15:51:31.539305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd05ff31a-8677-4b29-b3d3-b1b83067b815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe225133c80>]}
[0m15:51:31.541907 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:51:31.633752 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:51:32.109893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:51:32.112497 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/gold/gld_enriched_trials.sql
[0m15:51:32.527705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd05ff31a-8677-4b29-b3d3-b1b83067b815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe223451880>]}
[0m15:51:32.675464 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:51:32.686461 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:51:32.766199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd05ff31a-8677-4b29-b3d3-b1b83067b815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2235b22a0>]}
[0m15:51:32.768267 [info ] [MainThread]: Found 1 seed, 8 models, 1 source, 430 macros
[0m15:51:32.770264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd05ff31a-8677-4b29-b3d3-b1b83067b815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe221698b30>]}
[0m15:51:32.782852 [info ] [MainThread]: 
[0m15:51:32.785303 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:51:32.787869 [info ] [MainThread]: 
[0m15:51:32.791878 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:51:32.805617 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials'
[0m15:51:32.894001 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials"
[0m15:51:32.895751 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    select distinct nspname from pg_namespace
  
[0m15:51:32.897195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:32.912455 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.015 seconds
[0m15:51:32.915844 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m15:51:32.920591 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now list_clinical_trials_silver)
[0m15:51:32.922124 [debug] [ThreadPool]: Acquiring new postgres connection 'list_clinical_trials_gold'
[0m15:51:32.935395 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:51:32.941273 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:51:32.943285 [debug] [ThreadPool]: On list_clinical_trials_silver: BEGIN
[0m15:51:32.945423 [debug] [ThreadPool]: On list_clinical_trials_gold: BEGIN
[0m15:51:32.947197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:32.948903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:32.961026 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m15:51:32.962706 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m15:51:32.964146 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_silver"
[0m15:51:32.966139 [debug] [ThreadPool]: Using postgres connection "list_clinical_trials_gold"
[0m15:51:32.968449 [debug] [ThreadPool]: On list_clinical_trials_silver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_silver"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m15:51:32.970440 [debug] [ThreadPool]: On list_clinical_trials_gold: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "list_clinical_trials_gold"} */
select
      'clinical_trials' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'clinical_trials' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m15:51:32.976916 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.004 seconds
[0m15:51:32.978644 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m15:51:32.982170 [debug] [ThreadPool]: On list_clinical_trials_silver: ROLLBACK
[0m15:51:32.986761 [debug] [ThreadPool]: On list_clinical_trials_gold: ROLLBACK
[0m15:51:32.989801 [debug] [ThreadPool]: On list_clinical_trials_silver: Close
[0m15:51:32.992186 [debug] [ThreadPool]: On list_clinical_trials_gold: Close
[0m15:51:33.009633 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:33.012105 [debug] [MainThread]: On master: BEGIN
[0m15:51:33.015552 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:51:33.029850 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m15:51:33.031960 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:33.034177 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:51:33.051122 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m15:51:33.056282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd05ff31a-8677-4b29-b3d3-b1b83067b815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2253ba630>]}
[0m15:51:33.058834 [debug] [MainThread]: On master: ROLLBACK
[0m15:51:33.060983 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:33.062936 [debug] [MainThread]: On master: BEGIN
[0m15:51:33.065745 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:51:33.067612 [debug] [MainThread]: On master: COMMIT
[0m15:51:33.069294 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:33.070912 [debug] [MainThread]: On master: COMMIT
[0m15:51:33.073289 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:51:33.075467 [debug] [MainThread]: On master: Close
[0m15:51:33.083369 [debug] [Thread-1 (]: Began running node model.clinical_trials.gld_conditions
[0m15:51:33.084412 [debug] [Thread-2 (]: Began running node model.clinical_trials.gld_countries
[0m15:51:33.085382 [debug] [Thread-3 (]: Began running node model.clinical_trials.gld_enriched_trials
[0m15:51:33.086292 [debug] [Thread-4 (]: Began running node model.clinical_trials.gld_interventions
[0m15:51:33.088243 [info ] [Thread-1 (]: 1 of 4 START sql table model gold.gld_conditions ............................... [RUN]
[0m15:51:33.091562 [info ] [Thread-2 (]: 2 of 4 START sql table model gold.gld_countries ................................ [RUN]
[0m15:51:33.094560 [info ] [Thread-3 (]: 3 of 4 START sql table model gold.gld_enriched_trials .......................... [RUN]
[0m15:51:33.097493 [info ] [Thread-4 (]: 4 of 4 START sql table model gold.gld_interventions ............................ [RUN]
[0m15:51:33.100106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_clinical_trials_gold, now model.clinical_trials.gld_conditions)
[0m15:51:33.102954 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_clinical_trials_silver, now model.clinical_trials.gld_countries)
[0m15:51:33.106193 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.clinical_trials.gld_enriched_trials'
[0m15:51:33.109351 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.clinical_trials.gld_interventions'
[0m15:51:33.112121 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.gld_conditions
[0m15:51:33.114478 [debug] [Thread-2 (]: Began compiling node model.clinical_trials.gld_countries
[0m15:51:33.116963 [debug] [Thread-3 (]: Began compiling node model.clinical_trials.gld_enriched_trials
[0m15:51:33.119157 [debug] [Thread-4 (]: Began compiling node model.clinical_trials.gld_interventions
[0m15:51:33.135913 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.gld_conditions"
[0m15:51:33.143333 [debug] [Thread-2 (]: Writing injected SQL for node "model.clinical_trials.gld_countries"
[0m15:51:33.148933 [debug] [Thread-3 (]: Writing injected SQL for node "model.clinical_trials.gld_enriched_trials"
[0m15:51:33.155314 [debug] [Thread-4 (]: Writing injected SQL for node "model.clinical_trials.gld_interventions"
[0m15:51:33.168435 [debug] [Thread-2 (]: Began executing node model.clinical_trials.gld_countries
[0m15:51:33.170029 [debug] [Thread-4 (]: Began executing node model.clinical_trials.gld_interventions
[0m15:51:33.179119 [debug] [Thread-1 (]: Began executing node model.clinical_trials.gld_conditions
[0m15:51:33.185651 [debug] [Thread-3 (]: Began executing node model.clinical_trials.gld_enriched_trials
[0m15:51:33.346725 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.gld_conditions"
[0m15:51:33.356800 [debug] [Thread-4 (]: Writing runtime sql for node "model.clinical_trials.gld_interventions"
[0m15:51:33.360651 [debug] [Thread-2 (]: Writing runtime sql for node "model.clinical_trials.gld_countries"
[0m15:51:33.351497 [debug] [Thread-3 (]: Writing runtime sql for node "model.clinical_trials.gld_enriched_trials"
[0m15:51:33.374565 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:51:33.376739 [debug] [Thread-3 (]: Using postgres connection "model.clinical_trials.gld_enriched_trials"
[0m15:51:33.379201 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:51:33.380392 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: BEGIN
[0m15:51:33.382088 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:51:33.384575 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: BEGIN
[0m15:51:33.387018 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: BEGIN
[0m15:51:33.391830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:33.399377 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: BEGIN
[0m15:51:33.402009 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:51:33.404473 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:51:33.407916 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:51:33.419346 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m15:51:33.421324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m15:51:33.423520 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m15:51:33.424598 [debug] [Thread-3 (]: Using postgres connection "model.clinical_trials.gld_enriched_trials"
[0m15:51:33.426727 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m15:51:33.427938 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:51:33.430693 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:51:33.433220 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_enriched_trials"} */

  
    

  create  table "clinical_trials"."gold"."gld_enriched_trials__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    nct_id,
    brief_title,
    study_type,
    status,
    phase,
    start_date,
    completion_date,
    case
        when start_date is not null
        and completion_date is not null
        and completion_date >= start_date
        then round(((completion_date - start_date)::numeric / 365.25), 2)
        else null
    end as study_length_years
from "clinical_trials"."silver"."slv_processed_trials"
  );
  
[0m15:51:33.436804 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:51:33.439775 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_conditions"} */

  
    

  create  table "clinical_trials"."gold"."gld_conditions__dbt_tmp"
  
  
    as
  
  (
    

select *
from "clinical_trials"."silver"."slv_conditions"
  );
  
[0m15:51:33.452071 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */

  
    

  create  table "clinical_trials"."gold"."gld_countries__dbt_tmp"
  
  
    as
  
  (
    

select
  tc.nct_id,
  tc.country,
  cc.latitude,
  cc.longitude
from "clinical_trials"."silver"."slv_countries" tc
left join "clinical_trials"."silver"."country_codes" cc
  on lower(cc.country) = lower(tc.country)
  );
  
[0m15:51:33.460156 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_interventions"} */

  
    

  create  table "clinical_trials"."gold"."gld_interventions__dbt_tmp"
  
  
    as
  
  (
    

select *
from "clinical_trials"."silver"."slv_interventions"
  );
  
[0m15:51:33.484909 [debug] [Thread-1 (]: SQL status: SELECT 2168 in 0.022 seconds
[0m15:51:33.497229 [debug] [Thread-4 (]: SQL status: SELECT 1928 in 0.029 seconds
[0m15:51:33.498458 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:51:33.499408 [debug] [Thread-3 (]: SQL status: SELECT 1100 in 0.042 seconds
[0m15:51:33.500127 [debug] [Thread-2 (]: SQL status: SELECT 1557 in 0.035 seconds
[0m15:51:33.505019 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:51:33.506519 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_conditions"} */
alter table "clinical_trials"."gold"."gld_conditions" rename to "gld_conditions__dbt_backup"
[0m15:51:33.512101 [debug] [Thread-3 (]: Using postgres connection "model.clinical_trials.gld_enriched_trials"
[0m15:51:33.518223 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:51:33.520014 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_interventions"} */
alter table "clinical_trials"."gold"."gld_interventions" rename to "gld_interventions__dbt_backup"
[0m15:51:33.523212 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:51:33.524706 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_enriched_trials"} */
alter table "clinical_trials"."gold"."gld_enriched_trials__dbt_tmp" rename to "gld_enriched_trials"
[0m15:51:33.526189 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */
alter table "clinical_trials"."gold"."gld_countries" rename to "gld_countries__dbt_backup"
[0m15:51:33.528704 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:51:33.533109 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:51:33.535892 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:51:33.538139 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:51:33.544215 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:51:33.545699 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_conditions"} */
alter table "clinical_trials"."gold"."gld_conditions__dbt_tmp" rename to "gld_conditions"
[0m15:51:33.578671 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:51:33.587772 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: COMMIT
[0m15:51:33.589204 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_interventions"} */
alter table "clinical_trials"."gold"."gld_interventions__dbt_tmp" rename to "gld_interventions"
[0m15:51:33.591985 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:51:33.593253 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */
alter table "clinical_trials"."gold"."gld_countries__dbt_tmp" rename to "gld_countries"
[0m15:51:33.595445 [debug] [Thread-3 (]: Using postgres connection "model.clinical_trials.gld_enriched_trials"
[0m15:51:33.598174 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:51:33.603238 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: COMMIT
[0m15:51:33.606336 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:51:33.607344 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: COMMIT
[0m15:51:33.611866 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: COMMIT
[0m15:51:33.614265 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:51:33.618061 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: COMMIT
[0m15:51:33.621349 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:51:33.623180 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: COMMIT
[0m15:51:33.625385 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:51:33.627519 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: COMMIT
[0m15:51:33.630741 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: COMMIT
[0m15:51:33.632335 [debug] [Thread-3 (]: SQL status: COMMIT in 0.012 seconds
[0m15:51:33.633436 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:51:33.634413 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m15:51:33.642395 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m15:51:33.647138 [debug] [Thread-3 (]: Applying DROP to: "clinical_trials"."gold"."gld_enriched_trials__dbt_backup"
[0m15:51:33.653069 [debug] [Thread-1 (]: Applying DROP to: "clinical_trials"."gold"."gld_conditions__dbt_backup"
[0m15:51:33.658404 [debug] [Thread-4 (]: Applying DROP to: "clinical_trials"."gold"."gld_interventions__dbt_backup"
[0m15:51:33.662939 [debug] [Thread-2 (]: Applying DROP to: "clinical_trials"."gold"."gld_countries__dbt_backup"
[0m15:51:33.677650 [debug] [Thread-3 (]: Using postgres connection "model.clinical_trials.gld_enriched_trials"
[0m15:51:33.679347 [debug] [Thread-1 (]: Using postgres connection "model.clinical_trials.gld_conditions"
[0m15:51:33.681224 [debug] [Thread-4 (]: Using postgres connection "model.clinical_trials.gld_interventions"
[0m15:51:33.683115 [debug] [Thread-2 (]: Using postgres connection "model.clinical_trials.gld_countries"
[0m15:51:33.684819 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_enriched_trials"} */
drop table if exists "clinical_trials"."gold"."gld_enriched_trials__dbt_backup" cascade
[0m15:51:33.686249 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_conditions"} */
drop table if exists "clinical_trials"."gold"."gld_conditions__dbt_backup" cascade
[0m15:51:33.687985 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_interventions"} */
drop table if exists "clinical_trials"."gold"."gld_interventions__dbt_backup" cascade
[0m15:51:33.690035 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "clinical_trials", "target_name": "dev", "node_id": "model.clinical_trials.gld_countries"} */
drop table if exists "clinical_trials"."gold"."gld_countries__dbt_backup" cascade
[0m15:51:33.693105 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:51:33.697202 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:51:33.702681 [debug] [Thread-3 (]: On model.clinical_trials.gld_enriched_trials: Close
[0m15:51:33.703691 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m15:51:33.704632 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.008 seconds
[0m15:51:33.709191 [debug] [Thread-1 (]: On model.clinical_trials.gld_conditions: Close
[0m15:51:33.715005 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd05ff31a-8677-4b29-b3d3-b1b83067b815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe225b8a000>]}
[0m15:51:33.718486 [debug] [Thread-4 (]: On model.clinical_trials.gld_interventions: Close
[0m15:51:33.722025 [debug] [Thread-2 (]: On model.clinical_trials.gld_countries: Close
[0m15:51:33.724258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd05ff31a-8677-4b29-b3d3-b1b83067b815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe224fffec0>]}
[0m15:51:33.726505 [info ] [Thread-3 (]: 3 of 4 OK created sql table model gold.gld_enriched_trials ..................... [[32mSELECT 1100[0m in 0.61s]
[0m15:51:33.728651 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd05ff31a-8677-4b29-b3d3-b1b83067b815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe219725ca0>]}
[0m15:51:33.730724 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd05ff31a-8677-4b29-b3d3-b1b83067b815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2216663c0>]}
[0m15:51:33.732869 [info ] [Thread-1 (]: 1 of 4 OK created sql table model gold.gld_conditions .......................... [[32mSELECT 2168[0m in 0.62s]
[0m15:51:33.735851 [debug] [Thread-3 (]: Finished running node model.clinical_trials.gld_enriched_trials
[0m15:51:33.738693 [info ] [Thread-4 (]: 4 of 4 OK created sql table model gold.gld_interventions ....................... [[32mSELECT 1928[0m in 0.62s]
[0m15:51:33.741686 [info ] [Thread-2 (]: 2 of 4 OK created sql table model gold.gld_countries ........................... [[32mSELECT 1557[0m in 0.63s]
[0m15:51:33.744921 [debug] [Thread-1 (]: Finished running node model.clinical_trials.gld_conditions
[0m15:51:33.749167 [debug] [Thread-4 (]: Finished running node model.clinical_trials.gld_interventions
[0m15:51:33.751438 [debug] [Thread-2 (]: Finished running node model.clinical_trials.gld_countries
[0m15:51:33.759600 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:33.761819 [debug] [MainThread]: On master: BEGIN
[0m15:51:33.763731 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:51:33.775053 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m15:51:33.777333 [debug] [MainThread]: On master: COMMIT
[0m15:51:33.779329 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:33.781969 [debug] [MainThread]: On master: COMMIT
[0m15:51:33.784583 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:51:33.786616 [debug] [MainThread]: On master: Close
[0m15:51:33.789024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:33.790988 [debug] [MainThread]: Connection 'model.clinical_trials.gld_countries' was properly closed.
[0m15:51:33.792650 [debug] [MainThread]: Connection 'model.clinical_trials.gld_conditions' was properly closed.
[0m15:51:33.794216 [debug] [MainThread]: Connection 'model.clinical_trials.gld_enriched_trials' was properly closed.
[0m15:51:33.795443 [debug] [MainThread]: Connection 'model.clinical_trials.gld_interventions' was properly closed.
[0m15:51:33.796650 [info ] [MainThread]: 
[0m15:51:33.798844 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m15:51:33.803062 [debug] [MainThread]: Command end result
[0m15:51:33.866201 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:51:33.875393 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:51:33.890124 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:51:33.892088 [info ] [MainThread]: 
[0m15:51:33.894370 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:51:33.896446 [info ] [MainThread]: 
[0m15:51:33.898586 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:51:33.902248 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.87853, "process_in_blocks": "0", "process_kernel_time": 0.682671, "process_mem_max_rss": "115828", "process_out_blocks": "1600", "process_user_time": 4.045832}
[0m15:51:33.904601 [debug] [MainThread]: Command `dbt run` succeeded at 15:51:33.904288 after 2.88 seconds
[0m15:51:33.906724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe228806b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22611f980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22172c110>]}
[0m15:51:33.908856 [debug] [MainThread]: Flushing usage events
[0m15:51:34.367804 [debug] [MainThread]: An error was encountered while trying to flush usage events
